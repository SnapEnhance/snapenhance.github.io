<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>feat: partial scope content - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/16a16df51a573db6d439e95181c51c540bb99fe5.html">16a16df51a573db6d439e95181c51c540bb99fe5</a>
<b>parent</b> <a href="../commit/31570694a015c91a8fa67cdbfd2e1b58531033cf.html">31570694a015c91a8fa67cdbfd2e1b58531033cf</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Mon, 21 Aug 2023 18:09:59 +0200

feat: partial scope content

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></td><td> | </td><td class="num">14</td><td><span class="i">++++++++++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a></td><td> | </td><td class="num">23</td><td><span class="i">+++++++++++++++++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/MainActivity.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Section.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">+++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a></td><td> | </td><td class="num">53</td><td><span class="i">+++++++++++++++++++++++++++++</span><span class="d">------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a></td><td> | </td><td class="num">175</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">+</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">core/src/main/aidl/me/rhunk/snapenhance/bridge/SyncCallback.aidl</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">core/src/main/kotlin/me/rhunk/snapenhance/SnapEnhance.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>11 files changed, 234 insertions(+), 57 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -33,13 +33,23 @@ class BridgeService : Service() {
</a>     }
 
     fun triggerFriendSync(friendId: String) {
<a href="#h0-0-3" id="h0-0-3" class="d">-        SerializableDataObject.fromJson&lt;FriendInfo&gt;(syncCallback.syncFriend(friendId)).let {
</a><a href="#h0-0-4" id="h0-0-4" class="i">+        val syncedFriend = syncCallback.syncFriend(friendId)
</a><a href="#h0-0-5" id="h0-0-5" class="i">+        if (syncedFriend == null) {
</a><a href="#h0-0-6" id="h0-0-6" class="i">+            Logger.error(&quot;Failed to sync friend $friendId&quot;)
</a><a href="#h0-0-7" id="h0-0-7" class="i">+            return
</a><a href="#h0-0-8" id="h0-0-8" class="i">+        }
</a><a href="#h0-0-9" id="h0-0-9" class="i">+        SerializableDataObject.fromJson&lt;FriendInfo&gt;(syncedFriend).let {
</a>             remoteSideContext.modDatabase.syncFriend(it)
         }
     }
 
     fun triggerGroupSync(groupId: String) {
<a href="#h0-0-15" id="h0-0-15" class="d">-        SerializableDataObject.fromJson&lt;MessagingGroupInfo&gt;(syncCallback.syncGroup(groupId)).let {
</a><a href="#h0-0-16" id="h0-0-16" class="i">+        val syncedGroup = syncCallback.syncGroup(groupId)
</a><a href="#h0-0-17" id="h0-0-17" class="i">+        if (syncedGroup == null) {
</a><a href="#h0-0-18" id="h0-0-18" class="i">+            Logger.error(&quot;Failed to sync group $groupId&quot;)
</a><a href="#h0-0-19" id="h0-0-19" class="i">+            return
</a><a href="#h0-0-20" id="h0-0-20" class="i">+        }
</a><a href="#h0-0-21" id="h0-0-21" class="i">+        SerializableDataObject.fromJson&lt;MessagingGroupInfo&gt;(syncedGroup).let {
</a>             remoteSideContext.modDatabase.syncGroupInfo(it)
         }
     }
<b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -25,7 +25,13 @@ class ModDatabase(
</a>     var receiveMessagingDataCallback: (friends: List&lt;MessagingFriendInfo&gt;, groups: List&lt;MessagingGroupInfo&gt;) -&gt; Unit = { _, _ -&gt; }
 
     fun executeAsync(block: () -&gt; Unit) {
<a href="#h1-0-3" id="h1-0-3" class="d">-        executor.execute(block)
</a><a href="#h1-0-4" id="h1-0-4" class="i">+        executor.execute {
</a><a href="#h1-0-5" id="h1-0-5" class="i">+            runCatching {
</a><a href="#h1-0-6" id="h1-0-6" class="i">+                block()
</a><a href="#h1-0-7" id="h1-0-7" class="i">+            }.onFailure {
</a><a href="#h1-0-8" id="h1-0-8" class="i">+                Logger.error(&quot;Failed to execute async block&quot;, it)
</a><a href="#h1-0-9" id="h1-0-9" class="i">+            }
</a><a href="#h1-0-10" id="h1-0-10" class="i">+        }
</a>     }
 
     fun init() {
<a href="#h1-1" id="h1-1" class="h">@@ -56,7 +62,7 @@ class ModDatabase(
</a>                 &quot;userId VARCHAR PRIMARY KEY&quot;,
                 &quot;notify BOOLEAN&quot;,
                 &quot;expirationTimestamp BIGINT&quot;,
<a href="#h1-1-3" id="h1-1-3" class="d">-                &quot;count INTEGER&quot;
</a><a href="#h1-1-4" id="h1-1-4" class="i">+                &quot;length INTEGER&quot;
</a>             ),
             &quot;analytics_config&quot; to listOf(
                 &quot;userId VARCHAR PRIMARY KEY&quot;,
<a href="#h1-2" id="h1-2" class="h">@@ -137,7 +143,7 @@ class ModDatabase(
</a>                 )
                 //sync streaks
                 if (friend.streakLength &gt; 0) {
<a href="#h1-2-3" id="h1-2-3" class="d">-                    database.execSQL(&quot;INSERT OR REPLACE INTO streaks (userId, expirationTimestamp, count) VALUES (?, ?, ?)&quot;, arrayOf(
</a><a href="#h1-2-4" id="h1-2-4" class="i">+                    database.execSQL(&quot;INSERT OR REPLACE INTO streaks (userId, expirationTimestamp, length) VALUES (?, ?, ?)&quot;, arrayOf(
</a>                         friend.userId,
                         friend.streakExpirationTimestamp,
                         friend.streakLength
<a href="#h1-3" id="h1-3" class="h">@@ -227,8 +233,17 @@ class ModDatabase(
</a>                 userId = cursor.getStringOrNull(&quot;userId&quot;)!!,
                 notify = cursor.getInteger(&quot;notify&quot;) == 1,
                 expirationTimestamp = cursor.getLongOrNull(&quot;expirationTimestamp&quot;) ?: 0L,
<a href="#h1-3-3" id="h1-3-3" class="d">-                count = cursor.getInteger(&quot;count&quot;)
</a><a href="#h1-3-4" id="h1-3-4" class="i">+                length = cursor.getInteger(&quot;length&quot;)
</a>             )
         }
     }
<a href="#h1-3-8" id="h1-3-8" class="i">+
</a><a href="#h1-3-9" id="h1-3-9" class="i">+    fun setFriendStreaksNotify(userId: String, notify: Boolean) {
</a><a href="#h1-3-10" id="h1-3-10" class="i">+        executeAsync {
</a><a href="#h1-3-11" id="h1-3-11" class="i">+            database.execSQL(&quot;UPDATE streaks SET notify = ? WHERE userId = ?&quot;, arrayOf(
</a><a href="#h1-3-12" id="h1-3-12" class="i">+                if (notify) 1 else 0,
</a><a href="#h1-3-13" id="h1-3-13" class="i">+                userId
</a><a href="#h1-3-14" id="h1-3-14" class="i">+            ))
</a><a href="#h1-3-15" id="h1-3-15" class="i">+        }
</a><a href="#h1-3-16" id="h1-3-16" class="i">+    }
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/MainActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/MainActivity.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/MainActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/MainActivity.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -44,7 +44,8 @@ class MainActivity : ComponentActivity() {
</a>                 Scaffold(
                     containerColor = MaterialTheme.colorScheme.background,
                     topBar = { navigation.TopBar() },
<a href="#h2-0-3" id="h2-0-3" class="d">-                    bottomBar = { navigation.NavBar() }
</a><a href="#h2-0-4" id="h2-0-4" class="i">+                    bottomBar = { navigation.NavBar() },
</a><a href="#h2-0-5" id="h2-0-5" class="i">+                    floatingActionButton = { navigation.Fab() }
</a>                 ) { innerPadding -&gt;
                     navigation.NavigationHost(
                         innerPadding = innerPadding,
<b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -101,6 +101,15 @@ class Navigation(
</a>     }
 
     @Composable
<a href="#h3-0-3" id="h3-0-3" class="i">+    fun Fab() {
</a><a href="#h3-0-4" id="h3-0-4" class="i">+        val navBackStackEntry by navHostController.currentBackStackEntryAsState()
</a><a href="#h3-0-5" id="h3-0-5" class="i">+        val currentDestination = navBackStackEntry?.destination ?: return
</a><a href="#h3-0-6" id="h3-0-6" class="i">+        val currentSection = getCurrentSection(currentDestination)
</a><a href="#h3-0-7" id="h3-0-7" class="i">+
</a><a href="#h3-0-8" id="h3-0-8" class="i">+        currentSection.FloatingActionButton()
</a><a href="#h3-0-9" id="h3-0-9" class="i">+    }
</a><a href="#h3-0-10" id="h3-0-10" class="i">+
</a><a href="#h3-0-11" id="h3-0-11" class="i">+    @Composable
</a>     fun NavBar() {
         NavigationBar {
             val navBackStackEntry by navHostController.currentBackStackEntryAsState()
<b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Section.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Section.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Section.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Section.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -76,6 +76,9 @@ open class Section {
</a>     @Composable
     open fun TopBarActions(rowScope: RowScope) {}
 
<a href="#h4-0-3" id="h4-0-3" class="i">+    @Composable
</a><a href="#h4-0-4" id="h4-0-4" class="i">+    open fun FloatingActionButton() {}
</a><a href="#h4-0-5" id="h4-0-5" class="i">+
</a>     open fun build(navGraphBuilder: NavGraphBuilder) {
         navGraphBuilder.composable(enumSection.route) {
             Content()
<b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -30,6 +30,7 @@ import androidx.compose.material.icons.filled.FolderOpen
</a> import androidx.compose.material.icons.filled.OpenInNew
 import androidx.compose.material.icons.filled.Search
 import androidx.compose.material.icons.rounded.Save
<a href="#h5-0-3" id="h5-0-3" class="i">+import androidx.compose.material3.BottomSheetScaffoldState
</a> import androidx.compose.material3.Card
 import androidx.compose.material3.ExperimentalMaterial3Api
 import androidx.compose.material3.FilledIconButton
<a href="#h5-1" id="h5-1" class="h">@@ -77,6 +78,7 @@ import me.rhunk.snapenhance.core.config.PropertyValue
</a> import me.rhunk.snapenhance.ui.manager.Section
 import me.rhunk.snapenhance.ui.util.ChooseFolderHelper
 
<a href="#h5-1-3" id="h5-1-3" class="i">+@OptIn(ExperimentalMaterial3Api::class)
</a> class FeaturesSection : Section() {
     private val dialogs by lazy { Dialogs(context.translation) }
 
<a href="#h5-2" id="h5-2" class="h">@@ -91,6 +93,8 @@ class FeaturesSection : Section() {
</a> 
     private val featuresRouteName by lazy { context.translation[&quot;manager.routes.features&quot;] }
 
<a href="#h5-2-3" id="h5-2-3" class="i">+    private lateinit var rememberScaffoldState: BottomSheetScaffoldState
</a><a href="#h5-2-4" id="h5-2-4" class="i">+
</a>     private val allContainers by lazy {
         val containers = mutableMapOf&lt;String, PropertyPair&lt;*&gt;&gt;()
         fun queryContainerRecursive(container: ConfigContainer) {
<a href="#h5-3" id="h5-3" class="h">@@ -458,35 +462,14 @@ class FeaturesSection : Section() {
</a>         }
     }
 
<a href="#h5-3-3" id="h5-3-3" class="d">-    @OptIn(ExperimentalMaterial3Api::class)
</a>     @Composable
     private fun PropertiesView(
         properties: List&lt;PropertyPair&lt;*&gt;&gt;
     ) {
<a href="#h5-3-8" id="h5-3-8" class="d">-        val scope = rememberCoroutineScope()
</a><a href="#h5-3-9" id="h5-3-9" class="d">-        val scaffoldState = rememberBottomSheetScaffoldState()
</a><a href="#h5-3-10" id="h5-3-10" class="i">+        rememberScaffoldState = rememberBottomSheetScaffoldState()
</a>         Scaffold(
<a href="#h5-3-12" id="h5-3-12" class="d">-            snackbarHost = { SnackbarHost(scaffoldState.snackbarHostState) },
</a><a href="#h5-3-13" id="h5-3-13" class="i">+            snackbarHost = { SnackbarHost(rememberScaffoldState.snackbarHostState) },
</a>             modifier = Modifier.fillMaxSize(),
<a href="#h5-3-15" id="h5-3-15" class="d">-            floatingActionButton = {
</a><a href="#h5-3-16" id="h5-3-16" class="d">-                FloatingActionButton(
</a><a href="#h5-3-17" id="h5-3-17" class="d">-                    onClick = {
</a><a href="#h5-3-18" id="h5-3-18" class="d">-                        context.config.writeConfig()
</a><a href="#h5-3-19" id="h5-3-19" class="d">-                        scope.launch {
</a><a href="#h5-3-20" id="h5-3-20" class="d">-                            scaffoldState.snackbarHostState.showSnackbar(&quot;Saved&quot;)
</a><a href="#h5-3-21" id="h5-3-21" class="d">-                        }
</a><a href="#h5-3-22" id="h5-3-22" class="d">-                    },
</a><a href="#h5-3-23" id="h5-3-23" class="d">-                    modifier = Modifier.padding(10.dp),
</a><a href="#h5-3-24" id="h5-3-24" class="d">-                    containerColor = MaterialTheme.colorScheme.primary,
</a><a href="#h5-3-25" id="h5-3-25" class="d">-                    contentColor = MaterialTheme.colorScheme.onPrimary,
</a><a href="#h5-3-26" id="h5-3-26" class="d">-                    shape = RoundedCornerShape(16.dp),
</a><a href="#h5-3-27" id="h5-3-27" class="d">-                ) {
</a><a href="#h5-3-28" id="h5-3-28" class="d">-                    Icon(
</a><a href="#h5-3-29" id="h5-3-29" class="d">-                        imageVector = Icons.Rounded.Save,
</a><a href="#h5-3-30" id="h5-3-30" class="d">-                        contentDescription = null
</a><a href="#h5-3-31" id="h5-3-31" class="d">-                    )
</a><a href="#h5-3-32" id="h5-3-32" class="d">-                }
</a><a href="#h5-3-33" id="h5-3-33" class="d">-            },
</a>             content = { innerPadding -&gt;
                 LazyColumn(
                     modifier = Modifier
<a href="#h5-4" id="h5-4" class="h">@@ -494,7 +477,7 @@ class FeaturesSection : Section() {
</a>                         .padding(innerPadding),
                     //save button space
                     contentPadding = PaddingValues(top = 10.dp, bottom = 110.dp),
<a href="#h5-4-3" id="h5-4-3" class="d">-                    verticalArrangement = Arrangement.Center
</a><a href="#h5-4-4" id="h5-4-4" class="i">+                    verticalArrangement = Arrangement.Top
</a>                 ) {
                     items(properties) {
                         PropertyCard(it)
<a href="#h5-5" id="h5-5" class="h">@@ -504,6 +487,28 @@ class FeaturesSection : Section() {
</a>         )
     }
 
<a href="#h5-5-3" id="h5-5-3" class="i">+    @Composable
</a><a href="#h5-5-4" id="h5-5-4" class="i">+    override fun FloatingActionButton() {
</a><a href="#h5-5-5" id="h5-5-5" class="i">+        val scope = rememberCoroutineScope()
</a><a href="#h5-5-6" id="h5-5-6" class="i">+        FloatingActionButton(
</a><a href="#h5-5-7" id="h5-5-7" class="i">+            onClick = {
</a><a href="#h5-5-8" id="h5-5-8" class="i">+                context.config.writeConfig()
</a><a href="#h5-5-9" id="h5-5-9" class="i">+                scope.launch {
</a><a href="#h5-5-10" id="h5-5-10" class="i">+                    rememberScaffoldState.snackbarHostState.showSnackbar(&quot;Saved&quot;)
</a><a href="#h5-5-11" id="h5-5-11" class="i">+                }
</a><a href="#h5-5-12" id="h5-5-12" class="i">+            },
</a><a href="#h5-5-13" id="h5-5-13" class="i">+            modifier = Modifier.padding(10.dp),
</a><a href="#h5-5-14" id="h5-5-14" class="i">+            containerColor = MaterialTheme.colorScheme.primary,
</a><a href="#h5-5-15" id="h5-5-15" class="i">+            contentColor = MaterialTheme.colorScheme.onPrimary,
</a><a href="#h5-5-16" id="h5-5-16" class="i">+            shape = RoundedCornerShape(16.dp),
</a><a href="#h5-5-17" id="h5-5-17" class="i">+        ) {
</a><a href="#h5-5-18" id="h5-5-18" class="i">+            Icon(
</a><a href="#h5-5-19" id="h5-5-19" class="i">+                imageVector = Icons.Rounded.Save,
</a><a href="#h5-5-20" id="h5-5-20" class="i">+                contentDescription = null
</a><a href="#h5-5-21" id="h5-5-21" class="i">+            )
</a><a href="#h5-5-22" id="h5-5-22" class="i">+        }
</a><a href="#h5-5-23" id="h5-5-23" class="i">+    }
</a><a href="#h5-5-24" id="h5-5-24" class="i">+
</a> 
     @Composable
     private fun Container(
<b>diff --git a/<a id="h6" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -3,7 +3,13 @@ package me.rhunk.snapenhance.ui.manager.sections.social
</a> import androidx.compose.foundation.layout.Column
 import androidx.compose.foundation.layout.Row
 import androidx.compose.foundation.layout.Spacer
<a href="#h6-0-3" id="h6-0-3" class="i">+import androidx.compose.foundation.layout.fillMaxWidth
</a> import androidx.compose.foundation.layout.height
<a href="#h6-0-5" id="h6-0-5" class="i">+import androidx.compose.foundation.layout.offset
</a><a href="#h6-0-6" id="h6-0-6" class="i">+import androidx.compose.foundation.layout.padding
</a><a href="#h6-0-7" id="h6-0-7" class="i">+import androidx.compose.foundation.rememberScrollState
</a><a href="#h6-0-8" id="h6-0-8" class="i">+import androidx.compose.foundation.verticalScroll
</a><a href="#h6-0-9" id="h6-0-9" class="i">+import androidx.compose.material3.Card
</a> import androidx.compose.material3.OutlinedButton
 import androidx.compose.material3.Switch
 import androidx.compose.material3.Text
<a href="#h6-1" id="h6-1" class="h">@@ -13,13 +19,18 @@ import androidx.compose.runtime.mutableStateOf
</a> import androidx.compose.runtime.remember
 import androidx.compose.runtime.rememberCoroutineScope
 import androidx.compose.runtime.setValue
<a href="#h6-1-3" id="h6-1-3" class="i">+import androidx.compose.ui.Alignment
</a> import androidx.compose.ui.Modifier
<a href="#h6-1-5" id="h6-1-5" class="i">+import androidx.compose.ui.text.font.FontWeight
</a> import androidx.compose.ui.unit.dp
<a href="#h6-1-7" id="h6-1-7" class="i">+import androidx.compose.ui.unit.sp
</a> import androidx.navigation.NavController
 import kotlinx.coroutines.launch
 import me.rhunk.snapenhance.RemoteSideContext
 import me.rhunk.snapenhance.core.messaging.MessagingRuleType
 import me.rhunk.snapenhance.core.messaging.SocialScope
<a href="#h6-1-13" id="h6-1-13" class="i">+import me.rhunk.snapenhance.ui.util.BitmojiImage
</a><a href="#h6-1-14" id="h6-1-14" class="i">+import me.rhunk.snapenhance.util.snap.BitmojiSelfie
</a> 
 class ScopeContent(
     private val context: RemoteSideContext,
<a href="#h6-2" id="h6-2" class="h">@@ -28,7 +39,6 @@ class ScopeContent(
</a>     private val scope: SocialScope,
     private val id: String
 ) {
<a href="#h6-2-3" id="h6-2-3" class="d">-
</a>     @Composable
     private fun DeleteScopeEntityButton() {
         val coroutineScope = rememberCoroutineScope()
<a href="#h6-3" id="h6-3" class="h">@@ -40,7 +50,7 @@ class ScopeContent(
</a>             context.modDatabase.executeAsync {
                 coroutineScope.launch {
                     section.onResumed()
<a href="#h6-3-3" id="h6-3-3" class="d">-                    navController.popBackStack()
</a><a href="#h6-3-4" id="h6-3-4" class="i">+                    navController.navigate(SocialSection.MAIN_ROUTE)
</a>                 }
             }
         }) {
<a href="#h6-4" id="h6-4" class="h">@@ -50,7 +60,10 @@ class ScopeContent(
</a> 
     @Composable
     fun Content() {
<a href="#h6-4-3" id="h6-4-3" class="d">-        Column {
</a><a href="#h6-4-4" id="h6-4-4" class="i">+        Column(
</a><a href="#h6-4-5" id="h6-4-5" class="i">+            modifier = Modifier
</a><a href="#h6-4-6" id="h6-4-6" class="i">+                .verticalScroll(rememberScrollState())
</a><a href="#h6-4-7" id="h6-4-7" class="i">+        ) {
</a>             when (scope) {
                 SocialScope.FRIEND -&gt; Friend()
                 SocialScope.GROUP -&gt; Group()
<a href="#h6-5" id="h6-5" class="h">@@ -60,42 +73,162 @@ class ScopeContent(
</a> 
             val scopeRules = context.modDatabase.getRulesFromId(scope, id)
 
<a href="#h6-5-3" id="h6-5-3" class="d">-            Text(text = &quot;Rules&quot;, maxLines = 1)
</a><a href="#h6-5-4" id="h6-5-4" class="d">-            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h6-5-5" id="h6-5-5" class="i">+            SectionTitle(&quot;Rules&quot;)
</a> 
<a href="#h6-5-7" id="h6-5-7" class="d">-            //manager anti features etc
</a><a href="#h6-5-8" id="h6-5-8" class="d">-            MessagingRuleType.values().forEach { feature -&gt;
</a><a href="#h6-5-9" id="h6-5-9" class="d">-                var featureEnabled by remember {
</a><a href="#h6-5-10" id="h6-5-10" class="d">-                    mutableStateOf(scopeRules.any { it.subject == feature.key })
</a><a href="#h6-5-11" id="h6-5-11" class="d">-                }
</a><a href="#h6-5-12" id="h6-5-12" class="d">-                val featureEnabledText = if (featureEnabled) &quot;Enabled&quot; else &quot;Disabled&quot;
</a><a href="#h6-5-13" id="h6-5-13" class="d">-                Row {
</a><a href="#h6-5-14" id="h6-5-14" class="d">-                    Text(text = &quot;${feature.key}: $featureEnabledText&quot;, maxLines = 1)
</a><a href="#h6-5-15" id="h6-5-15" class="d">-                    Switch(checked = featureEnabled, onCheckedChange = {
</a><a href="#h6-5-16" id="h6-5-16" class="d">-                        context.modDatabase.toggleRuleFor(scope, id, feature.key, it)
</a><a href="#h6-5-17" id="h6-5-17" class="d">-                        featureEnabled = it
</a><a href="#h6-5-18" id="h6-5-18" class="d">-                    })
</a><a href="#h6-5-19" id="h6-5-19" class="i">+            ContentCard {
</a><a href="#h6-5-20" id="h6-5-20" class="i">+                //manager anti features etc
</a><a href="#h6-5-21" id="h6-5-21" class="i">+                MessagingRuleType.values().forEach { feature -&gt;
</a><a href="#h6-5-22" id="h6-5-22" class="i">+                    var featureEnabled by remember {
</a><a href="#h6-5-23" id="h6-5-23" class="i">+                        mutableStateOf(scopeRules.any { it.subject == feature.key })
</a><a href="#h6-5-24" id="h6-5-24" class="i">+                    }
</a><a href="#h6-5-25" id="h6-5-25" class="i">+                    val featureEnabledText = if (featureEnabled) &quot;Enabled&quot; else &quot;Disabled&quot;
</a><a href="#h6-5-26" id="h6-5-26" class="i">+
</a><a href="#h6-5-27" id="h6-5-27" class="i">+                    Row {
</a><a href="#h6-5-28" id="h6-5-28" class="i">+                        Text(text = &quot;${feature.key}: $featureEnabledText&quot;, maxLines = 1)
</a><a href="#h6-5-29" id="h6-5-29" class="i">+                        Switch(checked = featureEnabled, onCheckedChange = {
</a><a href="#h6-5-30" id="h6-5-30" class="i">+                            context.modDatabase.toggleRuleFor(scope, id, feature.key, it)
</a><a href="#h6-5-31" id="h6-5-31" class="i">+                            featureEnabled = it
</a><a href="#h6-5-32" id="h6-5-32" class="i">+                        })
</a><a href="#h6-5-33" id="h6-5-33" class="i">+                    }
</a>                 }
             }
         }
     }
 
     @Composable
<a href="#h6-5-40" id="h6-5-40" class="i">+    private fun ContentCard(modifier: Modifier = Modifier, content: @Composable () -&gt; Unit) {
</a><a href="#h6-5-41" id="h6-5-41" class="i">+        Card(
</a><a href="#h6-5-42" id="h6-5-42" class="i">+            modifier = Modifier
</a><a href="#h6-5-43" id="h6-5-43" class="i">+                .padding(10.dp)
</a><a href="#h6-5-44" id="h6-5-44" class="i">+                .fillMaxWidth()
</a><a href="#h6-5-45" id="h6-5-45" class="i">+        ) {
</a><a href="#h6-5-46" id="h6-5-46" class="i">+            Column(
</a><a href="#h6-5-47" id="h6-5-47" class="i">+                modifier = Modifier
</a><a href="#h6-5-48" id="h6-5-48" class="i">+                    .padding(10.dp)
</a><a href="#h6-5-49" id="h6-5-49" class="i">+                    .fillMaxWidth()
</a><a href="#h6-5-50" id="h6-5-50" class="i">+                    .then(modifier)
</a><a href="#h6-5-51" id="h6-5-51" class="i">+            ) {
</a><a href="#h6-5-52" id="h6-5-52" class="i">+                content()
</a><a href="#h6-5-53" id="h6-5-53" class="i">+            }
</a><a href="#h6-5-54" id="h6-5-54" class="i">+        }
</a><a href="#h6-5-55" id="h6-5-55" class="i">+    }
</a><a href="#h6-5-56" id="h6-5-56" class="i">+
</a><a href="#h6-5-57" id="h6-5-57" class="i">+    @Composable
</a><a href="#h6-5-58" id="h6-5-58" class="i">+    private fun SectionTitle(title: String) {
</a><a href="#h6-5-59" id="h6-5-59" class="i">+        Text(
</a><a href="#h6-5-60" id="h6-5-60" class="i">+            text = title,
</a><a href="#h6-5-61" id="h6-5-61" class="i">+            maxLines = 1,
</a><a href="#h6-5-62" id="h6-5-62" class="i">+            fontSize = 20.sp,
</a><a href="#h6-5-63" id="h6-5-63" class="i">+            fontWeight = FontWeight.Bold,
</a><a href="#h6-5-64" id="h6-5-64" class="i">+            modifier = Modifier
</a><a href="#h6-5-65" id="h6-5-65" class="i">+                .offset(x = 20.dp)
</a><a href="#h6-5-66" id="h6-5-66" class="i">+                .padding(bottom = 10.dp)
</a><a href="#h6-5-67" id="h6-5-67" class="i">+        )
</a><a href="#h6-5-68" id="h6-5-68" class="i">+    }
</a><a href="#h6-5-69" id="h6-5-69" class="i">+
</a><a href="#h6-5-70" id="h6-5-70" class="i">+    //need to display all units?
</a><a href="#h6-5-71" id="h6-5-71" class="i">+    private fun computeStreakETA(timestamp: Long): String {
</a><a href="#h6-5-72" id="h6-5-72" class="i">+        val now = System.currentTimeMillis()
</a><a href="#h6-5-73" id="h6-5-73" class="i">+        val stringBuilder = StringBuilder()
</a><a href="#h6-5-74" id="h6-5-74" class="i">+        val diff = timestamp - now
</a><a href="#h6-5-75" id="h6-5-75" class="i">+        val seconds = diff / 1000
</a><a href="#h6-5-76" id="h6-5-76" class="i">+        val minutes = seconds / 60
</a><a href="#h6-5-77" id="h6-5-77" class="i">+        val hours = minutes / 60
</a><a href="#h6-5-78" id="h6-5-78" class="i">+        val days = hours / 24
</a><a href="#h6-5-79" id="h6-5-79" class="i">+        if (days &gt; 0) {
</a><a href="#h6-5-80" id="h6-5-80" class="i">+            stringBuilder.append(&quot;$days days &quot;)
</a><a href="#h6-5-81" id="h6-5-81" class="i">+            return stringBuilder.toString()
</a><a href="#h6-5-82" id="h6-5-82" class="i">+        }
</a><a href="#h6-5-83" id="h6-5-83" class="i">+        if (hours &gt; 0) {
</a><a href="#h6-5-84" id="h6-5-84" class="i">+            stringBuilder.append(&quot;$hours hours &quot;)
</a><a href="#h6-5-85" id="h6-5-85" class="i">+            return stringBuilder.toString()
</a><a href="#h6-5-86" id="h6-5-86" class="i">+        }
</a><a href="#h6-5-87" id="h6-5-87" class="i">+        if (minutes &gt; 0) {
</a><a href="#h6-5-88" id="h6-5-88" class="i">+            stringBuilder.append(&quot;$minutes minutes &quot;)
</a><a href="#h6-5-89" id="h6-5-89" class="i">+            return stringBuilder.toString()
</a><a href="#h6-5-90" id="h6-5-90" class="i">+        }
</a><a href="#h6-5-91" id="h6-5-91" class="i">+        if (seconds &gt; 0) {
</a><a href="#h6-5-92" id="h6-5-92" class="i">+            stringBuilder.append(&quot;$seconds seconds &quot;)
</a><a href="#h6-5-93" id="h6-5-93" class="i">+            return stringBuilder.toString()
</a><a href="#h6-5-94" id="h6-5-94" class="i">+        }
</a><a href="#h6-5-95" id="h6-5-95" class="i">+        return &quot;Expired&quot;
</a><a href="#h6-5-96" id="h6-5-96" class="i">+    }
</a><a href="#h6-5-97" id="h6-5-97" class="i">+
</a><a href="#h6-5-98" id="h6-5-98" class="i">+    @Composable
</a>     private fun Friend() {
         //fetch the friend from the database
         val friend = remember { context.modDatabase.getFriendInfo(id) } ?: run {
             Text(text = &quot;Friend not found&quot;)
             return
         }
<a href="#h6-5-105" id="h6-5-105" class="d">-        Column {
</a><a href="#h6-5-106" id="h6-5-106" class="d">-            Text(text = friend.displayName ?: &quot;No display name&quot;, maxLines = 1)
</a><a href="#h6-5-107" id="h6-5-107" class="d">-            Text(text = &quot;bitmojiId: ${friend.bitmojiId ?: &quot;No bitmojiId&quot;}&quot;, maxLines = 1)
</a><a href="#h6-5-108" id="h6-5-108" class="d">-            Text(text = &quot;selfieId: ${friend.selfieId ?: &quot;No selfieId&quot;}&quot;, maxLines = 1)
</a> 
<a href="#h6-5-110" id="h6-5-110" class="i">+        val streaks = remember {
</a><a href="#h6-5-111" id="h6-5-111" class="i">+            context.modDatabase.getFriendStreaks(id)
</a><a href="#h6-5-112" id="h6-5-112" class="i">+        }
</a><a href="#h6-5-113" id="h6-5-113" class="i">+
</a><a href="#h6-5-114" id="h6-5-114" class="i">+        Column(
</a><a href="#h6-5-115" id="h6-5-115" class="i">+            modifier = Modifier
</a><a href="#h6-5-116" id="h6-5-116" class="i">+                .padding(10.dp)
</a><a href="#h6-5-117" id="h6-5-117" class="i">+                .fillMaxWidth(),
</a><a href="#h6-5-118" id="h6-5-118" class="i">+            horizontalAlignment = Alignment.CenterHorizontally
</a><a href="#h6-5-119" id="h6-5-119" class="i">+        ) {
</a><a href="#h6-5-120" id="h6-5-120" class="i">+            val bitmojiUrl = (friend.selfieId to friend.bitmojiId).let { (selfieId, bitmojiId) -&gt;
</a><a href="#h6-5-121" id="h6-5-121" class="i">+                if (selfieId == null || bitmojiId == null) return@let null
</a><a href="#h6-5-122" id="h6-5-122" class="i">+                BitmojiSelfie.getBitmojiSelfie(
</a><a href="#h6-5-123" id="h6-5-123" class="i">+                    selfieId,
</a><a href="#h6-5-124" id="h6-5-124" class="i">+                    bitmojiId,
</a><a href="#h6-5-125" id="h6-5-125" class="i">+                    BitmojiSelfie.BitmojiSelfieType.THREE_D
</a><a href="#h6-5-126" id="h6-5-126" class="i">+                )
</a><a href="#h6-5-127" id="h6-5-127" class="i">+            }
</a><a href="#h6-5-128" id="h6-5-128" class="i">+            BitmojiImage(context = context, url = bitmojiUrl, size = 100)
</a><a href="#h6-5-129" id="h6-5-129" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h6-5-130" id="h6-5-130" class="i">+            Text(
</a><a href="#h6-5-131" id="h6-5-131" class="i">+                text = friend.displayName ?: friend.mutableUsername,
</a><a href="#h6-5-132" id="h6-5-132" class="i">+                maxLines = 1,
</a><a href="#h6-5-133" id="h6-5-133" class="i">+                fontSize = 20.sp,
</a><a href="#h6-5-134" id="h6-5-134" class="i">+                fontWeight = FontWeight.Bold
</a><a href="#h6-5-135" id="h6-5-135" class="i">+            )
</a><a href="#h6-5-136" id="h6-5-136" class="i">+            Spacer(modifier = Modifier.height(5.dp))
</a><a href="#h6-5-137" id="h6-5-137" class="i">+            Text(
</a><a href="#h6-5-138" id="h6-5-138" class="i">+                text = friend.mutableUsername,
</a><a href="#h6-5-139" id="h6-5-139" class="i">+                maxLines = 1,
</a><a href="#h6-5-140" id="h6-5-140" class="i">+                fontSize = 12.sp,
</a><a href="#h6-5-141" id="h6-5-141" class="i">+                fontWeight = FontWeight.Light
</a><a href="#h6-5-142" id="h6-5-142" class="i">+            )
</a>             Spacer(modifier = Modifier.height(16.dp))
<a href="#h6-5-144" id="h6-5-144" class="i">+
</a>             DeleteScopeEntityButton()
         }
 
<a href="#h6-5-148" id="h6-5-148" class="i">+        Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h6-5-149" id="h6-5-149" class="i">+        Column {
</a><a href="#h6-5-150" id="h6-5-150" class="i">+            //streaks
</a><a href="#h6-5-151" id="h6-5-151" class="i">+            streaks?.let {
</a><a href="#h6-5-152" id="h6-5-152" class="i">+                var shouldNotify by remember { mutableStateOf(it.notify) }
</a><a href="#h6-5-153" id="h6-5-153" class="i">+                SectionTitle(&quot;Streaks&quot;)
</a><a href="#h6-5-154" id="h6-5-154" class="i">+                ContentCard {
</a><a href="#h6-5-155" id="h6-5-155" class="i">+                    Row(
</a><a href="#h6-5-156" id="h6-5-156" class="i">+                        verticalAlignment = Alignment.CenterVertically
</a><a href="#h6-5-157" id="h6-5-157" class="i">+                    ) {
</a><a href="#h6-5-158" id="h6-5-158" class="i">+                        Column(
</a><a href="#h6-5-159" id="h6-5-159" class="i">+                            modifier = Modifier.weight(1f),
</a><a href="#h6-5-160" id="h6-5-160" class="i">+                        ) {
</a><a href="#h6-5-161" id="h6-5-161" class="i">+                            Text(text = &quot;Count: ${streaks.length}&quot;, maxLines = 1)
</a><a href="#h6-5-162" id="h6-5-162" class="i">+                            Text(text = &quot;Expires in: ${computeStreakETA(streaks.expirationTimestamp)}&quot;, maxLines = 1)
</a><a href="#h6-5-163" id="h6-5-163" class="i">+                        }
</a><a href="#h6-5-164" id="h6-5-164" class="i">+                        Row(
</a><a href="#h6-5-165" id="h6-5-165" class="i">+                            verticalAlignment = Alignment.CenterVertically
</a><a href="#h6-5-166" id="h6-5-166" class="i">+                        ) {
</a><a href="#h6-5-167" id="h6-5-167" class="i">+                            Text(text = &quot;Notify Expiration&quot;, maxLines = 1)
</a><a href="#h6-5-168" id="h6-5-168" class="i">+                            Switch(checked = shouldNotify, onCheckedChange = {
</a><a href="#h6-5-169" id="h6-5-169" class="i">+                                context.modDatabase.setFriendStreaksNotify(id, it)
</a><a href="#h6-5-170" id="h6-5-170" class="i">+                                shouldNotify = it
</a><a href="#h6-5-171" id="h6-5-171" class="i">+                            })
</a><a href="#h6-5-172" id="h6-5-172" class="i">+                        }
</a><a href="#h6-5-173" id="h6-5-173" class="i">+                    }
</a><a href="#h6-5-174" id="h6-5-174" class="i">+                }
</a><a href="#h6-5-175" id="h6-5-175" class="i">+            }
</a><a href="#h6-5-176" id="h6-5-176" class="i">+        }
</a>     }
 
     @Composable
<b>diff --git a/<a id="h7" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -26,7 +26,6 @@ import androidx.compose.material3.TabRowDefaults
</a> import androidx.compose.material3.Text
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.getValue
<a href="#h7-0-3" id="h7-0-3" class="d">-import androidx.compose.runtime.mutableIntStateOf
</a> import androidx.compose.runtime.mutableStateOf
 import androidx.compose.runtime.remember
 import androidx.compose.runtime.rememberCoroutineScope
<a href="#h7-1" id="h7-1" class="h">@@ -147,7 +146,7 @@ class SocialSection : Section() {
</a>                             ) {
                                 val bitmojiUrl = (friend.selfieId to friend.bitmojiId).let { (selfieId, bitmojiId) -&gt;
                                     if (selfieId == null || bitmojiId == null) return@let null
<a href="#h7-1-3" id="h7-1-3" class="d">-                                    BitmojiSelfie.getBitmojiSelfie(selfieId, bitmojiId, BitmojiSelfie.BitmojiSelfieType.STANDARD)
</a><a href="#h7-1-4" id="h7-1-4" class="i">+                                    BitmojiSelfie.getBitmojiSelfie(selfieId, bitmojiId, BitmojiSelfie.BitmojiSelfieType.THREE_D)
</a>                                 }
                                 BitmojiImage(context = context, url = bitmojiUrl)
                                 Column(
<b>diff --git a/<a id="h8" href="../file/core/src/main/aidl/me/rhunk/snapenhance/bridge/SyncCallback.aidl.html">core/src/main/aidl/me/rhunk/snapenhance/bridge/SyncCallback.aidl</a> b/<a href="../file/core/src/main/aidl/me/rhunk/snapenhance/bridge/SyncCallback.aidl.html">core/src/main/aidl/me/rhunk/snapenhance/bridge/SyncCallback.aidl</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -6,12 +6,12 @@ interface SyncCallback {
</a>     * @param uuid The uuid of the friend to sync
     * @return The serialized friend data
     */
<a href="#h8-0-3" id="h8-0-3" class="d">-    String syncFriend(String uuid);
</a><a href="#h8-0-4" id="h8-0-4" class="i">+    @nullable String syncFriend(String uuid);
</a> 
     /**
     * Called when the conversation data has been synced
     * @param uuid The uuid of the conversation to sync
     * @return The serialized conversation data
     */
<a href="#h8-0-11" id="h8-0-11" class="d">-    String syncGroup(String uuid);
</a><a href="#h8-0-12" id="h8-0-12" class="i">+    @nullable String syncGroup(String uuid);
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h9" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/SnapEnhance.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/SnapEnhance.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/SnapEnhance.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/SnapEnhance.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -89,6 +89,7 @@ class SnapEnhance {
</a> 
             Logger.debug(&quot;Reloading config&quot;)
             appContext.reloadConfig()
<a href="#h9-0-3" id="h9-0-3" class="i">+            syncRemote()
</a>         }
     }
 
<a href="#h9-1" id="h9-1" class="h">@@ -131,6 +132,7 @@ class SnapEnhance {
</a>         val database = appContext.database
 
         appContext.executeAsync {
<a href="#h9-1-3" id="h9-1-3" class="i">+            Logger.debug(&quot;request remote sync&quot;)
</a>             appContext.bridgeClient.sync(object : SyncCallback.Stub() {
                 override fun syncFriend(uuid: String): String? {
                     return database.getFriendInfo(uuid)?.toJson()
<b>diff --git a/<a id="h10" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -29,7 +29,7 @@ data class FriendStreaks(
</a>     val userId: String,
     val notify: Boolean,
     val expirationTimestamp: Long,
<a href="#h10-0-3" id="h10-0-3" class="d">-    val count: Int
</a><a href="#h10-0-4" id="h10-0-4" class="i">+    val length: Int
</a> ) : SerializableDataObject()
 
 
</pre>
</div>
</body>
</html>
