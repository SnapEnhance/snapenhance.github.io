<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>refactor: wrappers - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/07daeaf994258139c83e145b5ff290e5aac1493f.html">07daeaf994258139c83e145b5ff290e5aac1493f</a>
<b>parent</b> <a href="../commit/3fc06550bf02d96f845abe0b541e775d8c2378e4.html">3fc06550bf02d96f845abe0b541e775d8c2378e4</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Thu,  2 Nov 2023 16:26:08 +0100

refactor: wrappers

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">core/src/main/kotlin/me/rhunk/snapenhance/core/action/impl/ExportChatMessages.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ScopeSync.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/decoder/MessageDecoder.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/experiments/SnapToChatMedia.kt</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/global/BypassVideoLengthRestriction.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/AutoSave.kt</a></td><td> | </td><td class="num">10</td><td><span class="i">+++++</span><span class="d">-----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/InstantDelete.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/Notifications.kt</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/SendOverride.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/UnlimitedSnapViewTime.kt</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/spying/MessageLogger.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/CoreMessagingBridge.kt</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageExporter.kt</a></td><td> | </td><td class="num">36</td><td><span class="i">++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageSender.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/AbstractWrapper.kt</a></td><td> | </td><td class="num">26</td><td><span class="i">+++++++++++++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/ConversationManager.kt</a></td><td> | </td><td class="num">5</td><td><span class="i">++++</span><span class="d">-</span></td></tr>
<tr><td class="D">D</td><td><a href="#h16">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/FriendActionButton.kt</a></td><td> | </td><td class="num">39</td><td><span class="i"></span><span class="d">---------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h17">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/Message.kt</a></td><td> | </td><td class="num">19</td><td><span class="i">+++++++++++++</span><span class="d">------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h18">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageContent.kt</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDescriptor.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">+++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDestinations.kt</a></td><td> | </td><td class="num">11</td><td><span class="i">+++</span><span class="d">--------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageMetadata.kt</a></td><td> | </td><td class="num">34</td><td><span class="i">++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h22">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessage.kt</a></td><td> | </td><td class="num">6</td><td><span class="i">++++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h23">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessageContent.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h24">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/UserIdToReaction.kt</a></td><td> | </td><td class="num">16</td><td><span class="i">+++++++++++++</span><span class="d">---</span></td></tr>
</table></pre><pre>25 files changed, 149 insertions(+), 148 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/action/impl/ExportChatMessages.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/action/impl/ExportChatMessages.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/action/impl/ExportChatMessages.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/action/impl/ExportChatMessages.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -176,7 +176,7 @@ class ExportChatMessages : AbstractAction() {
</a>             }
 
             fetchedMessages.firstOrNull()?.let {
<a href="#h0-0-3" id="h0-0-3" class="d">-                lastMessageId = it.messageDescriptor.messageId
</a><a href="#h0-0-4" id="h0-0-4" class="i">+                lastMessageId = it.messageDescriptor!!.messageId!!
</a>             }
             setStatus(&quot;Exporting (${foundMessages.size} / ${foundMessages.firstOrNull()?.orderKey})&quot;)
         }
<b>diff --git a/<a id="h1" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ScopeSync.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ScopeSync.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ScopeSync.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ScopeSync.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -29,7 +29,7 @@ class ScopeSync : Feature(&quot;Scope Sync&quot;, loadParams = FeatureLoadParams.INIT_SYNC
</a>             if (event.messageContent.contentType != ContentType.SNAP) return@subscribe
 
             event.addCallbackResult(&quot;onSuccess&quot;) {
<a href="#h1-0-3" id="h1-0-3" class="d">-                event.destinations.conversations.map { it.toString() }.forEach { conversationId -&gt;
</a><a href="#h1-0-4" id="h1-0-4" class="i">+                event.destinations.conversations!!.map { it.toString() }.forEach { conversationId -&gt;
</a>                     updateJobs[conversationId]?.also { it.cancel() }
 
                     updateJobs[conversationId] = (context.coroutineScope.launch {
<b>diff --git a/<a id="h2" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/decoder/MessageDecoder.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/decoder/MessageDecoder.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/decoder/MessageDecoder.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/decoder/MessageDecoder.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -77,7 +77,7 @@ object MessageDecoder {
</a> 
     fun decode(messageContent: MessageContent): List&lt;DecodedAttachment&gt; {
         return decode(
<a href="#h2-0-3" id="h2-0-3" class="d">-            ProtoReader(messageContent.content),
</a><a href="#h2-0-4" id="h2-0-4" class="i">+            ProtoReader(messageContent.content!!),
</a>             customMediaReferences = getEncodedMediaReferences(gson.toJsonTree(messageContent.instanceNonNull()))
         )
     }
<b>diff --git a/<a id="h3" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/experiments/SnapToChatMedia.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/experiments/SnapToChatMedia.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/experiments/SnapToChatMedia.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/experiments/SnapToChatMedia.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -12,10 +12,10 @@ class SnapToChatMedia : Feature(&quot;SnapToChatMedia&quot;, loadParams = FeatureLoadParam
</a>         if (!context.config.experimental.snapToChatMedia.get()) return
 
         context.event.subscribe(BuildMessageEvent::class, priority = 100) { event -&gt;
<a href="#h3-0-3" id="h3-0-3" class="d">-            if (event.message.messageContent.contentType != ContentType.SNAP) return@subscribe
</a><a href="#h3-0-4" id="h3-0-4" class="i">+            if (event.message.messageContent!!.contentType != ContentType.SNAP) return@subscribe
</a> 
<a href="#h3-0-6" id="h3-0-6" class="d">-            val snapMessageContent = ProtoReader(event.message.messageContent.content).followPath(11)?.getBuffer() ?: return@subscribe
</a><a href="#h3-0-7" id="h3-0-7" class="d">-            event.message.messageContent.content = ProtoWriter().apply {
</a><a href="#h3-0-8" id="h3-0-8" class="i">+            val snapMessageContent = ProtoReader(event.message.messageContent!!.content!!).followPath(11)?.getBuffer() ?: return@subscribe
</a><a href="#h3-0-9" id="h3-0-9" class="i">+            event.message.messageContent!!.content = ProtoWriter().apply {
</a>                 from(3) {
                     addBuffer(3, snapMessageContent)
                 }
<b>diff --git a/<a id="h4" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/global/BypassVideoLengthRestriction.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/global/BypassVideoLengthRestriction.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/global/BypassVideoLengthRestriction.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/global/BypassVideoLengthRestriction.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -40,7 +40,7 @@ class BypassVideoLengthRestriction :
</a>                 })
 
                 context.event.subscribe(SendMessageWithContentEvent::class) { event -&gt;
<a href="#h4-0-3" id="h4-0-3" class="d">-                    if (event.destinations.stories.isEmpty()) return@subscribe
</a><a href="#h4-0-4" id="h4-0-4" class="i">+                    if (event.destinations.stories!!.isEmpty()) return@subscribe
</a>                     fileObserver.startWatching()
                 }
             }
<b>diff --git a/<a id="h5" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/AutoSave.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/AutoSave.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/AutoSave.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/AutoSave.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -26,8 +26,8 @@ class AutoSave : MessagingRuleFeature(&quot;Auto Save&quot;, MessagingRuleType.AUTO_SAVE, 
</a>     }
 
     private fun saveMessage(conversationId: SnapUUID, message: Message) {
<a href="#h5-0-3" id="h5-0-3" class="d">-        val messageId = message.messageDescriptor.messageId
</a><a href="#h5-0-4" id="h5-0-4" class="d">-        if (messageLogger.takeIf { it.isEnabled }?.isMessageDeleted(conversationId.toString(), message.messageDescriptor.messageId) == true) return
</a><a href="#h5-0-5" id="h5-0-5" class="i">+        val messageId = message.messageDescriptor!!.messageId!!
</a><a href="#h5-0-6" id="h5-0-6" class="i">+        if (messageLogger.takeIf { it.isEnabled }?.isMessageDeleted(conversationId.toString(), messageId) == true) return
</a>         if (message.messageState != MessageState.COMMITTED) return
 
         runCatching {
<a href="#h5-1" id="h5-1" class="h">@@ -50,8 +50,8 @@ class AutoSave : MessagingRuleFeature(&quot;Auto Save&quot;, MessagingRuleType.AUTO_SAVE, 
</a> 
     private fun canSaveMessage(message: Message): Boolean {
         if (context.mainActivity == null || context.isMainActivityPaused) return false
<a href="#h5-1-3" id="h5-1-3" class="d">-        if (message.messageMetadata.savedBy.any { uuid -&gt; uuid.toString() == context.database.myUserId }) return false
</a><a href="#h5-1-4" id="h5-1-4" class="d">-        val contentType = message.messageContent.contentType.toString()
</a><a href="#h5-1-5" id="h5-1-5" class="i">+        if (message.messageMetadata!!.savedBy!!.any { uuid -&gt; uuid.toString() == context.database.myUserId }) return false
</a><a href="#h5-1-6" id="h5-1-6" class="i">+        val contentType = message.messageContent!!.contentType.toString()
</a> 
         return autoSaveFilter.any { it == contentType }
     }
<a href="#h5-2" id="h5-2" class="h">@@ -96,7 +96,7 @@ class AutoSave : MessagingRuleFeature(&quot;Auto Save&quot;, MessagingRuleType.AUTO_SAVE, 
</a>             { autoSaveFilter.isNotEmpty() }
         ) { param -&gt;
             val message = Message(param.arg(0))
<a href="#h5-2-3" id="h5-2-3" class="d">-            val conversationId = message.messageDescriptor.conversationId
</a><a href="#h5-2-4" id="h5-2-4" class="i">+            val conversationId = message.messageDescriptor!!.conversationId!!
</a>             if (!canSaveInConversation(conversationId.toString())) return@hook
             if (!canSaveMessage(message)) return@hook
 
<b>diff --git a/<a id="h6" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/InstantDelete.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/InstantDelete.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/InstantDelete.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/InstantDelete.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -68,11 +68,11 @@ class InstantDelete : Feature(&quot;InstantDelete&quot;, loadParams = FeatureLoadParams.AC
</a> 
                     if (chatActionMenuOptions[&quot;chat_action_menu_erase_quote&quot;] == menuOptionText.text) {
                         conversationManager.fetchMessage(conversationId, messageId.toLong(), onSuccess = { message -&gt;
<a href="#h6-0-3" id="h6-0-3" class="d">-                            val quotedMessage = message.messageContent.quotedMessage.takeIf { it.isPresent() }!!
</a><a href="#h6-0-4" id="h6-0-4" class="i">+                            val quotedMessage = message.messageContent!!.quotedMessage!!.takeIf { it.isPresent() }!!
</a> 
                             conversationManager.updateMessage(
                                 conversationId,
<a href="#h6-0-8" id="h6-0-8" class="d">-                                quotedMessage.content.messageId,
</a><a href="#h6-0-9" id="h6-0-9" class="i">+                                quotedMessage.content!!.messageId!!,
</a>                                 MessageUpdate.ERASE,
                                 onResult = onCallbackResult
                             )
<b>diff --git a/<a id="h7" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/Notifications.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/Notifications.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/Notifications.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/Notifications.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -27,7 +27,6 @@ import me.rhunk.snapenhance.core.features.FeatureLoadParams
</a> import me.rhunk.snapenhance.core.features.impl.downloader.MediaDownloader
 import me.rhunk.snapenhance.core.features.impl.downloader.decoder.MessageDecoder
 import me.rhunk.snapenhance.core.features.impl.spying.StealthMode
<a href="#h7-0-3" id="h7-0-3" class="d">-import me.rhunk.snapenhance.core.util.CallbackBuilder
</a> import me.rhunk.snapenhance.core.util.hook.HookStage
 import me.rhunk.snapenhance.core.util.hook.hook
 import me.rhunk.snapenhance.core.util.ktx.setObjectField
<a href="#h7-1" id="h7-1" class="h">@@ -264,14 +263,14 @@ class Notifications : Feature(&quot;Notifications&quot;, loadParams = FeatureLoadParams.IN
</a>                     }
                 }
 
<a href="#h7-1-3" id="h7-1-3" class="d">-                val contentType = snapMessage.messageContent.contentType ?: return@onEach
</a><a href="#h7-1-4" id="h7-1-4" class="d">-                val contentData = snapMessage.messageContent.content
</a><a href="#h7-1-5" id="h7-1-5" class="i">+                val contentType = snapMessage.messageContent!!.contentType ?: return@onEach
</a><a href="#h7-1-6" id="h7-1-6" class="i">+                val contentData = snapMessage.messageContent!!.content!!
</a> 
                 val formatUsername: (String) -&gt; String = { &quot;$senderUsername: $it&quot; }
                 val notificationCache = cachedMessages.let { it.computeIfAbsent(conversationId) { mutableListOf() } }
                 val appendNotifications: () -&gt; Unit = { setNotificationText(notificationData.notification, conversationId)}
 
<a href="#h7-1-12" id="h7-1-12" class="d">-                setupNotificationActionButtons(contentType, conversationId, snapMessage.messageDescriptor.messageId, notificationData)
</a><a href="#h7-1-13" id="h7-1-13" class="i">+                setupNotificationActionButtons(contentType, conversationId, snapMessage.messageDescriptor!!.messageId!!, notificationData)
</a> 
                 when (contentType) {
                     ContentType.NOTE -&gt; {
<a href="#h7-2" id="h7-2" class="h">@@ -286,14 +285,14 @@ class Notifications : Feature(&quot;Notifications&quot;, loadParams = FeatureLoadParams.IN
</a>                     }
                     ContentType.SNAP, ContentType.EXTERNAL_MEDIA -&gt; {
                         val mediaReferences = MessageDecoder.getMediaReferences(
<a href="#h7-2-3" id="h7-2-3" class="d">-                            messageContent = context.gson.toJsonTree(snapMessage.messageContent.instanceNonNull())
</a><a href="#h7-2-4" id="h7-2-4" class="i">+                            messageContent = context.gson.toJsonTree(snapMessage.messageContent!!.instanceNonNull())
</a>                         )
 
                         val mediaReferenceKeys = mediaReferences.map { reference -&gt;
                             reference.asJsonObject.getAsJsonArray(&quot;mContentObject&quot;).map { it.asByte }.toByteArray()
                         }
 
<a href="#h7-2-11" id="h7-2-11" class="d">-                        MessageDecoder.decode(snapMessage.messageContent).firstOrNull()?.also { media -&gt;
</a><a href="#h7-2-12" id="h7-2-12" class="i">+                        MessageDecoder.decode(snapMessage.messageContent!!).firstOrNull()?.also { media -&gt;
</a>                             val mediaType = MediaReferenceType.valueOf(mediaReferences.first().asJsonObject[&quot;mMediaType&quot;].asString)
 
                             runCatching {
<b>diff --git a/<a id="h8" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/SendOverride.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/SendOverride.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/SendOverride.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/SendOverride.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -58,7 +58,7 @@ class SendOverride : Feature(&quot;Send Override&quot;, loadParams = FeatureLoadParams.INI
</a>             if (localMessageContent.contentType != ContentType.EXTERNAL_MEDIA) return@subscribe
 
             //prevent story replies
<a href="#h8-0-3" id="h8-0-3" class="d">-            val messageProtoReader = ProtoReader(localMessageContent.content)
</a><a href="#h8-0-4" id="h8-0-4" class="i">+            val messageProtoReader = ProtoReader(localMessageContent.content!!)
</a>             if (messageProtoReader.contains(7)) return@subscribe
 
             event.canceled = true
<b>diff --git a/<a id="h9" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/UnlimitedSnapViewTime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/UnlimitedSnapViewTime.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/UnlimitedSnapViewTime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/messaging/UnlimitedSnapViewTime.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -15,13 +15,13 @@ class UnlimitedSnapViewTime :
</a> 
         context.event.subscribe(BuildMessageEvent::class, { state }, priority = 101) { event -&gt;
             if (event.message.messageState != MessageState.COMMITTED) return@subscribe
<a href="#h9-0-3" id="h9-0-3" class="d">-            if (event.message.messageContent.contentType != ContentType.SNAP) return@subscribe
</a><a href="#h9-0-4" id="h9-0-4" class="i">+            if (event.message.messageContent!!.contentType != ContentType.SNAP) return@subscribe
</a> 
             val messageContent = event.message.messageContent
 
<a href="#h9-0-8" id="h9-0-8" class="d">-            val mediaAttributes = ProtoReader(messageContent.content).followPath(11, 5, 2) ?: return@subscribe
</a><a href="#h9-0-9" id="h9-0-9" class="i">+            val mediaAttributes = ProtoReader(messageContent!!.content!!).followPath(11, 5, 2) ?: return@subscribe
</a>             if (mediaAttributes.contains(6)) return@subscribe
<a href="#h9-0-11" id="h9-0-11" class="d">-            messageContent.content = ProtoEditor(messageContent.content).apply {
</a><a href="#h9-0-12" id="h9-0-12" class="i">+            messageContent.content = ProtoEditor(messageContent.content!!).apply {
</a>                 edit(11, 5, 2) {
                     remove(8)
                     addBuffer(6, byteArrayOf())
<b>diff --git a/<a id="h10" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/spying/MessageLogger.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/spying/MessageLogger.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/spying/MessageLogger.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/spying/MessageLogger.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -101,14 +101,14 @@ class MessageLogger : Feature(&quot;MessageLogger&quot;,
</a>             val messageInstance = event.message.instanceNonNull()
             if (event.message.messageState != MessageState.COMMITTED) return@subscribe
 
<a href="#h10-0-3" id="h10-0-3" class="d">-            cachedIdLinks[event.message.messageDescriptor.messageId] = event.message.orderKey
</a><a href="#h10-0-4" id="h10-0-4" class="d">-            val conversationId = event.message.messageDescriptor.conversationId.toString()
</a><a href="#h10-0-5" id="h10-0-5" class="i">+            cachedIdLinks[event.message.messageDescriptor!!.messageId!!] = event.message.orderKey!!
</a><a href="#h10-0-6" id="h10-0-6" class="i">+            val conversationId = event.message.messageDescriptor!!.conversationId.toString()
</a>             //exclude messages sent by me
             if (event.message.senderId.toString() == context.database.myUserId) return@subscribe
 
<a href="#h10-0-10" id="h10-0-10" class="d">-            val uniqueMessageIdentifier = computeMessageIdentifier(conversationId, event.message.orderKey)
</a><a href="#h10-0-11" id="h10-0-11" class="i">+            val uniqueMessageIdentifier = computeMessageIdentifier(conversationId, event.message.orderKey!!)
</a> 
<a href="#h10-0-13" id="h10-0-13" class="d">-            if (event.message.messageContent.contentType != ContentType.STATUS) {
</a><a href="#h10-0-14" id="h10-0-14" class="i">+            if (event.message.messageContent!!.contentType != ContentType.STATUS) {
</a>                 if (fetchedMessages.contains(uniqueMessageIdentifier)) return@subscribe
                 fetchedMessages.add(uniqueMessageIdentifier)
 
<b>diff --git a/<a id="h11" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/CoreMessagingBridge.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/CoreMessagingBridge.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/CoreMessagingBridge.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/CoreMessagingBridge.kt</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -13,13 +13,13 @@ import me.rhunk.snapenhance.core.features.impl.messaging.Messaging
</a> 
 fun me.rhunk.snapenhance.core.wrapper.impl.Message.toBridge(): Message {
     return Message().also { output -&gt;
<a href="#h11-0-3" id="h11-0-3" class="d">-        output.conversationId = this.messageDescriptor.conversationId.toString()
</a><a href="#h11-0-4" id="h11-0-4" class="i">+        output.conversationId = this.messageDescriptor!!.conversationId.toString()
</a>         output.senderId = this.senderId.toString()
<a href="#h11-0-6" id="h11-0-6" class="d">-        output.clientMessageId = this.messageDescriptor.messageId
</a><a href="#h11-0-7" id="h11-0-7" class="d">-        output.serverMessageId = this.orderKey
</a><a href="#h11-0-8" id="h11-0-8" class="d">-        output.contentType = this.messageContent.contentType?.id ?: -1
</a><a href="#h11-0-9" id="h11-0-9" class="d">-        output.content = this.messageContent.content
</a><a href="#h11-0-10" id="h11-0-10" class="d">-        output.mediaReferences = MessageDecoder.getEncodedMediaReferences(this.messageContent)
</a><a href="#h11-0-11" id="h11-0-11" class="i">+        output.clientMessageId = this.messageDescriptor!!.messageId!!
</a><a href="#h11-0-12" id="h11-0-12" class="i">+        output.serverMessageId = this.orderKey!!
</a><a href="#h11-0-13" id="h11-0-13" class="i">+        output.contentType = this.messageContent?.contentType?.id ?: -1
</a><a href="#h11-0-14" id="h11-0-14" class="i">+        output.content = this.messageContent?.content
</a><a href="#h11-0-15" id="h11-0-15" class="i">+        output.mediaReferences = MessageDecoder.getEncodedMediaReferences(this.messageContent!!)
</a>     }
 }
 
<b>diff --git a/<a id="h12" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageExporter.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageExporter.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageExporter.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageExporter.kt</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -74,8 +74,8 @@ class MessageExporter(
</a>     }
 
     private fun serializeMessageContent(message: Message): String? {
<a href="#h12-0-3" id="h12-0-3" class="d">-        return if (message.messageContent.contentType == ContentType.CHAT) {
</a><a href="#h12-0-4" id="h12-0-4" class="d">-            ProtoReader(message.messageContent.content).getString(2, 1) ?: &quot;Failed to parse message&quot;
</a><a href="#h12-0-5" id="h12-0-5" class="i">+        return if (message.messageContent!!.contentType == ContentType.CHAT) {
</a><a href="#h12-0-6" id="h12-0-6" class="i">+            ProtoReader(message.messageContent!!.content!!).getString(2, 1) ?: &quot;Failed to parse message&quot;
</a>         } else null
     }
 
<a href="#h12-1" id="h12-1" class="h">@@ -93,8 +93,8 @@ class MessageExporter(
</a>             val sender = conversationParticipants[message.senderId.toString()]
             val senderUsername = sender?.usernameForSorting ?: message.senderId.toString()
             val senderDisplayName = sender?.displayName ?: message.senderId.toString()
<a href="#h12-1-3" id="h12-1-3" class="d">-            val messageContent = serializeMessageContent(message) ?: message.messageContent.contentType?.name
</a><a href="#h12-1-4" id="h12-1-4" class="d">-            val date = SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;, Locale.ENGLISH).format(Date(message.messageMetadata.createdAt))
</a><a href="#h12-1-5" id="h12-1-5" class="i">+            val messageContent = serializeMessageContent(message) ?: message.messageContent!!.contentType?.name
</a><a href="#h12-1-6" id="h12-1-6" class="i">+            val date = SimpleDateFormat(&quot;yyyy-MM-dd HH:mm:ss&quot;, Locale.ENGLISH).format(Date(message.messageMetadata!!.createdAt!!))
</a>             writer.write(&quot;[$date] - $senderDisplayName (${senderUsername}): $messageContent\n&quot;)
         }
         writer.flush()
<a href="#h12-2" id="h12-2" class="h">@@ -110,17 +110,17 @@ class MessageExporter(
</a> 
             fun updateProgress(type: String) {
                 val total = messages.filter {
<a href="#h12-2-3" id="h12-2-3" class="d">-                    mediaToDownload?.contains(it.messageContent.contentType) ?: false
</a><a href="#h12-2-4" id="h12-2-4" class="i">+                    mediaToDownload?.contains(it.messageContent!!.contentType) ?: false
</a>                 }.size
                 processCount++
                 printLog(&quot;$type $processCount/$total&quot;)
             }
 
             messages.filter {
<a href="#h12-2-11" id="h12-2-11" class="d">-                mediaToDownload?.contains(it.messageContent.contentType) ?: false
</a><a href="#h12-2-12" id="h12-2-12" class="i">+                mediaToDownload?.contains(it.messageContent!!.contentType) ?: false
</a>             }.forEach { message -&gt;
                 threadPool.execute {
<a href="#h12-2-15" id="h12-2-15" class="d">-                    MessageDecoder.decode(message.messageContent).forEach decode@{ attachment -&gt;
</a><a href="#h12-2-16" id="h12-2-16" class="i">+                    MessageDecoder.decode(message.messageContent!!).forEach decode@{ attachment -&gt;
</a>                         val protoMediaReference = Base64.UrlSafe.decode(attachment.mediaUrlKey ?: return@decode)
 
                         runCatching {
<a href="#h12-3" id="h12-3" class="h">@@ -145,8 +145,8 @@ class MessageExporter(
</a> 
                             updateProgress(&quot;downloaded&quot;)
                         }.onFailure {
<a href="#h12-3-3" id="h12-3-3" class="d">-                            printLog(&quot;failed to download media for ${message.messageDescriptor.conversationId}_${message.orderKey}&quot;)
</a><a href="#h12-3-4" id="h12-3-4" class="d">-                            context.log.error(&quot;failed to download media for ${message.messageDescriptor.conversationId}_${message.orderKey}&quot;, it)
</a><a href="#h12-3-5" id="h12-3-5" class="i">+                            printLog(&quot;failed to download media for ${message.messageDescriptor!!.conversationId}_${message.orderKey}&quot;)
</a><a href="#h12-3-6" id="h12-3-6" class="i">+                            context.log.error(&quot;failed to download media for ${message.messageDescriptor!!.conversationId}_${message.orderKey}&quot;, it)
</a>                         }
                     }
                 }
<a href="#h12-4" id="h12-4" class="h">@@ -270,7 +270,7 @@ class MessageExporter(
</a>                     add(JsonObject().apply {
                         addProperty(&quot;orderKey&quot;, message.orderKey)
                         addProperty(&quot;senderId&quot;, participants.getOrDefault(message.senderId.toString(), -1))
<a href="#h12-4-3" id="h12-4-3" class="d">-                        addProperty(&quot;type&quot;, message.messageContent.contentType.toString())
</a><a href="#h12-4-4" id="h12-4-4" class="i">+                        addProperty(&quot;type&quot;, message.messageContent!!.contentType.toString())
</a> 
                         fun addUUIDList(name: String, list: List&lt;SnapUUID&gt;) {
                             add(name, JsonArray().apply {
<a href="#h12-5" id="h12-5" class="h">@@ -278,12 +278,12 @@ class MessageExporter(
</a>                             })
                         }
 
<a href="#h12-5-3" id="h12-5-3" class="d">-                        addUUIDList(&quot;savedBy&quot;, message.messageMetadata.savedBy)
</a><a href="#h12-5-4" id="h12-5-4" class="d">-                        addUUIDList(&quot;seenBy&quot;, message.messageMetadata.seenBy)
</a><a href="#h12-5-5" id="h12-5-5" class="d">-                        addUUIDList(&quot;openedBy&quot;, message.messageMetadata.openedBy)
</a><a href="#h12-5-6" id="h12-5-6" class="i">+                        addUUIDList(&quot;savedBy&quot;, message.messageMetadata!!.savedBy!!)
</a><a href="#h12-5-7" id="h12-5-7" class="i">+                        addUUIDList(&quot;seenBy&quot;, message.messageMetadata!!.seenBy!!)
</a><a href="#h12-5-8" id="h12-5-8" class="i">+                        addUUIDList(&quot;openedBy&quot;, message.messageMetadata!!.openedBy!!)
</a> 
                         add(&quot;reactions&quot;, JsonObject().apply {
<a href="#h12-5-11" id="h12-5-11" class="d">-                            message.messageMetadata.reactions.forEach { reaction -&gt;
</a><a href="#h12-5-12" id="h12-5-12" class="i">+                            message.messageMetadata!!.reactions!!.forEach { reaction -&gt;
</a>                                 addProperty(
                                     participants.getOrDefault(reaction.userId.toString(), -1L).toString(),
                                     reaction.reactionId
<a href="#h12-6" id="h12-6" class="h">@@ -291,13 +291,13 @@ class MessageExporter(
</a>                             }
                         })
 
<a href="#h12-6-3" id="h12-6-3" class="d">-                        addProperty(&quot;createdTimestamp&quot;, message.messageMetadata.createdAt)
</a><a href="#h12-6-4" id="h12-6-4" class="d">-                        addProperty(&quot;readTimestamp&quot;, message.messageMetadata.readAt)
</a><a href="#h12-6-5" id="h12-6-5" class="i">+                        addProperty(&quot;createdTimestamp&quot;, message.messageMetadata!!.createdAt)
</a><a href="#h12-6-6" id="h12-6-6" class="i">+                        addProperty(&quot;readTimestamp&quot;, message.messageMetadata!!.readAt)
</a>                         addProperty(&quot;serializedContent&quot;, serializeMessageContent(message))
<a href="#h12-6-8" id="h12-6-8" class="d">-                        addProperty(&quot;rawContent&quot;, Base64.UrlSafe.encode(message.messageContent.content))
</a><a href="#h12-6-9" id="h12-6-9" class="i">+                        addProperty(&quot;rawContent&quot;, Base64.UrlSafe.encode(message.messageContent!!.content!!))
</a> 
                         add(&quot;attachments&quot;, JsonArray().apply {
<a href="#h12-6-12" id="h12-6-12" class="d">-                            MessageDecoder.decode(message.messageContent)
</a><a href="#h12-6-13" id="h12-6-13" class="i">+                            MessageDecoder.decode(message.messageContent!!)
</a>                                 .forEach attachments@{ attachments -&gt;
                                 if (attachments.type == AttachmentType.STICKER) //TODO: implement stickers
                                     return@attachments
<b>diff --git a/<a id="h13" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageSender.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageSender.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageSender.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessageSender.kt</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -94,12 +94,12 @@ class MessageSender(
</a> 
         val localMessageContent = context.gson.fromJson(localMessageContentTemplate, context.classCache.localMessageContent)
         val messageDestinations = MessageDestinations(AbstractWrapper.newEmptyInstance(context.classCache.messageDestinations)).also {
<a href="#h13-0-3" id="h13-0-3" class="d">-            it.conversations = conversations
</a><a href="#h13-0-4" id="h13-0-4" class="d">-            it.mPhoneNumbers = arrayListOf()
</a><a href="#h13-0-5" id="h13-0-5" class="d">-            it.stories = arrayListOf()
</a><a href="#h13-0-6" id="h13-0-6" class="i">+            it.conversations = conversations.toCollection(ArrayList())
</a><a href="#h13-0-7" id="h13-0-7" class="i">+            it.mPhoneNumbers = arrayListOf&lt;Any&gt;()
</a><a href="#h13-0-8" id="h13-0-8" class="i">+            it.stories = arrayListOf&lt;Any&gt;()
</a>         }
 
<a href="#h13-0-11" id="h13-0-11" class="d">-        sendMessageWithContentMethod.invoke(context.feature(Messaging::class).conversationManager, messageDestinations.instanceNonNull(), localMessageContent, callback)
</a><a href="#h13-0-12" id="h13-0-12" class="i">+        sendMessageWithContentMethod.invoke(context.feature(Messaging::class).conversationManager?.instanceNonNull(), messageDestinations.instanceNonNull(), localMessageContent, callback)
</a>     }
 
     fun sendChatMessage(conversations: List&lt;SnapUUID&gt;, message: String, onError: (Any) -&gt; Unit = {}, onSuccess: () -&gt; Unit = {}) {
<b>diff --git a/<a id="h14" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/AbstractWrapper.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/AbstractWrapper.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/AbstractWrapper.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/AbstractWrapper.kt</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -2,24 +2,47 @@ package me.rhunk.snapenhance.core.wrapper
</a> 
 import de.robv.android.xposed.XposedHelpers
 import me.rhunk.snapenhance.core.util.CallbackBuilder
<a href="#h14-0-3" id="h14-0-3" class="i">+import me.rhunk.snapenhance.core.wrapper.impl.SnapUUID
</a> import kotlin.reflect.KProperty
 
 abstract class AbstractWrapper(
     protected var instance: Any?
 ) {
<a href="#h14-0-9" id="h14-0-9" class="i">+    protected val uuidArrayListMapper: (Any?) -&gt; ArrayList&lt;SnapUUID&gt; get() = { (it as ArrayList&lt;*&gt;).map { i -&gt; SnapUUID(i) }.toCollection(ArrayList()) }
</a><a href="#h14-0-10" id="h14-0-10" class="i">+
</a>     @Suppress(&quot;UNCHECKED_CAST&quot;)
     inner class EnumAccessor&lt;T&gt;(private val fieldName: String, private val defaultValue: T) {
         operator fun getValue(obj: Any, property: KProperty&lt;*&gt;): T? = getEnumValue(fieldName, defaultValue as Enum&lt;*&gt;) as? T
         operator fun setValue(obj: Any, property: KProperty&lt;*&gt;, value: Any?) = setEnumValue(fieldName, value as Enum&lt;*&gt;)
     }
 
<a href="#h14-0-17" id="h14-0-17" class="i">+    inner class FieldAccessor&lt;T&gt;(private val fieldName: String, private val mapper: ((Any?) -&gt; T?)? = null) {
</a><a href="#h14-0-18" id="h14-0-18" class="i">+        @Suppress(&quot;UNCHECKED_CAST&quot;)
</a><a href="#h14-0-19" id="h14-0-19" class="i">+        operator fun getValue(obj: Any, property: KProperty&lt;*&gt;): T? {
</a><a href="#h14-0-20" id="h14-0-20" class="i">+            val value = XposedHelpers.getObjectField(instance, fieldName)
</a><a href="#h14-0-21" id="h14-0-21" class="i">+            return if (mapper != null) {
</a><a href="#h14-0-22" id="h14-0-22" class="i">+                mapper.invoke(value)
</a><a href="#h14-0-23" id="h14-0-23" class="i">+            } else {
</a><a href="#h14-0-24" id="h14-0-24" class="i">+                value as? T
</a><a href="#h14-0-25" id="h14-0-25" class="i">+            }
</a><a href="#h14-0-26" id="h14-0-26" class="i">+        }
</a><a href="#h14-0-27" id="h14-0-27" class="i">+
</a><a href="#h14-0-28" id="h14-0-28" class="i">+        operator fun setValue(obj: Any, property: KProperty&lt;*&gt;, value: Any?) {
</a><a href="#h14-0-29" id="h14-0-29" class="i">+            XposedHelpers.setObjectField(instance, fieldName, when (value) {
</a><a href="#h14-0-30" id="h14-0-30" class="i">+                is AbstractWrapper -&gt; value.instance
</a><a href="#h14-0-31" id="h14-0-31" class="i">+                is ArrayList&lt;*&gt; -&gt; value.map { if (it is AbstractWrapper) it.instance else it }.toMutableList()
</a><a href="#h14-0-32" id="h14-0-32" class="i">+                else -&gt; value
</a><a href="#h14-0-33" id="h14-0-33" class="i">+            })
</a><a href="#h14-0-34" id="h14-0-34" class="i">+        }
</a><a href="#h14-0-35" id="h14-0-35" class="i">+    }
</a><a href="#h14-0-36" id="h14-0-36" class="i">+
</a>     companion object {
         fun newEmptyInstance(clazz: Class&lt;*&gt;): Any {
             return CallbackBuilder.createEmptyObject(clazz.constructors[0]) ?: throw NullPointerException()
         }
     }
 
<a href="#h14-0-43" id="h14-0-43" class="d">-    fun instanceNonNull(): Any = instance!!
</a><a href="#h14-0-44" id="h14-0-44" class="i">+    fun instanceNonNull(): Any = instance ?: throw NullPointerException(&quot;Instance of ${this::class.simpleName} is null&quot;)
</a>     fun isPresent(): Boolean = instance != null
 
     override fun hashCode(): Int {
<a href="#h14-1" id="h14-1" class="h">@@ -31,6 +54,7 @@ abstract class AbstractWrapper(
</a>     }
 
     protected fun &lt;T&gt; enum(fieldName: String, defaultValue: T) = EnumAccessor(fieldName, defaultValue)
<a href="#h14-1-3" id="h14-1-3" class="i">+    protected fun &lt;T&gt; field(fieldName: String, mapper: ((Any?) -&gt; T?)? = null) = FieldAccessor(fieldName, mapper)
</a> 
     fun &lt;T : Enum&lt;*&gt;&gt; getEnumValue(fieldName: String, defaultValue: T?): T? {
         if (defaultValue == null) return null
<b>diff --git a/<a id="h15" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/ConversationManager.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/ConversationManager.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/ConversationManager.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/ConversationManager.kt</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -7,7 +7,10 @@ import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
</a> 
 typealias CallbackResult = (error: String?) -&gt; Unit
 
<a href="#h15-0-3" id="h15-0-3" class="d">-class ConversationManager(val context: ModContext, obj: Any) : AbstractWrapper(obj) {
</a><a href="#h15-0-4" id="h15-0-4" class="i">+class ConversationManager(
</a><a href="#h15-0-5" id="h15-0-5" class="i">+    val context: ModContext,
</a><a href="#h15-0-6" id="h15-0-6" class="i">+    obj: Any
</a><a href="#h15-0-7" id="h15-0-7" class="i">+) : AbstractWrapper(obj) {
</a>     private fun findMethodByName(name: String) = context.classCache.conversationManager.declaredMethods.find { it.name == name } ?: throw RuntimeException(&quot;Could not find method $name&quot;)
 
     private val updateMessageMethod by lazy { findMethodByName(&quot;updateMessage&quot;) }
<b>diff --git a/<a id="h16" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/FriendActionButton.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/FriendActionButton.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/FriendActionButton.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/FriendActionButton.kt</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -1,38 +0,0 @@
</a><a href="#h16-0-0" id="h16-0-0" class="d">-package me.rhunk.snapenhance.core.wrapper.impl
</a><a href="#h16-0-1" id="h16-0-1" class="d">-
</a><a href="#h16-0-2" id="h16-0-2" class="d">-import android.content.Context
</a><a href="#h16-0-3" id="h16-0-3" class="d">-import android.graphics.drawable.Drawable
</a><a href="#h16-0-4" id="h16-0-4" class="d">-import android.util.AttributeSet
</a><a href="#h16-0-5" id="h16-0-5" class="d">-import android.view.View
</a><a href="#h16-0-6" id="h16-0-6" class="d">-import me.rhunk.snapenhance.core.SnapEnhance
</a><a href="#h16-0-7" id="h16-0-7" class="d">-import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
</a><a href="#h16-0-8" id="h16-0-8" class="d">-
</a><a href="#h16-0-9" id="h16-0-9" class="d">-class FriendActionButton(
</a><a href="#h16-0-10" id="h16-0-10" class="d">-    obj: View
</a><a href="#h16-0-11" id="h16-0-11" class="d">-) : AbstractWrapper(obj) {
</a><a href="#h16-0-12" id="h16-0-12" class="d">-    private val iconDrawableContainer by lazy {
</a><a href="#h16-0-13" id="h16-0-13" class="d">-        instanceNonNull().javaClass.declaredFields.first { it.type != Int::class.javaPrimitiveType }[instanceNonNull()]
</a><a href="#h16-0-14" id="h16-0-14" class="d">-    }
</a><a href="#h16-0-15" id="h16-0-15" class="d">-
</a><a href="#h16-0-16" id="h16-0-16" class="d">-    private val setIconDrawableMethod by lazy {
</a><a href="#h16-0-17" id="h16-0-17" class="d">-        iconDrawableContainer.javaClass.declaredMethods.first {
</a><a href="#h16-0-18" id="h16-0-18" class="d">-            it.parameterTypes.size == 1 &amp;&amp;
</a><a href="#h16-0-19" id="h16-0-19" class="d">-                    it.parameterTypes[0] == Drawable::class.java &amp;&amp;
</a><a href="#h16-0-20" id="h16-0-20" class="d">-                    it.name != &quot;invalidateDrawable&quot; &amp;&amp;
</a><a href="#h16-0-21" id="h16-0-21" class="d">-                    it.returnType == Void::class.javaPrimitiveType
</a><a href="#h16-0-22" id="h16-0-22" class="d">-        }
</a><a href="#h16-0-23" id="h16-0-23" class="d">-    }
</a><a href="#h16-0-24" id="h16-0-24" class="d">-
</a><a href="#h16-0-25" id="h16-0-25" class="d">-    fun setIconDrawable(drawable: Drawable) {
</a><a href="#h16-0-26" id="h16-0-26" class="d">-        setIconDrawableMethod.invoke(iconDrawableContainer, drawable)
</a><a href="#h16-0-27" id="h16-0-27" class="d">-    }
</a><a href="#h16-0-28" id="h16-0-28" class="d">-
</a><a href="#h16-0-29" id="h16-0-29" class="d">-    companion object {
</a><a href="#h16-0-30" id="h16-0-30" class="d">-        fun new(context: Context): FriendActionButton {
</a><a href="#h16-0-31" id="h16-0-31" class="d">-            val instance = SnapEnhance.classLoader.loadClass(&quot;com.snap.profile.shared.view.FriendActionButton&quot;)
</a><a href="#h16-0-32" id="h16-0-32" class="d">-                .getConstructor(Context::class.java, AttributeSet::class.java)
</a><a href="#h16-0-33" id="h16-0-33" class="d">-                .newInstance(context, null) as View
</a><a href="#h16-0-34" id="h16-0-34" class="d">-            return FriendActionButton(instance)
</a><a href="#h16-0-35" id="h16-0-35" class="d">-        }
</a><a href="#h16-0-36" id="h16-0-36" class="d">-    }
</a><a href="#h16-0-37" id="h16-0-37" class="d">-}</a><a href="#h16-0-38" id="h16-0-38" class="d">-
\ No newline at end of file
</a><b>diff --git a/<a id="h17" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/Message.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/Message.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/Message.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/Message.kt</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -1,14 +1,21 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
 import me.rhunk.snapenhance.common.data.MessageState
<a href="#h17-0-3" id="h17-0-3" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h17-0-5" id="h17-0-5" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h17-0-6" id="h17-0-6" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class Message(obj: Any?) : AbstractWrapper(obj) {
<a href="#h17-0-9" id="h17-0-9" class="d">-    val orderKey get() = instanceNonNull().getObjectField(&quot;mOrderKey&quot;) as Long
</a><a href="#h17-0-10" id="h17-0-10" class="d">-    val senderId get() = SnapUUID(instanceNonNull().getObjectField(&quot;mSenderId&quot;))
</a><a href="#h17-0-11" id="h17-0-11" class="d">-    val messageContent get() = MessageContent(instanceNonNull().getObjectField(&quot;mMessageContent&quot;))
</a><a href="#h17-0-12" id="h17-0-12" class="d">-    val messageDescriptor get() = MessageDescriptor(instanceNonNull().getObjectField(&quot;mDescriptor&quot;))
</a><a href="#h17-0-13" id="h17-0-13" class="d">-    val messageMetadata get() = MessageMetadata(instanceNonNull().getObjectField(&quot;mMetadata&quot;))
</a><a href="#h17-0-14" id="h17-0-14" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h17-0-15" id="h17-0-15" class="i">+    var orderKey by field&lt;Long&gt;(&quot;mOrderKey&quot;)
</a><a href="#h17-0-16" id="h17-0-16" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h17-0-17" id="h17-0-17" class="i">+    var senderId by field(&quot;mSenderId&quot;) { SnapUUID(it) }
</a><a href="#h17-0-18" id="h17-0-18" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h17-0-19" id="h17-0-19" class="i">+    var messageContent by field(&quot;mMessageContent&quot;) { MessageContent(it) }
</a><a href="#h17-0-20" id="h17-0-20" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h17-0-21" id="h17-0-21" class="i">+    var messageDescriptor by field(&quot;mDescriptor&quot;) { MessageDescriptor(it) }
</a><a href="#h17-0-22" id="h17-0-22" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h17-0-23" id="h17-0-23" class="i">+    var messageMetadata by field(&quot;mMetadata&quot;) { MessageMetadata(it) }
</a><a href="#h17-0-24" id="h17-0-24" class="i">+    @get:JSGetter @set:JSSetter
</a>     var messageState by enum(&quot;mState&quot;, MessageState.COMMITTED)
 } 
\ No newline at end of file
<b>diff --git a/<a id="h18" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageContent.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageContent.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageContent.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageContent.kt</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -1,15 +1,15 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
 import me.rhunk.snapenhance.common.data.ContentType
<a href="#h18-0-3" id="h18-0-3" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a><a href="#h18-0-4" id="h18-0-4" class="d">-import me.rhunk.snapenhance.core.util.ktx.setObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h18-0-6" id="h18-0-6" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h18-0-7" id="h18-0-7" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class MessageContent(obj: Any?) : AbstractWrapper(obj) {
<a href="#h18-0-10" id="h18-0-10" class="d">-    var content
</a><a href="#h18-0-11" id="h18-0-11" class="d">-        get() = instanceNonNull().getObjectField(&quot;mContent&quot;) as ByteArray
</a><a href="#h18-0-12" id="h18-0-12" class="d">-        set(value) = instanceNonNull().setObjectField(&quot;mContent&quot;, value)
</a><a href="#h18-0-13" id="h18-0-13" class="d">-    val quotedMessage
</a><a href="#h18-0-14" id="h18-0-14" class="d">-        get() = QuotedMessage(instanceNonNull().getObjectField(&quot;mQuotedMessage&quot;))
</a><a href="#h18-0-15" id="h18-0-15" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h18-0-16" id="h18-0-16" class="i">+    var content by field&lt;ByteArray&gt;(&quot;mContent&quot;)
</a><a href="#h18-0-17" id="h18-0-17" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h18-0-18" id="h18-0-18" class="i">+    var quotedMessage by field(&quot;mQuotedMessage&quot;) { QuotedMessage(it) }
</a><a href="#h18-0-19" id="h18-0-19" class="i">+    @get:JSGetter @set:JSSetter
</a>     var contentType by enum(&quot;mContentType&quot;, ContentType.UNKNOWN)
 } 
\ No newline at end of file
<b>diff --git a/<a id="h19" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDescriptor.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDescriptor.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDescriptor.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDescriptor.kt</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -1,9 +1,11 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
<a href="#h19-0-2" id="h19-0-2" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h19-0-4" id="h19-0-4" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h19-0-5" id="h19-0-5" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class MessageDescriptor(obj: Any?) : AbstractWrapper(obj) {
<a href="#h19-0-8" id="h19-0-8" class="d">-    val messageId: Long get() = instanceNonNull().getObjectField(&quot;mMessageId&quot;) as Long
</a><a href="#h19-0-9" id="h19-0-9" class="d">-    val conversationId: SnapUUID get() = SnapUUID(instanceNonNull().getObjectField(&quot;mConversationId&quot;)!!)
</a><a href="#h19-0-10" id="h19-0-10" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h19-0-11" id="h19-0-11" class="i">+    var messageId by field&lt;Long&gt;(&quot;mMessageId&quot;)
</a><a href="#h19-0-12" id="h19-0-12" class="i">+    val conversationId by field(&quot;mConversationId&quot;) { SnapUUID(it) }
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h20" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDestinations.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDestinations.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDestinations.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageDestinations.kt</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -1,15 +1,10 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
<a href="#h20-0-2" id="h20-0-2" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a><a href="#h20-0-3" id="h20-0-3" class="d">-import me.rhunk.snapenhance.core.util.ktx.setObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
 
 @Suppress(&quot;UNCHECKED_CAST&quot;)
 class MessageDestinations(obj: Any) : AbstractWrapper(obj){
<a href="#h20-0-8" id="h20-0-8" class="d">-    var conversations get() = (instanceNonNull().getObjectField(&quot;mConversations&quot;) as ArrayList&lt;*&gt;).map { SnapUUID(it) }
</a><a href="#h20-0-9" id="h20-0-9" class="d">-        set(value) = instanceNonNull().setObjectField(&quot;mConversations&quot;, value.map { it.instanceNonNull() }.toCollection(ArrayList()))
</a><a href="#h20-0-10" id="h20-0-10" class="d">-    var stories get() = instanceNonNull().getObjectField(&quot;mStories&quot;) as ArrayList&lt;Any&gt;
</a><a href="#h20-0-11" id="h20-0-11" class="d">-        set(value) = instanceNonNull().setObjectField(&quot;mStories&quot;, value)
</a><a href="#h20-0-12" id="h20-0-12" class="d">-    var mPhoneNumbers get() = instanceNonNull().getObjectField(&quot;mPhoneNumbers&quot;) as ArrayList&lt;Any&gt;
</a><a href="#h20-0-13" id="h20-0-13" class="d">-        set(value) = instanceNonNull().setObjectField(&quot;mPhoneNumbers&quot;, value)
</a><a href="#h20-0-14" id="h20-0-14" class="i">+    var conversations by field(&quot;mConversations&quot;, uuidArrayListMapper)
</a><a href="#h20-0-15" id="h20-0-15" class="i">+    var stories by field&lt;ArrayList&lt;*&gt;&gt;(&quot;mStories&quot;)
</a><a href="#h20-0-16" id="h20-0-16" class="i">+    var mPhoneNumbers by field&lt;ArrayList&lt;*&gt;&gt;(&quot;mPhoneNumbers&quot;)
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h21" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageMetadata.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageMetadata.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageMetadata.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/MessageMetadata.kt</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -1,28 +1,26 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
 import me.rhunk.snapenhance.common.data.PlayableSnapState
<a href="#h21-0-3" id="h21-0-3" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h21-0-5" id="h21-0-5" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h21-0-6" id="h21-0-6" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class MessageMetadata(obj: Any?) : AbstractWrapper(obj){
<a href="#h21-0-9" id="h21-0-9" class="d">-    val createdAt: Long get() = instanceNonNull().getObjectField(&quot;mCreatedAt&quot;) as Long
</a><a href="#h21-0-10" id="h21-0-10" class="d">-    val readAt: Long get() = instanceNonNull().getObjectField(&quot;mReadAt&quot;) as Long
</a><a href="#h21-0-11" id="h21-0-11" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-12" id="h21-0-12" class="i">+    var createdAt by field&lt;Long&gt;(&quot;mCreatedAt&quot;)
</a><a href="#h21-0-13" id="h21-0-13" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-14" id="h21-0-14" class="i">+    var readAt by field&lt;Long&gt;(&quot;mReadAt&quot;)
</a><a href="#h21-0-15" id="h21-0-15" class="i">+    @get:JSGetter @set:JSSetter
</a>     var playableSnapState by enum(&quot;mPlayableSnapState&quot;, PlayableSnapState.PLAYABLE)
 
<a href="#h21-0-18" id="h21-0-18" class="d">-    private fun getUUIDList(name: String): List&lt;SnapUUID&gt; {
</a><a href="#h21-0-19" id="h21-0-19" class="d">-        return (instanceNonNull().getObjectField(name) as List&lt;*&gt;).map { SnapUUID(it!!) }
</a><a href="#h21-0-20" id="h21-0-20" class="d">-    }
</a><a href="#h21-0-21" id="h21-0-21" class="d">-
</a><a href="#h21-0-22" id="h21-0-22" class="d">-    val savedBy: List&lt;SnapUUID&gt; by lazy {
</a><a href="#h21-0-23" id="h21-0-23" class="d">-        getUUIDList(&quot;mSavedBy&quot;)
</a><a href="#h21-0-24" id="h21-0-24" class="d">-    }
</a><a href="#h21-0-25" id="h21-0-25" class="d">-    val openedBy: List&lt;SnapUUID&gt; by lazy {
</a><a href="#h21-0-26" id="h21-0-26" class="d">-        getUUIDList(&quot;mOpenedBy&quot;)
</a><a href="#h21-0-27" id="h21-0-27" class="d">-    }
</a><a href="#h21-0-28" id="h21-0-28" class="d">-    val seenBy: List&lt;SnapUUID&gt; by lazy {
</a><a href="#h21-0-29" id="h21-0-29" class="d">-        getUUIDList(&quot;mSeenBy&quot;)
</a><a href="#h21-0-30" id="h21-0-30" class="d">-    }
</a><a href="#h21-0-31" id="h21-0-31" class="d">-    val reactions: List&lt;UserIdToReaction&gt; by lazy {
</a><a href="#h21-0-32" id="h21-0-32" class="d">-        (instanceNonNull().getObjectField(&quot;mReactions&quot;) as List&lt;*&gt;).map { UserIdToReaction(it!!) }
</a><a href="#h21-0-33" id="h21-0-33" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-34" id="h21-0-34" class="i">+    var savedBy by field(&quot;mSavedBy&quot;, uuidArrayListMapper)
</a><a href="#h21-0-35" id="h21-0-35" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-36" id="h21-0-36" class="i">+    var openedBy by field(&quot;mOpenedBy&quot;, uuidArrayListMapper)
</a><a href="#h21-0-37" id="h21-0-37" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-38" id="h21-0-38" class="i">+    var seenBy by field(&quot;mSeenBy&quot;, uuidArrayListMapper)
</a><a href="#h21-0-39" id="h21-0-39" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h21-0-40" id="h21-0-40" class="i">+    var reactions by field(&quot;mReactions&quot;) {
</a><a href="#h21-0-41" id="h21-0-41" class="i">+        (it as ArrayList&lt;*&gt;).map { i -&gt; UserIdToReaction(i) }.toMutableList()
</a>     }
 } 
\ No newline at end of file
<b>diff --git a/<a id="h22" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessage.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessage.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessage.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessage.kt</a></b>
<a href="#h22-0" id="h22-0" class="h">@@ -1,8 +1,10 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
<a href="#h22-0-2" id="h22-0-2" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h22-0-4" id="h22-0-4" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h22-0-5" id="h22-0-5" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class QuotedMessage(obj: Any?) : AbstractWrapper(obj) {
<a href="#h22-0-8" id="h22-0-8" class="d">-    val content get() = QuotedMessageContent(instanceNonNull().getObjectField(&quot;mContent&quot;))
</a><a href="#h22-0-9" id="h22-0-9" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h22-0-10" id="h22-0-10" class="i">+    var content by field(&quot;mContent&quot;) { QuotedMessageContent(it) }
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h23" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessageContent.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessageContent.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessageContent.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/QuotedMessageContent.kt</a></b>
<a href="#h23-0" id="h23-0" class="h">@@ -1,10 +1,10 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
<a href="#h23-0-2" id="h23-0-2" class="d">-import me.rhunk.snapenhance.core.util.ktx.getObjectField
</a><a href="#h23-0-3" id="h23-0-3" class="d">-import me.rhunk.snapenhance.core.util.ktx.setObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h23-0-5" id="h23-0-5" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h23-0-6" id="h23-0-6" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class QuotedMessageContent(obj: Any?) : AbstractWrapper(obj) {
<a href="#h23-0-9" id="h23-0-9" class="d">-    var messageId get() = instanceNonNull().getObjectField(&quot;mMessageId&quot;) as Long
</a><a href="#h23-0-10" id="h23-0-10" class="d">-        set(value) = instanceNonNull().setObjectField(&quot;mMessageId&quot;, value)
</a><a href="#h23-0-11" id="h23-0-11" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h23-0-12" id="h23-0-12" class="i">+    var messageId by field&lt;Long&gt;(&quot;mMessageId&quot;)
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h24" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/UserIdToReaction.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/UserIdToReaction.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/UserIdToReaction.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/wrapper/impl/UserIdToReaction.kt</a></b>
<a href="#h24-0" id="h24-0" class="h">@@ -1,11 +1,21 @@
</a> package me.rhunk.snapenhance.core.wrapper.impl
 
 import me.rhunk.snapenhance.core.util.ktx.getObjectField
<a href="#h24-0-3" id="h24-0-3" class="i">+import me.rhunk.snapenhance.core.util.ktx.setObjectField
</a> import me.rhunk.snapenhance.core.wrapper.AbstractWrapper
<a href="#h24-0-5" id="h24-0-5" class="i">+import org.mozilla.javascript.annotations.JSGetter
</a><a href="#h24-0-6" id="h24-0-6" class="i">+import org.mozilla.javascript.annotations.JSSetter
</a> 
 class UserIdToReaction(obj: Any?) : AbstractWrapper(obj) {
<a href="#h24-0-9" id="h24-0-9" class="d">-    val userId = SnapUUID(instanceNonNull().getObjectField(&quot;mUserId&quot;))
</a><a href="#h24-0-10" id="h24-0-10" class="d">-    val reactionId = (instanceNonNull().getObjectField(&quot;mReaction&quot;)
</a><a href="#h24-0-11" id="h24-0-11" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h24-0-12" id="h24-0-12" class="i">+    var userId by field(&quot;mUserId&quot;) { SnapUUID(it) }
</a><a href="#h24-0-13" id="h24-0-13" class="i">+    @get:JSGetter @set:JSSetter
</a><a href="#h24-0-14" id="h24-0-14" class="i">+    var reactionId get() = (instanceNonNull().getObjectField(&quot;mReaction&quot;)
</a>         ?.getObjectField(&quot;mReactionContent&quot;)
<a href="#h24-0-16" id="h24-0-16" class="d">-        ?.getObjectField(&quot;mIntentionType&quot;) as Long?) ?: 0
</a><a href="#h24-0-17" id="h24-0-17" class="i">+        ?.getObjectField(&quot;mIntentionType&quot;) as Long?) ?: -1
</a><a href="#h24-0-18" id="h24-0-18" class="i">+    set(value) {
</a><a href="#h24-0-19" id="h24-0-19" class="i">+        instanceNonNull().getObjectField(&quot;mReaction&quot;)
</a><a href="#h24-0-20" id="h24-0-20" class="i">+            ?.getObjectField(&quot;mReactionContent&quot;)
</a><a href="#h24-0-21" id="h24-0-21" class="i">+            ?.setObjectField(&quot;mIntentionType&quot;, value)
</a><a href="#h24-0-22" id="h24-0-22" class="i">+    }
</a> } 
\ No newline at end of file
</pre>
</div>
</body>
</html>
