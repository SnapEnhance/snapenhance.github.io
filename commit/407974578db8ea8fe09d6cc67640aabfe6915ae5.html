<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>feat: friend notes - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/407974578db8ea8fe09d6cc67640aabfe6915ae5.html">407974578db8ea8fe09d6cc67640aabfe6915ae5</a>
<b>parent</b> <a href="../commit/54171cf7720b5cf8cf89bf28d6aacf7be289c903.html">54171cf7720b5cf8cf89bf28d6aacf7be289c903</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Fri,  8 Nov 2024 18:28:28 +0100

feat: friend notes

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">app/src/main/kotlin/me/rhunk/snapenhance/StreaksReminder.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/storage/AppDatabase.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/storage/ScopeNotes.kt</a></td><td> | </td><td class="num">32</td><td><span class="i">++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/ManageScope.kt</a></td><td> | </td><td class="num">219</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">--------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/SocialRootSection.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">common/src/main/aidl/me/rhunk/snapenhance/bridge/BridgeInterface.aidl</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">common/src/main/assets/lang/en_US.json</a></td><td> | </td><td class="num">7</td><td><span class="i">++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">common/src/main/kotlin/me/rhunk/snapenhance/common/config/impl/Experimental.kt</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h9">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Components.kt</a></td><td> | </td><td class="num">48</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/ComposeViewFactory.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++</span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Keyboard.kt</a></td><td> | </td><td class="num">47</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">core/src/main/kotlin/me/rhunk/snapenhance/core/bridge/BridgeClient.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h13">core/src/main/kotlin/me/rhunk/snapenhance/core/features/FeatureManager.kt</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h14">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/MediaDownloader.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="A">A</td><td><a href="#h15">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ui/FriendNotes.kt</a></td><td> | </td><td class="num">84</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">core/src/main/kotlin/me/rhunk/snapenhance/core/ui/menu/impl/FriendFeedInfoMenu.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
</table></pre><pre>17 files changed, 379 insertions(+), 96 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/StreaksReminder.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/StreaksReminder.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/StreaksReminder.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/StreaksReminder.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -74,7 +74,7 @@ class StreaksReminder(
</a> 
         notifyFriendList.forEach { (streaks, friend) -&gt;
             remoteSideContext.coroutineScope.launch {
<a href="#h0-0-3" id="h0-0-3" class="d">-                val bitmojiUrl = BitmojiSelfie.getBitmojiSelfie(friend.selfieId, friend.bitmojiId, BitmojiSelfie.BitmojiSelfieType.THREE_D)
</a><a href="#h0-0-4" id="h0-0-4" class="i">+                val bitmojiUrl = BitmojiSelfie.getBitmojiSelfie(friend.selfieId, friend.bitmojiId, BitmojiSelfie.BitmojiSelfieType.NEW_THREE_D)
</a>                 val bitmojiImage = remoteSideContext.imageLoader.execute(
                     ImageRequestHelper.newBitmojiImageRequest(ctx, bitmojiUrl)
                 )
<b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -195,6 +195,14 @@ class BridgeService : Service() {
</a>             )
         }
 
<a href="#h1-0-3" id="h1-0-3" class="i">+        override fun getScopeNotes(id: String): String? {
</a><a href="#h1-0-4" id="h1-0-4" class="i">+            return remoteSideContext.database.getScopeNotes(id)
</a><a href="#h1-0-5" id="h1-0-5" class="i">+        }
</a><a href="#h1-0-6" id="h1-0-6" class="i">+
</a><a href="#h1-0-7" id="h1-0-7" class="i">+        override fun setScopeNotes(id: String, content: String?) {
</a><a href="#h1-0-8" id="h1-0-8" class="i">+            remoteSideContext.database.setScopeNotes(id, content)
</a><a href="#h1-0-9" id="h1-0-9" class="i">+        }
</a><a href="#h1-0-10" id="h1-0-10" class="i">+
</a>         override fun getScriptingInterface() = remoteSideContext.scriptManager
 
         override fun getE2eeInterface() = remoteSideContext.e2eeImplementation
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/storage/AppDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/storage/AppDatabase.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/storage/AppDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/storage/AppDatabase.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -102,6 +102,10 @@ class AppDatabase(
</a>             &quot;repositories&quot; to listOf(
                 &quot;url VARCHAR PRIMARY KEY&quot;,
             ),
<a href="#h2-0-3" id="h2-0-3" class="i">+            &quot;notes&quot; to listOf(
</a><a href="#h2-0-4" id="h2-0-4" class="i">+                &quot;id CHAR(36) PRIMARY KEY&quot;,
</a><a href="#h2-0-5" id="h2-0-5" class="i">+                &quot;content TEXT&quot;,
</a><a href="#h2-0-6" id="h2-0-6" class="i">+            ),
</a>         ))
     }
 } 
\ No newline at end of file
<b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/storage/ScopeNotes.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/storage/ScopeNotes.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/storage/ScopeNotes.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/storage/ScopeNotes.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -0,0 +1,32 @@
</a><a href="#h3-0-0" id="h3-0-0" class="i">+package me.rhunk.snapenhance.storage
</a><a href="#h3-0-1" id="h3-0-1" class="i">+
</a><a href="#h3-0-2" id="h3-0-2" class="i">+import androidx.core.database.getStringOrNull
</a><a href="#h3-0-3" id="h3-0-3" class="i">+
</a><a href="#h3-0-4" id="h3-0-4" class="i">+fun AppDatabase.getScopeNotes(id: String): String? {
</a><a href="#h3-0-5" id="h3-0-5" class="i">+    return database.rawQuery(&quot;SELECT content FROM notes WHERE id = ?&quot;, arrayOf(id)).use {
</a><a href="#h3-0-6" id="h3-0-6" class="i">+        if (it.moveToNext()) {
</a><a href="#h3-0-7" id="h3-0-7" class="i">+            it.getStringOrNull(0)
</a><a href="#h3-0-8" id="h3-0-8" class="i">+        } else {
</a><a href="#h3-0-9" id="h3-0-9" class="i">+            null
</a><a href="#h3-0-10" id="h3-0-10" class="i">+        }
</a><a href="#h3-0-11" id="h3-0-11" class="i">+    }
</a><a href="#h3-0-12" id="h3-0-12" class="i">+}
</a><a href="#h3-0-13" id="h3-0-13" class="i">+
</a><a href="#h3-0-14" id="h3-0-14" class="i">+fun AppDatabase.setScopeNotes(id: String, content: String?) {
</a><a href="#h3-0-15" id="h3-0-15" class="i">+    if (content == null || content.isEmpty() == true) {
</a><a href="#h3-0-16" id="h3-0-16" class="i">+        executeAsync {
</a><a href="#h3-0-17" id="h3-0-17" class="i">+            database.execSQL(&quot;DELETE FROM notes WHERE id = ?&quot;, arrayOf(id))
</a><a href="#h3-0-18" id="h3-0-18" class="i">+        }
</a><a href="#h3-0-19" id="h3-0-19" class="i">+        return
</a><a href="#h3-0-20" id="h3-0-20" class="i">+    }
</a><a href="#h3-0-21" id="h3-0-21" class="i">+
</a><a href="#h3-0-22" id="h3-0-22" class="i">+    executeAsync {
</a><a href="#h3-0-23" id="h3-0-23" class="i">+        database.execSQL(&quot;INSERT OR REPLACE INTO notes (id, content) VALUES (?, ?)&quot;, arrayOf(id, content))
</a><a href="#h3-0-24" id="h3-0-24" class="i">+    }
</a><a href="#h3-0-25" id="h3-0-25" class="i">+}
</a><a href="#h3-0-26" id="h3-0-26" class="i">+
</a><a href="#h3-0-27" id="h3-0-27" class="i">+fun AppDatabase.deleteScopeNotes(id: String) {
</a><a href="#h3-0-28" id="h3-0-28" class="i">+    executeAsync {
</a><a href="#h3-0-29" id="h3-0-29" class="i">+        database.execSQL(&quot;DELETE FROM notes WHERE id = ?&quot;, arrayOf(id))
</a><a href="#h3-0-30" id="h3-0-30" class="i">+    }
</a><a href="#h3-0-31" id="h3-0-31" class="i">+}
</a><b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/ManageScope.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/ManageScope.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/ManageScope.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/ManageScope.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -10,18 +10,22 @@ import androidx.compose.material3.*
</a> import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
<a href="#h4-0-3" id="h4-0-3" class="i">+import androidx.compose.ui.graphics.Color
</a> import androidx.compose.ui.text.font.FontWeight
 import androidx.compose.ui.unit.dp
 import androidx.compose.ui.unit.sp
 import androidx.navigation.NavBackStackEntry
 import androidx.navigation.compose.currentBackStackEntryAsState
 import kotlinx.coroutines.CoroutineScope
<a href="#h4-0-10" id="h4-0-10" class="i">+import kotlinx.coroutines.Dispatchers
</a> import kotlinx.coroutines.launch
 import me.rhunk.snapenhance.common.data.FriendStreaks
 import me.rhunk.snapenhance.common.data.MessagingFriendInfo
 import me.rhunk.snapenhance.common.data.MessagingGroupInfo
 import me.rhunk.snapenhance.common.data.MessagingRuleType
 import me.rhunk.snapenhance.common.data.SocialScope
<a href="#h4-0-17" id="h4-0-17" class="i">+import me.rhunk.snapenhance.common.ui.AutoClearKeyboardFocus
</a><a href="#h4-0-18" id="h4-0-18" class="i">+import me.rhunk.snapenhance.common.ui.EditNoteTextField
</a> import me.rhunk.snapenhance.common.ui.rememberAsyncMutableState
 import me.rhunk.snapenhance.common.ui.rememberAsyncMutableStateList
 import me.rhunk.snapenhance.common.util.snap.BitmojiSelfie
<a href="#h4-1" id="h4-1" class="h">@@ -89,6 +93,9 @@ class ManageScope: Routes.Route() {
</a>                 .verticalScroll(rememberScrollState())
                 .fillMaxSize()
         ) {
<a href="#h4-1-3" id="h4-1-3" class="i">+            var bottomComposable by remember {
</a><a href="#h4-1-4" id="h4-1-4" class="i">+                mutableStateOf(null as (@Composable () -&gt; Unit)?)
</a><a href="#h4-1-5" id="h4-1-5" class="i">+            }
</a>             var hasScope by remember {
                 mutableStateOf(null as Boolean?)
             }
<a href="#h4-2" id="h4-2" class="h">@@ -103,7 +110,7 @@ class ManageScope: Routes.Route() {
</a>                         }
                     }
                     friend?.let {
<a href="#h4-2-3" id="h4-2-3" class="d">-                        Friend(id, it, streaks)
</a><a href="#h4-2-4" id="h4-2-4" class="i">+                        Friend(id, it, streaks) { bottomComposable = it }
</a>                     }
                 }
                 SocialScope.GROUP -&gt; {
<a href="#h4-3" id="h4-3" class="h">@@ -113,13 +120,17 @@ class ManageScope: Routes.Route() {
</a>                         }
                     }
                     group?.let {
<a href="#h4-3-3" id="h4-3-3" class="d">-                        Group(it)
</a><a href="#h4-3-4" id="h4-3-4" class="i">+                        Group(it) { bottomComposable = it }
</a>                     }
                 }
             }
             if (hasScope == true) {
<a href="#h4-3-9" id="h4-3-9" class="i">+                if (context.config.root.experimental.friendNotes.get()) {
</a><a href="#h4-3-10" id="h4-3-10" class="i">+                    NotesCard(id)
</a><a href="#h4-3-11" id="h4-3-11" class="i">+                }
</a>                 RulesCard(id)
             }
<a href="#h4-3-14" id="h4-3-14" class="i">+            bottomComposable?.invoke()
</a>             if (hasScope == false) {
                 Column(
                     modifier = Modifier.fillMaxSize(),
<a href="#h4-4" id="h4-4" class="h">@@ -136,6 +147,33 @@ class ManageScope: Routes.Route() {
</a>         }
     }
 
<a href="#h4-4-3" id="h4-4-3" class="i">+    @Composable
</a><a href="#h4-4-4" id="h4-4-4" class="i">+    private fun NotesCard(
</a><a href="#h4-4-5" id="h4-4-5" class="i">+        id: String
</a><a href="#h4-4-6" id="h4-4-6" class="i">+    ) {
</a><a href="#h4-4-7" id="h4-4-7" class="i">+        val coroutineScope = rememberCoroutineScope { Dispatchers.IO }
</a><a href="#h4-4-8" id="h4-4-8" class="i">+        var scopeNotes by rememberAsyncMutableState(null) {
</a><a href="#h4-4-9" id="h4-4-9" class="i">+            context.database.getScopeNotes(id)
</a><a href="#h4-4-10" id="h4-4-10" class="i">+        }
</a><a href="#h4-4-11" id="h4-4-11" class="i">+
</a><a href="#h4-4-12" id="h4-4-12" class="i">+        AutoClearKeyboardFocus()
</a><a href="#h4-4-13" id="h4-4-13" class="i">+
</a><a href="#h4-4-14" id="h4-4-14" class="i">+        EditNoteTextField(
</a><a href="#h4-4-15" id="h4-4-15" class="i">+            modifier = Modifier.padding(8.dp),
</a><a href="#h4-4-16" id="h4-4-16" class="i">+            primaryColor = Color.White,
</a><a href="#h4-4-17" id="h4-4-17" class="i">+            translation = context.translation,
</a><a href="#h4-4-18" id="h4-4-18" class="i">+            content = scopeNotes,
</a><a href="#h4-4-19" id="h4-4-19" class="i">+            setContent = { scopeNotes = it }
</a><a href="#h4-4-20" id="h4-4-20" class="i">+        )
</a><a href="#h4-4-21" id="h4-4-21" class="i">+
</a><a href="#h4-4-22" id="h4-4-22" class="i">+        DisposableEffect(Unit) {
</a><a href="#h4-4-23" id="h4-4-23" class="i">+            onDispose {
</a><a href="#h4-4-24" id="h4-4-24" class="i">+                coroutineScope.launch {
</a><a href="#h4-4-25" id="h4-4-25" class="i">+                    context.database.setScopeNotes(id, scopeNotes)
</a><a href="#h4-4-26" id="h4-4-26" class="i">+                }
</a><a href="#h4-4-27" id="h4-4-27" class="i">+            }
</a><a href="#h4-4-28" id="h4-4-28" class="i">+        }
</a><a href="#h4-4-29" id="h4-4-29" class="i">+    }
</a> 
     @Composable
     private fun RulesCard(
<a href="#h4-5" id="h4-5" class="h">@@ -183,7 +221,7 @@ class ManageScope: Routes.Route() {
</a> 
     @Composable
     private fun ContentCard(modifier: Modifier = Modifier, content: @Composable () -&gt; Unit) {
<a href="#h4-5-3" id="h4-5-3" class="d">-        Card(
</a><a href="#h4-5-4" id="h4-5-4" class="i">+        ElevatedCard(
</a>             modifier = Modifier
                 .padding(10.dp)
                 .fillMaxWidth()
<a href="#h4-6" id="h4-6" class="h">@@ -244,26 +282,105 @@ class ManageScope: Routes.Route() {
</a>     private fun Friend(
         id: String,
         friend: MessagingFriendInfo,
<a href="#h4-6-3" id="h4-6-3" class="d">-        streaks: FriendStreaks?
</a><a href="#h4-6-4" id="h4-6-4" class="i">+        streaks: FriendStreaks?,
</a><a href="#h4-6-5" id="h4-6-5" class="i">+        setBottomComposable: ((@Composable () -&gt; Unit)?) -&gt; Unit = {}
</a>     ) {
<a href="#h4-6-7" id="h4-6-7" class="i">+        LaunchedEffect(Unit) {
</a><a href="#h4-6-8" id="h4-6-8" class="i">+            setBottomComposable {
</a><a href="#h4-6-9" id="h4-6-9" class="i">+                Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-6-10" id="h4-6-10" class="i">+
</a><a href="#h4-6-11" id="h4-6-11" class="i">+                if (context.config.root.experimental.e2eEncryption.globalState == true) {
</a><a href="#h4-6-12" id="h4-6-12" class="i">+                    SectionTitle(translation[&quot;e2ee_title&quot;])
</a><a href="#h4-6-13" id="h4-6-13" class="i">+                    var hasSecretKey by rememberAsyncMutableState(defaultValue = false) {
</a><a href="#h4-6-14" id="h4-6-14" class="i">+                        context.e2eeImplementation.friendKeyExists(friend.userId)
</a><a href="#h4-6-15" id="h4-6-15" class="i">+                    }
</a><a href="#h4-6-16" id="h4-6-16" class="i">+                    var importDialog by remember { mutableStateOf(false) }
</a><a href="#h4-6-17" id="h4-6-17" class="i">+
</a><a href="#h4-6-18" id="h4-6-18" class="i">+                    if (importDialog) {
</a><a href="#h4-6-19" id="h4-6-19" class="i">+                        Dialog(
</a><a href="#h4-6-20" id="h4-6-20" class="i">+                            onDismissRequest = { importDialog = false }
</a><a href="#h4-6-21" id="h4-6-21" class="i">+                        ) {
</a><a href="#h4-6-22" id="h4-6-22" class="i">+                            dialogs.RawInputDialog(onDismiss = { importDialog = false  }, onConfirm = { newKey -&gt;
</a><a href="#h4-6-23" id="h4-6-23" class="i">+                                importDialog = false
</a><a href="#h4-6-24" id="h4-6-24" class="i">+                                runCatching {
</a><a href="#h4-6-25" id="h4-6-25" class="i">+                                    val key = Base64.decode(newKey)
</a><a href="#h4-6-26" id="h4-6-26" class="i">+                                    if (key.size != 32) {
</a><a href="#h4-6-27" id="h4-6-27" class="i">+                                        context.longToast(&quot;Invalid key size (must be 32 bytes)&quot;)
</a><a href="#h4-6-28" id="h4-6-28" class="i">+                                        return@runCatching
</a><a href="#h4-6-29" id="h4-6-29" class="i">+                                    }
</a><a href="#h4-6-30" id="h4-6-30" class="i">+
</a><a href="#h4-6-31" id="h4-6-31" class="i">+                                    context.coroutineScope.launch {
</a><a href="#h4-6-32" id="h4-6-32" class="i">+                                        context.e2eeImplementation.storeSharedSecretKey(friend.userId, key)
</a><a href="#h4-6-33" id="h4-6-33" class="i">+                                        context.longToast(&quot;Successfully imported key&quot;)
</a><a href="#h4-6-34" id="h4-6-34" class="i">+                                    }
</a><a href="#h4-6-35" id="h4-6-35" class="i">+
</a><a href="#h4-6-36" id="h4-6-36" class="i">+                                    hasSecretKey = true
</a><a href="#h4-6-37" id="h4-6-37" class="i">+                                }.onFailure {
</a><a href="#h4-6-38" id="h4-6-38" class="i">+                                    context.longToast(&quot;Failed to import key: ${it.message}&quot;)
</a><a href="#h4-6-39" id="h4-6-39" class="i">+                                    context.log.error(&quot;Failed to import key&quot;, it)
</a><a href="#h4-6-40" id="h4-6-40" class="i">+                                }
</a><a href="#h4-6-41" id="h4-6-41" class="i">+                            })
</a><a href="#h4-6-42" id="h4-6-42" class="i">+                        }
</a><a href="#h4-6-43" id="h4-6-43" class="i">+                    }
</a><a href="#h4-6-44" id="h4-6-44" class="i">+
</a><a href="#h4-6-45" id="h4-6-45" class="i">+                    ContentCard {
</a><a href="#h4-6-46" id="h4-6-46" class="i">+                        Row(
</a><a href="#h4-6-47" id="h4-6-47" class="i">+                            verticalAlignment = Alignment.CenterVertically,
</a><a href="#h4-6-48" id="h4-6-48" class="i">+                            horizontalArrangement = Arrangement.spacedBy(10.dp)
</a><a href="#h4-6-49" id="h4-6-49" class="i">+                        ) {
</a><a href="#h4-6-50" id="h4-6-50" class="i">+                            if (hasSecretKey) {
</a><a href="#h4-6-51" id="h4-6-51" class="i">+                                OutlinedButton(onClick = {
</a><a href="#h4-6-52" id="h4-6-52" class="i">+                                    context.coroutineScope.launch {
</a><a href="#h4-6-53" id="h4-6-53" class="i">+                                        val secretKey = Base64.encode(context.e2eeImplementation.getSharedSecretKey(friend.userId) ?: return@launch)
</a><a href="#h4-6-54" id="h4-6-54" class="i">+                                        //TODO: fingerprint auth
</a><a href="#h4-6-55" id="h4-6-55" class="i">+                                        context.activity!!.startActivity(Intent.createChooser(Intent().apply {
</a><a href="#h4-6-56" id="h4-6-56" class="i">+                                            action = Intent.ACTION_SEND
</a><a href="#h4-6-57" id="h4-6-57" class="i">+                                            putExtra(Intent.EXTRA_TEXT, secretKey)
</a><a href="#h4-6-58" id="h4-6-58" class="i">+                                            type = &quot;text/plain&quot;
</a><a href="#h4-6-59" id="h4-6-59" class="i">+                                        }, &quot;&quot;).apply {
</a><a href="#h4-6-60" id="h4-6-60" class="i">+                                            putExtra(Intent.EXTRA_INITIAL_INTENTS, arrayOf(
</a><a href="#h4-6-61" id="h4-6-61" class="i">+                                                Intent().apply {
</a><a href="#h4-6-62" id="h4-6-62" class="i">+                                                    putExtra(Intent.EXTRA_TEXT, secretKey)
</a><a href="#h4-6-63" id="h4-6-63" class="i">+                                                    putExtra(Intent.EXTRA_SUBJECT, secretKey)
</a><a href="#h4-6-64" id="h4-6-64" class="i">+                                                })
</a><a href="#h4-6-65" id="h4-6-65" class="i">+                                            )
</a><a href="#h4-6-66" id="h4-6-66" class="i">+                                        })
</a><a href="#h4-6-67" id="h4-6-67" class="i">+                                    }
</a><a href="#h4-6-68" id="h4-6-68" class="i">+                                }) {
</a><a href="#h4-6-69" id="h4-6-69" class="i">+                                    Text(
</a><a href="#h4-6-70" id="h4-6-70" class="i">+                                        text = &quot;Export Base64&quot;,
</a><a href="#h4-6-71" id="h4-6-71" class="i">+                                        maxLines = 1
</a><a href="#h4-6-72" id="h4-6-72" class="i">+                                    )
</a><a href="#h4-6-73" id="h4-6-73" class="i">+                                }
</a><a href="#h4-6-74" id="h4-6-74" class="i">+                            }
</a><a href="#h4-6-75" id="h4-6-75" class="i">+
</a><a href="#h4-6-76" id="h4-6-76" class="i">+                            OutlinedButton(onClick = { importDialog = true }) {
</a><a href="#h4-6-77" id="h4-6-77" class="i">+                                Text(
</a><a href="#h4-6-78" id="h4-6-78" class="i">+                                    text = &quot;Import Base64&quot;,
</a><a href="#h4-6-79" id="h4-6-79" class="i">+                                    maxLines = 1
</a><a href="#h4-6-80" id="h4-6-80" class="i">+                                )
</a><a href="#h4-6-81" id="h4-6-81" class="i">+                            }
</a><a href="#h4-6-82" id="h4-6-82" class="i">+                        }
</a><a href="#h4-6-83" id="h4-6-83" class="i">+                    }
</a><a href="#h4-6-84" id="h4-6-84" class="i">+                }
</a><a href="#h4-6-85" id="h4-6-85" class="i">+            }
</a><a href="#h4-6-86" id="h4-6-86" class="i">+        }
</a>         Column(
             modifier = Modifier
<a href="#h4-6-89" id="h4-6-89" class="d">-                .padding(10.dp)
</a><a href="#h4-6-90" id="h4-6-90" class="i">+                .padding(5.dp)
</a>                 .fillMaxWidth(),
             horizontalAlignment = Alignment.CenterHorizontally
         ) {
             val bitmojiUrl = BitmojiSelfie.getBitmojiSelfie(
<a href="#h4-6-95" id="h4-6-95" class="d">-                friend.selfieId, friend.bitmojiId, BitmojiSelfie.BitmojiSelfieType.THREE_D
</a><a href="#h4-6-96" id="h4-6-96" class="i">+                friend.selfieId, friend.bitmojiId, BitmojiSelfie.BitmojiSelfieType.NEW_THREE_D
</a>             )
<a href="#h4-6-98" id="h4-6-98" class="d">-            BitmojiImage(context = context, url = bitmojiUrl, size = 100)
</a><a href="#h4-6-99" id="h4-6-99" class="d">-            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-6-100" id="h4-6-100" class="i">+            BitmojiImage(context = context, url = bitmojiUrl, size = 120)
</a>             Text(
                 text = friend.displayName ?: friend.mutableUsername,
                 maxLines = 1,
                 fontSize = 20.sp,
                 fontWeight = FontWeight.Bold
             )
<a href="#h4-6-107" id="h4-6-107" class="d">-            Spacer(modifier = Modifier.height(5.dp))
</a>             Text(
                 text = friend.mutableUsername,
                 maxLines = 1,
<a href="#h4-7" id="h4-7" class="h">@@ -272,8 +389,6 @@ class ManageScope: Routes.Route() {
</a>             )
         }
 
<a href="#h4-7-3" id="h4-7-3" class="d">-        Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-7-4" id="h4-7-4" class="d">-
</a>         if (context.config.root.experimental.storyLogger.get()) {
             Row(
                 modifier = Modifier.fillMaxWidth(),
<a href="#h4-8" id="h4-8" class="h">@@ -332,87 +447,14 @@ class ManageScope: Routes.Route() {
</a>                     }
                 }
             }
<a href="#h4-8-3" id="h4-8-3" class="d">-            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-8-4" id="h4-8-4" class="d">-
</a><a href="#h4-8-5" id="h4-8-5" class="d">-            if (context.config.root.experimental.e2eEncryption.globalState == true) {
</a><a href="#h4-8-6" id="h4-8-6" class="d">-                SectionTitle(translation[&quot;e2ee_title&quot;])
</a><a href="#h4-8-7" id="h4-8-7" class="d">-                var hasSecretKey by rememberAsyncMutableState(defaultValue = false) {
</a><a href="#h4-8-8" id="h4-8-8" class="d">-                    context.e2eeImplementation.friendKeyExists(friend.userId)
</a><a href="#h4-8-9" id="h4-8-9" class="d">-                }
</a><a href="#h4-8-10" id="h4-8-10" class="d">-                var importDialog by remember { mutableStateOf(false) }
</a><a href="#h4-8-11" id="h4-8-11" class="d">-
</a><a href="#h4-8-12" id="h4-8-12" class="d">-                if (importDialog) {
</a><a href="#h4-8-13" id="h4-8-13" class="d">-                    Dialog(
</a><a href="#h4-8-14" id="h4-8-14" class="d">-                        onDismissRequest = { importDialog = false }
</a><a href="#h4-8-15" id="h4-8-15" class="d">-                    ) {
</a><a href="#h4-8-16" id="h4-8-16" class="d">-                        dialogs.RawInputDialog(onDismiss = { importDialog = false  }, onConfirm = { newKey -&gt;
</a><a href="#h4-8-17" id="h4-8-17" class="d">-                            importDialog = false
</a><a href="#h4-8-18" id="h4-8-18" class="d">-                            runCatching {
</a><a href="#h4-8-19" id="h4-8-19" class="d">-                                val key = Base64.decode(newKey)
</a><a href="#h4-8-20" id="h4-8-20" class="d">-                                if (key.size != 32) {
</a><a href="#h4-8-21" id="h4-8-21" class="d">-                                    context.longToast(&quot;Invalid key size (must be 32 bytes)&quot;)
</a><a href="#h4-8-22" id="h4-8-22" class="d">-                                    return@runCatching
</a><a href="#h4-8-23" id="h4-8-23" class="d">-                                }
</a><a href="#h4-8-24" id="h4-8-24" class="d">-
</a><a href="#h4-8-25" id="h4-8-25" class="d">-                                context.coroutineScope.launch {
</a><a href="#h4-8-26" id="h4-8-26" class="d">-                                    context.e2eeImplementation.storeSharedSecretKey(friend.userId, key)
</a><a href="#h4-8-27" id="h4-8-27" class="d">-                                    context.longToast(&quot;Successfully imported key&quot;)
</a><a href="#h4-8-28" id="h4-8-28" class="d">-                                }
</a><a href="#h4-8-29" id="h4-8-29" class="d">-
</a><a href="#h4-8-30" id="h4-8-30" class="d">-                                hasSecretKey = true
</a><a href="#h4-8-31" id="h4-8-31" class="d">-                            }.onFailure {
</a><a href="#h4-8-32" id="h4-8-32" class="d">-                                context.longToast(&quot;Failed to import key: ${it.message}&quot;)
</a><a href="#h4-8-33" id="h4-8-33" class="d">-                                context.log.error(&quot;Failed to import key&quot;, it)
</a><a href="#h4-8-34" id="h4-8-34" class="d">-                            }
</a><a href="#h4-8-35" id="h4-8-35" class="d">-                        })
</a><a href="#h4-8-36" id="h4-8-36" class="d">-                    }
</a><a href="#h4-8-37" id="h4-8-37" class="d">-                }
</a><a href="#h4-8-38" id="h4-8-38" class="d">-
</a><a href="#h4-8-39" id="h4-8-39" class="d">-                ContentCard {
</a><a href="#h4-8-40" id="h4-8-40" class="d">-                    Row(
</a><a href="#h4-8-41" id="h4-8-41" class="d">-                        verticalAlignment = Alignment.CenterVertically,
</a><a href="#h4-8-42" id="h4-8-42" class="d">-                        horizontalArrangement = Arrangement.spacedBy(10.dp)
</a><a href="#h4-8-43" id="h4-8-43" class="d">-                    ) {
</a><a href="#h4-8-44" id="h4-8-44" class="d">-                        if (hasSecretKey) {
</a><a href="#h4-8-45" id="h4-8-45" class="d">-                            OutlinedButton(onClick = {
</a><a href="#h4-8-46" id="h4-8-46" class="d">-                                context.coroutineScope.launch {
</a><a href="#h4-8-47" id="h4-8-47" class="d">-                                    val secretKey = Base64.encode(context.e2eeImplementation.getSharedSecretKey(friend.userId) ?: return@launch)
</a><a href="#h4-8-48" id="h4-8-48" class="d">-                                    //TODO: fingerprint auth
</a><a href="#h4-8-49" id="h4-8-49" class="d">-                                    context.activity!!.startActivity(Intent.createChooser(Intent().apply {
</a><a href="#h4-8-50" id="h4-8-50" class="d">-                                        action = Intent.ACTION_SEND
</a><a href="#h4-8-51" id="h4-8-51" class="d">-                                        putExtra(Intent.EXTRA_TEXT, secretKey)
</a><a href="#h4-8-52" id="h4-8-52" class="d">-                                        type = &quot;text/plain&quot;
</a><a href="#h4-8-53" id="h4-8-53" class="d">-                                    }, &quot;&quot;).apply {
</a><a href="#h4-8-54" id="h4-8-54" class="d">-                                        putExtra(Intent.EXTRA_INITIAL_INTENTS, arrayOf(
</a><a href="#h4-8-55" id="h4-8-55" class="d">-                                            Intent().apply {
</a><a href="#h4-8-56" id="h4-8-56" class="d">-                                                putExtra(Intent.EXTRA_TEXT, secretKey)
</a><a href="#h4-8-57" id="h4-8-57" class="d">-                                                putExtra(Intent.EXTRA_SUBJECT, secretKey)
</a><a href="#h4-8-58" id="h4-8-58" class="d">-                                            })
</a><a href="#h4-8-59" id="h4-8-59" class="d">-                                        )
</a><a href="#h4-8-60" id="h4-8-60" class="d">-                                    })
</a><a href="#h4-8-61" id="h4-8-61" class="d">-                                }
</a><a href="#h4-8-62" id="h4-8-62" class="d">-                            }) {
</a><a href="#h4-8-63" id="h4-8-63" class="d">-                                Text(
</a><a href="#h4-8-64" id="h4-8-64" class="d">-                                    text = &quot;Export Base64&quot;,
</a><a href="#h4-8-65" id="h4-8-65" class="d">-                                    maxLines = 1
</a><a href="#h4-8-66" id="h4-8-66" class="d">-                                )
</a><a href="#h4-8-67" id="h4-8-67" class="d">-                            }
</a><a href="#h4-8-68" id="h4-8-68" class="d">-                        }
</a><a href="#h4-8-69" id="h4-8-69" class="d">-
</a><a href="#h4-8-70" id="h4-8-70" class="d">-                        OutlinedButton(onClick = { importDialog = true }) {
</a><a href="#h4-8-71" id="h4-8-71" class="d">-                            Text(
</a><a href="#h4-8-72" id="h4-8-72" class="d">-                                text = &quot;Import Base64&quot;,
</a><a href="#h4-8-73" id="h4-8-73" class="d">-                                maxLines = 1
</a><a href="#h4-8-74" id="h4-8-74" class="d">-                            )
</a><a href="#h4-8-75" id="h4-8-75" class="d">-                        }
</a><a href="#h4-8-76" id="h4-8-76" class="d">-                    }
</a><a href="#h4-8-77" id="h4-8-77" class="d">-                }
</a><a href="#h4-8-78" id="h4-8-78" class="d">-            }
</a>         }
     }
 
     @Composable
<a href="#h4-8-83" id="h4-8-83" class="d">-    private fun Group(group: MessagingGroupInfo) {
</a><a href="#h4-8-84" id="h4-8-84" class="i">+    private fun Group(
</a><a href="#h4-8-85" id="h4-8-85" class="i">+        group: MessagingGroupInfo,
</a><a href="#h4-8-86" id="h4-8-86" class="i">+        setBottomComposable: ((@Composable () -&gt; Unit)?) -&gt; Unit = {}
</a><a href="#h4-8-87" id="h4-8-87" class="i">+    ) {
</a>         Column(
             modifier = Modifier
                 .padding(10.dp)
<a href="#h4-9" id="h4-9" class="h">@@ -422,7 +464,6 @@ class ManageScope: Routes.Route() {
</a>             Text(
                 text = group.name, maxLines = 1, fontSize = 20.sp, fontWeight = FontWeight.Bold
             )
<a href="#h4-9-3" id="h4-9-3" class="d">-            Spacer(modifier = Modifier.height(5.dp))
</a>             Text(
                 text = translation.format(
                     &quot;participants_text&quot;, &quot;count&quot; to group.participantsCount.toString()
<b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/SocialRootSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/SocialRootSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/SocialRootSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/pages/social/SocialRootSection.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -122,7 +122,7 @@ class SocialRootSection : Routes.Route() {
</a>                                     url = BitmojiSelfie.getBitmojiSelfie(
                                         friend.selfieId,
                                         friend.bitmojiId,
<a href="#h5-0-3" id="h5-0-3" class="d">-                                        BitmojiSelfie.BitmojiSelfieType.THREE_D
</a><a href="#h5-0-4" id="h5-0-4" class="i">+                                        BitmojiSelfie.BitmojiSelfieType.NEW_THREE_D
</a>                                     )
                                 )
 
<b>diff --git a/<a id="h6" href="../file/common/src/main/aidl/me/rhunk/snapenhance/bridge/BridgeInterface.aidl.html">common/src/main/aidl/me/rhunk/snapenhance/bridge/BridgeInterface.aidl</a> b/<a href="../file/common/src/main/aidl/me/rhunk/snapenhance/bridge/BridgeInterface.aidl.html">common/src/main/aidl/me/rhunk/snapenhance/bridge/BridgeInterface.aidl</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -71,6 +71,10 @@ interface BridgeInterface {
</a>     */
     oneway void passGroupsAndFriends(in List&lt;String&gt; groups, in List&lt;String&gt; friends);
 
<a href="#h6-0-3" id="h6-0-3" class="i">+    @nullable String getScopeNotes(String id);
</a><a href="#h6-0-4" id="h6-0-4" class="i">+
</a><a href="#h6-0-5" id="h6-0-5" class="i">+    oneway void setScopeNotes(String id, String content);
</a><a href="#h6-0-6" id="h6-0-6" class="i">+
</a>     IScripting getScriptingInterface();
 
     E2eeInterface getE2eeInterface();
<b>diff --git a/<a id="h7" href="../file/common/src/main/assets/lang/en_US.json.html">common/src/main/assets/lang/en_US.json</a> b/<a href="../file/common/src/main/assets/lang/en_US.json.html">common/src/main/assets/lang/en_US.json</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -127,7 +127,8 @@
</a>                 &quot;streaks_expiration_text&quot;: &quot;Expires in {eta}&quot;,
                 &quot;streaks_expiration_text_expired&quot;: &quot;Expired&quot;,
                 &quot;reminder_button&quot;: &quot;Set Reminder&quot;,
<a href="#h7-0-3" id="h7-0-3" class="d">-                &quot;delete_scope_confirm_dialog_title&quot;: &quot;Are you sure you want to delete a {scope}?&quot;
</a><a href="#h7-0-4" id="h7-0-4" class="i">+                &quot;delete_scope_confirm_dialog_title&quot;: &quot;Are you sure you want to delete a {scope}?&quot;,
</a><a href="#h7-0-5" id="h7-0-5" class="i">+                &quot;notes_placeholder&quot;: &quot;Click to add a note&quot;
</a>             },
             &quot;logged_stories&quot;: {
                 &quot;story_failed_to_load&quot;: &quot;Failed to load&quot;,
<a href="#h7-1" id="h7-1" class="h">@@ -1062,6 +1063,10 @@
</a>                         &quot;name&quot;: &quot;Voice Note Auto Play&quot;,
                         &quot;description&quot;: &quot;Automatically plays the next voice note after the current one finishes&quot;
                     },
<a href="#h7-1-3" id="h7-1-3" class="i">+                    &quot;friend_notes&quot;: {
</a><a href="#h7-1-4" id="h7-1-4" class="i">+                        &quot;name&quot;: &quot;Friend Notes&quot;,
</a><a href="#h7-1-5" id="h7-1-5" class="i">+                        &quot;description&quot;: &quot;Allows you to add notes to friends profiles&quot;
</a><a href="#h7-1-6" id="h7-1-6" class="i">+                    },
</a>                     &quot;cof_experiments&quot;: {
                         &quot;name&quot;: &quot;COF Experiments&quot;,
                         &quot;description&quot;: &quot;Enables unreleased/beta Snapchat features&quot;
<b>diff --git a/<a id="h8" href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/config/impl/Experimental.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/config/impl/Experimental.kt</a> b/<a href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/config/impl/Experimental.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/config/impl/Experimental.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -70,6 +70,7 @@ class Experimental : ConfigContainer() {
</a>     val accountSwitcher = container(&quot;account_switcher&quot;, AccountSwitcherConfig()) { requireRestart(); addNotices(FeatureNotice.UNSTABLE) }
     val betterTranscript = container(&quot;better_transcript&quot;, BetterTranscriptConfig()) { requireRestart() }
     val voiceNoteAutoPlay = boolean(&quot;voice_note_auto_play&quot;) { requireRestart() }
<a href="#h8-0-3" id="h8-0-3" class="i">+    val friendNotes = boolean(&quot;friend_notes&quot;) { requireRestart() }
</a>     val editMessage = boolean(&quot;edit_message&quot;) { requireRestart() }
     val contextMenuFix = boolean(&quot;context_menu_fix&quot;) { requireRestart() }
     val cofExperiments = multiple(&quot;cof_experiments&quot;, *cofExperimentList.toTypedArray()) { requireRestart(); addFlags(ConfigFlag.NO_TRANSLATE); addNotices(FeatureNotice.UNSTABLE) }
<b>diff --git a/<a id="h9" href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Components.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Components.kt</a> b/<a href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Components.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Components.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -0,0 +1,47 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+package me.rhunk.snapenhance.common.ui
</a><a href="#h9-0-1" id="h9-0-1" class="i">+
</a><a href="#h9-0-2" id="h9-0-2" class="i">+import androidx.compose.foundation.layout.fillMaxWidth
</a><a href="#h9-0-3" id="h9-0-3" class="i">+import androidx.compose.foundation.layout.heightIn
</a><a href="#h9-0-4" id="h9-0-4" class="i">+import androidx.compose.material3.LocalTextStyle
</a><a href="#h9-0-5" id="h9-0-5" class="i">+import androidx.compose.material3.MaterialTheme
</a><a href="#h9-0-6" id="h9-0-6" class="i">+import androidx.compose.material3.Text
</a><a href="#h9-0-7" id="h9-0-7" class="i">+import androidx.compose.material3.TextField
</a><a href="#h9-0-8" id="h9-0-8" class="i">+import androidx.compose.material3.TextFieldDefaults
</a><a href="#h9-0-9" id="h9-0-9" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h9-0-10" id="h9-0-10" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h9-0-11" id="h9-0-11" class="i">+import androidx.compose.ui.graphics.Color
</a><a href="#h9-0-12" id="h9-0-12" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h9-0-13" id="h9-0-13" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h9-0-14" id="h9-0-14" class="i">+import me.rhunk.snapenhance.common.bridge.wrapper.LocaleWrapper
</a><a href="#h9-0-15" id="h9-0-15" class="i">+
</a><a href="#h9-0-16" id="h9-0-16" class="i">+
</a><a href="#h9-0-17" id="h9-0-17" class="i">+@Composable
</a><a href="#h9-0-18" id="h9-0-18" class="i">+fun EditNoteTextField(
</a><a href="#h9-0-19" id="h9-0-19" class="i">+    modifier: Modifier = Modifier,
</a><a href="#h9-0-20" id="h9-0-20" class="i">+    primaryColor: Color,
</a><a href="#h9-0-21" id="h9-0-21" class="i">+    translation: LocaleWrapper,
</a><a href="#h9-0-22" id="h9-0-22" class="i">+    content: String?,
</a><a href="#h9-0-23" id="h9-0-23" class="i">+    setContent: (String) -&gt; Unit
</a><a href="#h9-0-24" id="h9-0-24" class="i">+) {
</a><a href="#h9-0-25" id="h9-0-25" class="i">+    TextField(
</a><a href="#h9-0-26" id="h9-0-26" class="i">+        modifier = Modifier
</a><a href="#h9-0-27" id="h9-0-27" class="i">+            .fillMaxWidth()
</a><a href="#h9-0-28" id="h9-0-28" class="i">+            .heightIn(max = 180.dp)
</a><a href="#h9-0-29" id="h9-0-29" class="i">+            .then(modifier),
</a><a href="#h9-0-30" id="h9-0-30" class="i">+        value = content ?: &quot;&quot;,
</a><a href="#h9-0-31" id="h9-0-31" class="i">+        colors = TextFieldDefaults.colors(
</a><a href="#h9-0-32" id="h9-0-32" class="i">+            unfocusedContainerColor = Color.Transparent,
</a><a href="#h9-0-33" id="h9-0-33" class="i">+            focusedContainerColor = MaterialTheme.colorScheme.surfaceContainer,
</a><a href="#h9-0-34" id="h9-0-34" class="i">+            focusedIndicatorColor = Color.Transparent,
</a><a href="#h9-0-35" id="h9-0-35" class="i">+            unfocusedIndicatorColor = Color.Transparent,
</a><a href="#h9-0-36" id="h9-0-36" class="i">+            disabledIndicatorColor = Color.Transparent,
</a><a href="#h9-0-37" id="h9-0-37" class="i">+            cursorColor = primaryColor
</a><a href="#h9-0-38" id="h9-0-38" class="i">+        ),
</a><a href="#h9-0-39" id="h9-0-39" class="i">+        onValueChange = {
</a><a href="#h9-0-40" id="h9-0-40" class="i">+            setContent(it)
</a><a href="#h9-0-41" id="h9-0-41" class="i">+        },
</a><a href="#h9-0-42" id="h9-0-42" class="i">+        shape = MaterialTheme.shapes.medium,
</a><a href="#h9-0-43" id="h9-0-43" class="i">+        textStyle = LocalTextStyle.current.copy(fontSize = 12.sp, color = primaryColor),
</a><a href="#h9-0-44" id="h9-0-44" class="i">+        placeholder = { Text(text = translation[&quot;manager.sections.manage_scope.notes_placeholder&quot;], fontSize = 12.sp) }
</a><a href="#h9-0-45" id="h9-0-45" class="i">+    )
</a><a href="#h9-0-46" id="h9-0-46" class="i">+}</a><a href="#h9-0-47" id="h9-0-47" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h10" href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/ComposeViewFactory.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/ComposeViewFactory.kt</a> b/<a href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/ComposeViewFactory.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/ComposeViewFactory.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -31,8 +31,12 @@ import kotlinx.coroutines.CoroutineScope
</a> import kotlinx.coroutines.launch
 
 // https://github.com/tberghuis/FloatingCountdownTimer/blob/master/app/src/main/java/xyz/tberghuis/floatingtimer/service/overlayViewFactory.kt
<a href="#h10-0-3" id="h10-0-3" class="d">-fun createComposeView(context: Context, content: @Composable () -&gt; Unit) = ComposeView(context).apply {
</a><a href="#h10-0-4" id="h10-0-4" class="d">-    setViewCompositionStrategy(ViewCompositionStrategy.DisposeOnViewTreeLifecycleDestroyed)
</a><a href="#h10-0-5" id="h10-0-5" class="i">+fun createComposeView(
</a><a href="#h10-0-6" id="h10-0-6" class="i">+    context: Context,
</a><a href="#h10-0-7" id="h10-0-7" class="i">+    viewCompositionStrategy: ViewCompositionStrategy = ViewCompositionStrategy.DisposeOnViewTreeLifecycleDestroyed,
</a><a href="#h10-0-8" id="h10-0-8" class="i">+    content: @Composable () -&gt; Unit
</a><a href="#h10-0-9" id="h10-0-9" class="i">+) = ComposeView(context).apply {
</a><a href="#h10-0-10" id="h10-0-10" class="i">+    setViewCompositionStrategy(viewCompositionStrategy)
</a>     val lifecycleOwner = OverlayLifecycleOwner().apply {
         performRestore(null)
         handleLifecycleEvent(Lifecycle.Event.ON_CREATE)
<b>diff --git a/<a id="h11" href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Keyboard.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Keyboard.kt</a> b/<a href="../file/common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Keyboard.kt.html">common/src/main/kotlin/me/rhunk/snapenhance/common/ui/Keyboard.kt</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -0,0 +1,47 @@
</a><a href="#h11-0-0" id="h11-0-0" class="i">+package me.rhunk.snapenhance.common.ui
</a><a href="#h11-0-1" id="h11-0-1" class="i">+
</a><a href="#h11-0-2" id="h11-0-2" class="i">+
</a><a href="#h11-0-3" id="h11-0-3" class="i">+import android.view.ViewTreeObserver
</a><a href="#h11-0-4" id="h11-0-4" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h11-0-5" id="h11-0-5" class="i">+import androidx.compose.runtime.DisposableEffect
</a><a href="#h11-0-6" id="h11-0-6" class="i">+import androidx.compose.runtime.State
</a><a href="#h11-0-7" id="h11-0-7" class="i">+import androidx.compose.runtime.mutableStateOf
</a><a href="#h11-0-8" id="h11-0-8" class="i">+import androidx.compose.runtime.remember
</a><a href="#h11-0-9" id="h11-0-9" class="i">+import androidx.compose.ui.platform.LocalFocusManager
</a><a href="#h11-0-10" id="h11-0-10" class="i">+import androidx.compose.ui.platform.LocalView
</a><a href="#h11-0-11" id="h11-0-11" class="i">+import androidx.core.view.ViewCompat
</a><a href="#h11-0-12" id="h11-0-12" class="i">+import androidx.core.view.WindowInsetsCompat
</a><a href="#h11-0-13" id="h11-0-13" class="i">+import androidx.compose.runtime.getValue
</a><a href="#h11-0-14" id="h11-0-14" class="i">+
</a><a href="#h11-0-15" id="h11-0-15" class="i">+@Composable
</a><a href="#h11-0-16" id="h11-0-16" class="i">+fun keyboardState(): State&lt;Boolean&gt; {
</a><a href="#h11-0-17" id="h11-0-17" class="i">+    val keyboardState = remember { mutableStateOf(false) }
</a><a href="#h11-0-18" id="h11-0-18" class="i">+    val localView = LocalView.current
</a><a href="#h11-0-19" id="h11-0-19" class="i">+    val viewTreeObserver = localView.viewTreeObserver
</a><a href="#h11-0-20" id="h11-0-20" class="i">+
</a><a href="#h11-0-21" id="h11-0-21" class="i">+    DisposableEffect(viewTreeObserver) {
</a><a href="#h11-0-22" id="h11-0-22" class="i">+        val listener = ViewTreeObserver.OnGlobalLayoutListener {
</a><a href="#h11-0-23" id="h11-0-23" class="i">+            keyboardState.value = ViewCompat.getRootWindowInsets(localView)
</a><a href="#h11-0-24" id="h11-0-24" class="i">+                ?.isVisible(WindowInsetsCompat.Type.ime()) != false
</a><a href="#h11-0-25" id="h11-0-25" class="i">+        }
</a><a href="#h11-0-26" id="h11-0-26" class="i">+        viewTreeObserver.addOnGlobalLayoutListener(listener)
</a><a href="#h11-0-27" id="h11-0-27" class="i">+        onDispose {
</a><a href="#h11-0-28" id="h11-0-28" class="i">+            viewTreeObserver.takeIf { it.isAlive }?.removeOnGlobalLayoutListener(listener)
</a><a href="#h11-0-29" id="h11-0-29" class="i">+        }
</a><a href="#h11-0-30" id="h11-0-30" class="i">+    }
</a><a href="#h11-0-31" id="h11-0-31" class="i">+
</a><a href="#h11-0-32" id="h11-0-32" class="i">+    return keyboardState
</a><a href="#h11-0-33" id="h11-0-33" class="i">+}
</a><a href="#h11-0-34" id="h11-0-34" class="i">+
</a><a href="#h11-0-35" id="h11-0-35" class="i">+@Composable
</a><a href="#h11-0-36" id="h11-0-36" class="i">+fun AutoClearKeyboardFocus(
</a><a href="#h11-0-37" id="h11-0-37" class="i">+    onFocusClear: () -&gt; Unit = {}
</a><a href="#h11-0-38" id="h11-0-38" class="i">+) {
</a><a href="#h11-0-39" id="h11-0-39" class="i">+    val focusManager = LocalFocusManager.current
</a><a href="#h11-0-40" id="h11-0-40" class="i">+    val keyboardState by keyboardState()
</a><a href="#h11-0-41" id="h11-0-41" class="i">+
</a><a href="#h11-0-42" id="h11-0-42" class="i">+    if (!keyboardState) {
</a><a href="#h11-0-43" id="h11-0-43" class="i">+        onFocusClear()
</a><a href="#h11-0-44" id="h11-0-44" class="i">+        focusManager.clearFocus()
</a><a href="#h11-0-45" id="h11-0-45" class="i">+    }
</a><a href="#h11-0-46" id="h11-0-46" class="i">+}
</a><b>diff --git a/<a id="h12" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/bridge/BridgeClient.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/bridge/BridgeClient.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/bridge/BridgeClient.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/bridge/BridgeClient.kt</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -251,6 +251,10 @@ class BridgeClient(
</a>         service.setRule(targetUuid, type.key, state)
     }
 
<a href="#h12-0-3" id="h12-0-3" class="i">+    fun getScopeNotes(id: String): String? = safeServiceCall { service.getScopeNotes(id) }
</a><a href="#h12-0-4" id="h12-0-4" class="i">+
</a><a href="#h12-0-5" id="h12-0-5" class="i">+    fun setScopeNotes(id: String, content: String?) = safeServiceCall { service.setScopeNotes(id, content) }
</a><a href="#h12-0-6" id="h12-0-6" class="i">+
</a>     fun getScriptingInterface(): IScripting = safeServiceCall { service.scriptingInterface }
 
     fun getE2eeInterface(): E2eeInterface = safeServiceCall { service.e2eeInterface }
<b>diff --git a/<a id="h13" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/FeatureManager.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/FeatureManager.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/FeatureManager.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/FeatureManager.kt</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -137,6 +137,7 @@ class FeatureManager(
</a>             DisableTelecomFramework(),
             BetterTranscript(),
             VoiceNoteOverride(),
<a href="#h13-0-3" id="h13-0-3" class="i">+            FriendNotes(),
</a>         )
 
         features.values.toList().forEach { feature -&gt;
<b>diff --git a/<a id="h14" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/MediaDownloader.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/MediaDownloader.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/MediaDownloader.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/downloader/MediaDownloader.kt</a></b>
<a href="#h14-0" id="h14-0" class="h">@@ -79,7 +79,7 @@ class MediaDownloader : MessagingRuleFeature(&quot;MediaDownloader&quot;, MessagingRuleTyp
</a>             else UUID.randomUUID().toString()
         ).longHashCode().absoluteValue.toString(16)
 
<a href="#h14-0-3" id="h14-0-3" class="d">-        val iconUrl = BitmojiSelfie.getBitmojiSelfie(friendInfo?.bitmojiSelfieId, friendInfo?.bitmojiAvatarId, BitmojiSelfie.BitmojiSelfieType.THREE_D)
</a><a href="#h14-0-4" id="h14-0-4" class="i">+        val iconUrl = BitmojiSelfie.getBitmojiSelfie(friendInfo?.bitmojiSelfieId, friendInfo?.bitmojiAvatarId, BitmojiSelfie.BitmojiSelfieType.NEW_THREE_D)
</a> 
         val downloadLogging by context.config.downloader.logging
         if (downloadLogging.contains(&quot;started&quot;)) {
<b>diff --git a/<a id="h15" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ui/FriendNotes.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ui/FriendNotes.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ui/FriendNotes.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/features/impl/ui/FriendNotes.kt</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -0,0 +1,83 @@
</a><a href="#h15-0-0" id="h15-0-0" class="i">+package me.rhunk.snapenhance.core.features.impl.ui
</a><a href="#h15-0-1" id="h15-0-1" class="i">+
</a><a href="#h15-0-2" id="h15-0-2" class="i">+import android.view.ViewGroup
</a><a href="#h15-0-3" id="h15-0-3" class="i">+import android.widget.LinearLayout
</a><a href="#h15-0-4" id="h15-0-4" class="i">+import androidx.compose.foundation.layout.padding
</a><a href="#h15-0-5" id="h15-0-5" class="i">+import androidx.compose.runtime.DisposableEffect
</a><a href="#h15-0-6" id="h15-0-6" class="i">+import androidx.compose.runtime.getValue
</a><a href="#h15-0-7" id="h15-0-7" class="i">+import androidx.compose.runtime.mutableStateOf
</a><a href="#h15-0-8" id="h15-0-8" class="i">+import androidx.compose.runtime.remember
</a><a href="#h15-0-9" id="h15-0-9" class="i">+import androidx.compose.runtime.setValue
</a><a href="#h15-0-10" id="h15-0-10" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h15-0-11" id="h15-0-11" class="i">+import androidx.compose.ui.graphics.Color
</a><a href="#h15-0-12" id="h15-0-12" class="i">+import androidx.compose.ui.platform.ViewCompositionStrategy
</a><a href="#h15-0-13" id="h15-0-13" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h15-0-14" id="h15-0-14" class="i">+import me.rhunk.snapenhance.common.ui.AutoClearKeyboardFocus
</a><a href="#h15-0-15" id="h15-0-15" class="i">+import me.rhunk.snapenhance.common.ui.EditNoteTextField
</a><a href="#h15-0-16" id="h15-0-16" class="i">+import me.rhunk.snapenhance.common.ui.createComposeView
</a><a href="#h15-0-17" id="h15-0-17" class="i">+import me.rhunk.snapenhance.common.ui.rememberAsyncMutableState
</a><a href="#h15-0-18" id="h15-0-18" class="i">+import me.rhunk.snapenhance.core.event.events.impl.AddViewEvent
</a><a href="#h15-0-19" id="h15-0-19" class="i">+import me.rhunk.snapenhance.core.features.Feature
</a><a href="#h15-0-20" id="h15-0-20" class="i">+import me.rhunk.snapenhance.core.ui.getComposerContext
</a><a href="#h15-0-21" id="h15-0-21" class="i">+import me.rhunk.snapenhance.core.util.ktx.getObjectFieldOrNull
</a><a href="#h15-0-22" id="h15-0-22" class="i">+
</a><a href="#h15-0-23" id="h15-0-23" class="i">+class FriendNotes: Feature(&quot;Friend Notes&quot;) {
</a><a href="#h15-0-24" id="h15-0-24" class="i">+    override fun init() {
</a><a href="#h15-0-25" id="h15-0-25" class="i">+        if (!context.config.experimental.friendNotes.get()) return
</a><a href="#h15-0-26" id="h15-0-26" class="i">+
</a><a href="#h15-0-27" id="h15-0-27" class="i">+        context.event.subscribe(AddViewEvent::class) { event -&gt;
</a><a href="#h15-0-28" id="h15-0-28" class="i">+            if (!event.viewClassName.endsWith(&quot;UnifiedProfileFlatlandProfileViewTopViewFrameLayout&quot;)) return@subscribe
</a><a href="#h15-0-29" id="h15-0-29" class="i">+
</a><a href="#h15-0-30" id="h15-0-30" class="i">+            val viewGroup = (event.view as? ViewGroup) ?: return@subscribe
</a><a href="#h15-0-31" id="h15-0-31" class="i">+            viewGroup.post {
</a><a href="#h15-0-32" id="h15-0-32" class="i">+                val composerRootView = viewGroup.getChildAt(0) ?: return@post
</a><a href="#h15-0-33" id="h15-0-33" class="i">+                val composerContext = composerRootView.getComposerContext() ?: return@post
</a><a href="#h15-0-34" id="h15-0-34" class="i">+                val userId = composerContext.viewModel?.getObjectFieldOrNull(&quot;_userId&quot;)?.toString() ?: return@post
</a><a href="#h15-0-35" id="h15-0-35" class="i">+
</a><a href="#h15-0-36" id="h15-0-36" class="i">+                if (userId == context.database.myUserId) return@post
</a><a href="#h15-0-37" id="h15-0-37" class="i">+
</a><a href="#h15-0-38" id="h15-0-38" class="i">+                viewGroup.removeView(composerRootView)
</a><a href="#h15-0-39" id="h15-0-39" class="i">+
</a><a href="#h15-0-40" id="h15-0-40" class="i">+                val manageNotesView = createComposeView(viewGroup.context, ViewCompositionStrategy.DisposeOnDetachedFromWindow) {
</a><a href="#h15-0-41" id="h15-0-41" class="i">+                    val primaryColor = remember { Color(this@FriendNotes.context.userInterface.colorPrimary) }
</a><a href="#h15-0-42" id="h15-0-42" class="i">+                    var isFetched by remember { mutableStateOf(false) }
</a><a href="#h15-0-43" id="h15-0-43" class="i">+                    var scopeNotes by rememberAsyncMutableState(null) {
</a><a href="#h15-0-44" id="h15-0-44" class="i">+                        this@FriendNotes.context.bridgeClient.getScopeNotes(userId).also {
</a><a href="#h15-0-45" id="h15-0-45" class="i">+                            isFetched = true
</a><a href="#h15-0-46" id="h15-0-46" class="i">+                        }
</a><a href="#h15-0-47" id="h15-0-47" class="i">+                    }
</a><a href="#h15-0-48" id="h15-0-48" class="i">+
</a><a href="#h15-0-49" id="h15-0-49" class="i">+                    DisposableEffect(Unit) {
</a><a href="#h15-0-50" id="h15-0-50" class="i">+                        onDispose {
</a><a href="#h15-0-51" id="h15-0-51" class="i">+                            runCatching {
</a><a href="#h15-0-52" id="h15-0-52" class="i">+                                if (!isFetched) return@runCatching
</a><a href="#h15-0-53" id="h15-0-53" class="i">+                                context.bridgeClient.setScopeNotes(userId, scopeNotes)
</a><a href="#h15-0-54" id="h15-0-54" class="i">+                            }.onFailure {
</a><a href="#h15-0-55" id="h15-0-55" class="i">+                                context.log.error(&quot;Failed to save notes&quot;, it)
</a><a href="#h15-0-56" id="h15-0-56" class="i">+                            }
</a><a href="#h15-0-57" id="h15-0-57" class="i">+                        }
</a><a href="#h15-0-58" id="h15-0-58" class="i">+                    }
</a><a href="#h15-0-59" id="h15-0-59" class="i">+
</a><a href="#h15-0-60" id="h15-0-60" class="i">+                    AutoClearKeyboardFocus()
</a><a href="#h15-0-61" id="h15-0-61" class="i">+
</a><a href="#h15-0-62" id="h15-0-62" class="i">+                    EditNoteTextField(
</a><a href="#h15-0-63" id="h15-0-63" class="i">+                        modifier = Modifier.padding(top = 8.dp),
</a><a href="#h15-0-64" id="h15-0-64" class="i">+                        primaryColor = primaryColor,
</a><a href="#h15-0-65" id="h15-0-65" class="i">+                        translation = context.translation,
</a><a href="#h15-0-66" id="h15-0-66" class="i">+                        content = scopeNotes,
</a><a href="#h15-0-67" id="h15-0-67" class="i">+                        setContent = { scopeNotes = it }
</a><a href="#h15-0-68" id="h15-0-68" class="i">+                    )
</a><a href="#h15-0-69" id="h15-0-69" class="i">+                }
</a><a href="#h15-0-70" id="h15-0-70" class="i">+
</a><a href="#h15-0-71" id="h15-0-71" class="i">+                val linearLayout = LinearLayout(viewGroup.context).apply {
</a><a href="#h15-0-72" id="h15-0-72" class="i">+                    orientation = LinearLayout.VERTICAL
</a><a href="#h15-0-73" id="h15-0-73" class="i">+
</a><a href="#h15-0-74" id="h15-0-74" class="i">+                    addView(composerRootView)
</a><a href="#h15-0-75" id="h15-0-75" class="i">+                    addView(manageNotesView)
</a><a href="#h15-0-76" id="h15-0-76" class="i">+                }
</a><a href="#h15-0-77" id="h15-0-77" class="i">+
</a><a href="#h15-0-78" id="h15-0-78" class="i">+                viewGroup.addView(linearLayout)
</a><a href="#h15-0-79" id="h15-0-79" class="i">+            }
</a><a href="#h15-0-80" id="h15-0-80" class="i">+        }
</a><a href="#h15-0-81" id="h15-0-81" class="i">+    }
</a><a href="#h15-0-82" id="h15-0-82" class="i">+}</a><a href="#h15-0-83" id="h15-0-83" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h16" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/ui/menu/impl/FriendFeedInfoMenu.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/ui/menu/impl/FriendFeedInfoMenu.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/ui/menu/impl/FriendFeedInfoMenu.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/ui/menu/impl/FriendFeedInfoMenu.kt</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -89,7 +89,7 @@ class FriendFeedInfoMenu : AbstractMenu() {
</a>                     BitmojiSelfie.getBitmojiSelfie(
                         profile.bitmojiSelfieId.toString(),
                         profile.bitmojiAvatarId.toString(),
<a href="#h16-0-3" id="h16-0-3" class="d">-                        BitmojiSelfie.BitmojiSelfieType.THREE_D
</a><a href="#h16-0-4" id="h16-0-4" class="i">+                        BitmojiSelfie.BitmojiSelfieType.NEW_THREE_D
</a>                     )!!
                 )
             }
</pre>
</div>
</body>
</html>
