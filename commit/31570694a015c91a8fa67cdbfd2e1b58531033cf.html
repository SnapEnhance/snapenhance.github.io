<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>feat: scope content - refactor image loader - rules - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/31570694a015c91a8fa67cdbfd2e1b58531033cf.html">31570694a015c91a8fa67cdbfd2e1b58531033cf</a>
<b>parent</b> <a href="../commit/cb301f8a423b83bf80ca130d7e396228732e122e.html">cb301f8a423b83bf80ca130d7e396228732e122e</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Sun, 20 Aug 2023 15:27:42 +0200

feat: scope content
- refactor image loader
- rules

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">app/src/main/kotlin/me/rhunk/snapenhance/RemoteSideContext.kt</a></td><td> | </td><td class="num">15</td><td><span class="i">+++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a></td><td> | </td><td class="num">32</td><td><span class="i">+++++++++++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a></td><td> | </td><td class="num">51</td><td><span class="i">++++++++</span><span class="d">-------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a></td><td> | </td><td class="num">117</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="D">D</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeTab.kt</a></td><td> | </td><td class="num">73</td><td><span class="i"></span><span class="d">-------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a></td><td> | </td><td class="num">160</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">---------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h7">app/src/main/kotlin/me/rhunk/snapenhance/ui/util/ComposeImageHelper.kt</a></td><td> | </td><td class="num">54</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">core/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeClient.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++</span><span class="d">------------</span></td></tr>
</table></pre><pre>10 files changed, 328 insertions(+), 208 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/RemoteSideContext.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/RemoteSideContext.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/RemoteSideContext.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/RemoteSideContext.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -5,6 +5,10 @@ import android.content.Context
</a> import android.content.Intent
 import android.net.Uri
 import androidx.documentfile.provider.DocumentFile
<a href="#h0-0-3" id="h0-0-3" class="i">+import coil.ImageLoader
</a><a href="#h0-0-4" id="h0-0-4" class="i">+import coil.decode.VideoFrameDecoder
</a><a href="#h0-0-5" id="h0-0-5" class="i">+import coil.memory.MemoryCache
</a><a href="#h0-0-6" id="h0-0-6" class="i">+import kotlinx.coroutines.Dispatchers
</a> import me.rhunk.snapenhance.bridge.BridgeService
 import me.rhunk.snapenhance.bridge.wrapper.LocaleWrapper
 import me.rhunk.snapenhance.bridge.wrapper.MappingsWrapper
<a href="#h0-1" id="h0-1" class="h">@@ -35,6 +39,17 @@ class RemoteSideContext(
</a>     val downloadTaskManager = DownloadTaskManager()
     val modDatabase = ModDatabase(this)
 
<a href="#h0-1-3" id="h0-1-3" class="i">+    //used to load bitmoji selfies and download previews
</a><a href="#h0-1-4" id="h0-1-4" class="i">+    val imageLoader by lazy {
</a><a href="#h0-1-5" id="h0-1-5" class="i">+        ImageLoader.Builder(androidContext)
</a><a href="#h0-1-6" id="h0-1-6" class="i">+            .dispatcher(Dispatchers.IO)
</a><a href="#h0-1-7" id="h0-1-7" class="i">+            .memoryCache {
</a><a href="#h0-1-8" id="h0-1-8" class="i">+                MemoryCache.Builder(androidContext)
</a><a href="#h0-1-9" id="h0-1-9" class="i">+                    .maxSizePercent(0.25)
</a><a href="#h0-1-10" id="h0-1-10" class="i">+                    .build()
</a><a href="#h0-1-11" id="h0-1-11" class="i">+            }.components { add(VideoFrameDecoder.Factory()) }.build()
</a><a href="#h0-1-12" id="h0-1-12" class="i">+    }
</a><a href="#h0-1-13" id="h0-1-13" class="i">+
</a>     init {
         runCatching {
             config.loadFromContext(androidContext)
<b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeService.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -12,7 +12,7 @@ import me.rhunk.snapenhance.bridge.wrapper.LocaleWrapper
</a> import me.rhunk.snapenhance.bridge.wrapper.MessageLoggerWrapper
 import me.rhunk.snapenhance.core.messaging.MessagingFriendInfo
 import me.rhunk.snapenhance.core.messaging.MessagingGroupInfo
<a href="#h1-0-3" id="h1-0-3" class="d">-import me.rhunk.snapenhance.core.messaging.MessagingScope
</a><a href="#h1-0-4" id="h1-0-4" class="i">+import me.rhunk.snapenhance.core.messaging.SocialScope
</a> import me.rhunk.snapenhance.database.objects.FriendInfo
 import me.rhunk.snapenhance.download.DownloadProcessor
 import me.rhunk.snapenhance.util.SerializableDataObject
<a href="#h1-1" id="h1-1" class="h">@@ -112,7 +112,7 @@ class BridgeService : Service() {
</a>         }
 
         override fun getRules(objectType: String, uuid: String): MutableList&lt;String&gt; {
<a href="#h1-1-3" id="h1-1-3" class="d">-            remoteSideContext.modDatabase.getRulesFromId(MessagingScope.valueOf(objectType), uuid)
</a><a href="#h1-1-4" id="h1-1-4" class="i">+            remoteSideContext.modDatabase.getRulesFromId(SocialScope.valueOf(objectType), uuid)
</a>                 .let { rules -&gt;
                     return rules.map { it.toJson() }.toMutableList()
                 }
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/messaging/ModDatabase.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -7,8 +7,7 @@ import me.rhunk.snapenhance.core.messaging.FriendStreaks
</a> import me.rhunk.snapenhance.core.messaging.MessagingFriendInfo
 import me.rhunk.snapenhance.core.messaging.MessagingGroupInfo
 import me.rhunk.snapenhance.core.messaging.MessagingRule
<a href="#h2-0-3" id="h2-0-3" class="d">-import me.rhunk.snapenhance.core.messaging.Mode
</a><a href="#h2-0-4" id="h2-0-4" class="d">-import me.rhunk.snapenhance.core.messaging.MessagingScope
</a><a href="#h2-0-5" id="h2-0-5" class="i">+import me.rhunk.snapenhance.core.messaging.SocialScope
</a> import me.rhunk.snapenhance.database.objects.FriendInfo
 import me.rhunk.snapenhance.util.SQLiteDatabaseHelper
 import me.rhunk.snapenhance.util.ktx.getInteger
<a href="#h2-1" id="h2-1" class="h">@@ -50,8 +49,7 @@ class ModDatabase(
</a>                 &quot;id INTEGER PRIMARY KEY AUTOINCREMENT&quot;,
                 &quot;scope VARCHAR&quot;,
                 &quot;targetUuid VARCHAR&quot;,
<a href="#h2-1-3" id="h2-1-3" class="d">-                &quot;enabled BOOLEAN&quot;,
</a><a href="#h2-1-4" id="h2-1-4" class="d">-                &quot;mode VARCHAR&quot;,
</a><a href="#h2-1-5" id="h2-1-5" class="i">+                //&quot;mode VARCHAR&quot;,
</a>                 &quot;subject VARCHAR&quot;
             ),
             &quot;streaks&quot; to listOf(
<a href="#h2-2" id="h2-2" class="h">@@ -153,16 +151,14 @@ class ModDatabase(
</a>         }
     }
 
<a href="#h2-2-3" id="h2-2-3" class="d">-    fun getRulesFromId(type: MessagingScope, targetUuid: String): List&lt;MessagingRule&gt; {
</a><a href="#h2-2-4" id="h2-2-4" class="d">-        return database.rawQuery(&quot;SELECT * FROM rules WHERE objectType = ? AND targetUuid = ?&quot;, arrayOf(type.name, targetUuid)).use { cursor -&gt;
</a><a href="#h2-2-5" id="h2-2-5" class="i">+    fun getRulesFromId(type: SocialScope, targetUuid: String): List&lt;MessagingRule&gt; {
</a><a href="#h2-2-6" id="h2-2-6" class="i">+        return database.rawQuery(&quot;SELECT * FROM rules WHERE scope = ? AND targetUuid = ?&quot;, arrayOf(type.name, targetUuid)).use { cursor -&gt;
</a>             val rules = mutableListOf&lt;MessagingRule&gt;()
             while (cursor.moveToNext()) {
                 rules.add(MessagingRule(
                     id = cursor.getInteger(&quot;id&quot;),
<a href="#h2-2-11" id="h2-2-11" class="d">-                    messagingScope = MessagingScope.valueOf(cursor.getStringOrNull(&quot;scope&quot;)!!),
</a><a href="#h2-2-12" id="h2-2-12" class="i">+                    socialScope = SocialScope.valueOf(cursor.getStringOrNull(&quot;scope&quot;)!!),
</a>                     targetUuid = cursor.getStringOrNull(&quot;targetUuid&quot;)!!,
<a href="#h2-2-14" id="h2-2-14" class="d">-                    enabled = cursor.getInteger(&quot;enabled&quot;) == 1,
</a><a href="#h2-2-15" id="h2-2-15" class="d">-                    mode = Mode.valueOf(cursor.getStringOrNull(&quot;mode&quot;)!!),
</a>                     subject = cursor.getStringOrNull(&quot;subject&quot;)!!
                 ))
             }
<a href="#h2-3" id="h2-3" class="h">@@ -170,6 +166,24 @@ class ModDatabase(
</a>         }
     }
 
<a href="#h2-3-3" id="h2-3-3" class="i">+    fun toggleRuleFor(type: SocialScope, targetUuid: String, subject: String, enabled: Boolean) {
</a><a href="#h2-3-4" id="h2-3-4" class="i">+        executeAsync {
</a><a href="#h2-3-5" id="h2-3-5" class="i">+            if (enabled) {
</a><a href="#h2-3-6" id="h2-3-6" class="i">+                database.execSQL(&quot;INSERT OR REPLACE INTO rules (scope, targetUuid, subject) VALUES (?, ?, ?)&quot;, arrayOf(
</a><a href="#h2-3-7" id="h2-3-7" class="i">+                    type.name,
</a><a href="#h2-3-8" id="h2-3-8" class="i">+                    targetUuid,
</a><a href="#h2-3-9" id="h2-3-9" class="i">+                    subject
</a><a href="#h2-3-10" id="h2-3-10" class="i">+                ))
</a><a href="#h2-3-11" id="h2-3-11" class="i">+            } else {
</a><a href="#h2-3-12" id="h2-3-12" class="i">+                database.execSQL(&quot;DELETE FROM rules WHERE scope = ? AND targetUuid = ? AND subject = ?&quot;, arrayOf(
</a><a href="#h2-3-13" id="h2-3-13" class="i">+                    type.name,
</a><a href="#h2-3-14" id="h2-3-14" class="i">+                    targetUuid,
</a><a href="#h2-3-15" id="h2-3-15" class="i">+                    subject
</a><a href="#h2-3-16" id="h2-3-16" class="i">+                ))
</a><a href="#h2-3-17" id="h2-3-17" class="i">+            }
</a><a href="#h2-3-18" id="h2-3-18" class="i">+        }
</a><a href="#h2-3-19" id="h2-3-19" class="i">+    }
</a><a href="#h2-3-20" id="h2-3-20" class="i">+
</a>     fun getFriendInfo(userId: String): MessagingFriendInfo? {
         return database.rawQuery(&quot;SELECT * FROM friends WHERE userId = ?&quot;, arrayOf(userId)).use { cursor -&gt;
             if (!cursor.moveToFirst()) return@use null
<b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -15,7 +15,6 @@ import androidx.compose.foundation.layout.fillMaxSize
</a> import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.height
 import androidx.compose.foundation.layout.padding
<a href="#h3-0-3" id="h3-0-3" class="d">-import androidx.compose.foundation.layout.requiredWidthIn
</a> import androidx.compose.foundation.lazy.LazyColumn
 import androidx.compose.foundation.lazy.rememberLazyListState
 import androidx.compose.material.icons.Icons
<a href="#h3-1" id="h3-1" class="h">@@ -49,34 +48,19 @@ import androidx.compose.ui.text.style.TextAlign
</a> import androidx.compose.ui.text.style.TextOverflow
 import androidx.compose.ui.unit.dp
 import androidx.compose.ui.unit.sp
<a href="#h3-1-3" id="h3-1-3" class="d">-import coil.ImageLoader
</a> import coil.compose.rememberAsyncImagePainter
<a href="#h3-1-5" id="h3-1-5" class="d">-import coil.decode.VideoFrameDecoder
</a><a href="#h3-1-6" id="h3-1-6" class="d">-import coil.memory.MemoryCache
</a><a href="#h3-1-7" id="h3-1-7" class="d">-import coil.request.ImageRequest
</a><a href="#h3-1-8" id="h3-1-8" class="d">-import coil.size.Precision
</a><a href="#h3-1-9" id="h3-1-9" class="d">-import kotlinx.coroutines.Dispatchers
</a> import kotlinx.coroutines.launch
<a href="#h3-1-11" id="h3-1-11" class="d">-import me.rhunk.snapenhance.R
</a> import me.rhunk.snapenhance.data.FileType
 import me.rhunk.snapenhance.download.data.DownloadObject
 import me.rhunk.snapenhance.download.data.MediaFilter
 import me.rhunk.snapenhance.ui.manager.Section
<a href="#h3-1-16" id="h3-1-16" class="i">+import me.rhunk.snapenhance.ui.util.BitmojiImage
</a><a href="#h3-1-17" id="h3-1-17" class="i">+import me.rhunk.snapenhance.ui.util.ImageRequestHelper
</a> 
 class DownloadsSection : Section() {
     private val loadedDownloads = mutableStateOf(mapOf&lt;Int, DownloadObject&gt;())
     private var currentFilter = mutableStateOf(MediaFilter.NONE)
 
<a href="#h3-1-23" id="h3-1-23" class="d">-    private val imageLoader by lazy {
</a><a href="#h3-1-24" id="h3-1-24" class="d">-        ImageLoader.Builder(context.androidContext)
</a><a href="#h3-1-25" id="h3-1-25" class="d">-            .dispatcher(Dispatchers.IO)
</a><a href="#h3-1-26" id="h3-1-26" class="d">-            .memoryCache {
</a><a href="#h3-1-27" id="h3-1-27" class="d">-                MemoryCache.Builder(context.androidContext)
</a><a href="#h3-1-28" id="h3-1-28" class="d">-                    .maxSizePercent(0.25)
</a><a href="#h3-1-29" id="h3-1-29" class="d">-                    .build()
</a><a href="#h3-1-30" id="h3-1-30" class="d">-            }.components { add(VideoFrameDecoder.Factory()) }.build()
</a><a href="#h3-1-31" id="h3-1-31" class="d">-    }
</a><a href="#h3-1-32" id="h3-1-32" class="d">-
</a>     override fun onResumed() {
         super.onResumed()
         loadByFilter(currentFilter.value)
<a href="#h3-2" id="h3-2" class="h">@@ -156,12 +140,11 @@ class DownloadsSection : Section() {
</a>             Box(modifier = Modifier.height(100.dp)) {
                 Image(
                     painter = rememberAsyncImagePainter(
<a href="#h3-2-3" id="h3-2-3" class="d">-                        model = ImageRequest.Builder(context.androidContext)
</a><a href="#h3-2-4" id="h3-2-4" class="d">-                            .data(download.outputFile)
</a><a href="#h3-2-5" id="h3-2-5" class="d">-                            .memoryCacheKey(download.outputFile)
</a><a href="#h3-2-6" id="h3-2-6" class="d">-                            .crossfade(true)
</a><a href="#h3-2-7" id="h3-2-7" class="d">-                            .build(),
</a><a href="#h3-2-8" id="h3-2-8" class="d">-                        imageLoader = imageLoader
</a><a href="#h3-2-9" id="h3-2-9" class="i">+                        model = ImageRequestHelper.newDownloadPreviewImageRequest(
</a><a href="#h3-2-10" id="h3-2-10" class="i">+                            context.androidContext,
</a><a href="#h3-2-11" id="h3-2-11" class="i">+                            download.outputFile
</a><a href="#h3-2-12" id="h3-2-12" class="i">+                        ),
</a><a href="#h3-2-13" id="h3-2-13" class="i">+                        imageLoader = context.imageLoader
</a>                     ),
                     modifier = Modifier
                         .matchParentSize()
<a href="#h3-3" id="h3-3" class="h">@@ -187,25 +170,7 @@ class DownloadsSection : Section() {
</a>                             .padding(15.dp),
                         verticalAlignment = Alignment.CenterVertically
                     ) {
<a href="#h3-3-3" id="h3-3-3" class="d">-                        Image(
</a><a href="#h3-3-4" id="h3-3-4" class="d">-                            painter = rememberAsyncImagePainter(
</a><a href="#h3-3-5" id="h3-3-5" class="d">-                                model = ImageRequest.Builder(context.androidContext)
</a><a href="#h3-3-6" id="h3-3-6" class="d">-                                    .data(download.metadata.iconUrl)
</a><a href="#h3-3-7" id="h3-3-7" class="d">-                                    .fallback(R.drawable.bitmoji_blank)
</a><a href="#h3-3-8" id="h3-3-8" class="d">-                                    .precision(Precision.INEXACT)
</a><a href="#h3-3-9" id="h3-3-9" class="d">-                                    .crossfade(true)
</a><a href="#h3-3-10" id="h3-3-10" class="d">-                                    .memoryCacheKey(download.metadata.iconUrl)
</a><a href="#h3-3-11" id="h3-3-11" class="d">-                                    .build(),
</a><a href="#h3-3-12" id="h3-3-12" class="d">-                                imageLoader = imageLoader
</a><a href="#h3-3-13" id="h3-3-13" class="d">-                            ),
</a><a href="#h3-3-14" id="h3-3-14" class="d">-                            contentDescription = null,
</a><a href="#h3-3-15" id="h3-3-15" class="d">-                            contentScale = ContentScale.Crop,
</a><a href="#h3-3-16" id="h3-3-16" class="d">-                            modifier = Modifier
</a><a href="#h3-3-17" id="h3-3-17" class="d">-                                .requiredWidthIn(min = 0.dp, max = 48.dp)
</a><a href="#h3-3-18" id="h3-3-18" class="d">-                                .height(48.dp)
</a><a href="#h3-3-19" id="h3-3-19" class="d">-                                .clip(MaterialTheme.shapes.medium)
</a><a href="#h3-3-20" id="h3-3-20" class="d">-                        )
</a><a href="#h3-3-21" id="h3-3-21" class="d">-
</a><a href="#h3-3-22" id="h3-3-22" class="i">+                        BitmojiImage(context = context, url = download.metadata.iconUrl, size = 48)
</a>                         Column(
                             modifier = Modifier
                                 .padding(start = 10.dp),
<b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeContent.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -0,0 +1,116 @@
</a><a href="#h4-0-0" id="h4-0-0" class="i">+package me.rhunk.snapenhance.ui.manager.sections.social
</a><a href="#h4-0-1" id="h4-0-1" class="i">+
</a><a href="#h4-0-2" id="h4-0-2" class="i">+import androidx.compose.foundation.layout.Column
</a><a href="#h4-0-3" id="h4-0-3" class="i">+import androidx.compose.foundation.layout.Row
</a><a href="#h4-0-4" id="h4-0-4" class="i">+import androidx.compose.foundation.layout.Spacer
</a><a href="#h4-0-5" id="h4-0-5" class="i">+import androidx.compose.foundation.layout.height
</a><a href="#h4-0-6" id="h4-0-6" class="i">+import androidx.compose.material3.OutlinedButton
</a><a href="#h4-0-7" id="h4-0-7" class="i">+import androidx.compose.material3.Switch
</a><a href="#h4-0-8" id="h4-0-8" class="i">+import androidx.compose.material3.Text
</a><a href="#h4-0-9" id="h4-0-9" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h4-0-10" id="h4-0-10" class="i">+import androidx.compose.runtime.getValue
</a><a href="#h4-0-11" id="h4-0-11" class="i">+import androidx.compose.runtime.mutableStateOf
</a><a href="#h4-0-12" id="h4-0-12" class="i">+import androidx.compose.runtime.remember
</a><a href="#h4-0-13" id="h4-0-13" class="i">+import androidx.compose.runtime.rememberCoroutineScope
</a><a href="#h4-0-14" id="h4-0-14" class="i">+import androidx.compose.runtime.setValue
</a><a href="#h4-0-15" id="h4-0-15" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h4-0-16" id="h4-0-16" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h4-0-17" id="h4-0-17" class="i">+import androidx.navigation.NavController
</a><a href="#h4-0-18" id="h4-0-18" class="i">+import kotlinx.coroutines.launch
</a><a href="#h4-0-19" id="h4-0-19" class="i">+import me.rhunk.snapenhance.RemoteSideContext
</a><a href="#h4-0-20" id="h4-0-20" class="i">+import me.rhunk.snapenhance.core.messaging.MessagingRuleType
</a><a href="#h4-0-21" id="h4-0-21" class="i">+import me.rhunk.snapenhance.core.messaging.SocialScope
</a><a href="#h4-0-22" id="h4-0-22" class="i">+
</a><a href="#h4-0-23" id="h4-0-23" class="i">+class ScopeContent(
</a><a href="#h4-0-24" id="h4-0-24" class="i">+    private val context: RemoteSideContext,
</a><a href="#h4-0-25" id="h4-0-25" class="i">+    private val section: SocialSection,
</a><a href="#h4-0-26" id="h4-0-26" class="i">+    private val navController: NavController,
</a><a href="#h4-0-27" id="h4-0-27" class="i">+    private val scope: SocialScope,
</a><a href="#h4-0-28" id="h4-0-28" class="i">+    private val id: String
</a><a href="#h4-0-29" id="h4-0-29" class="i">+) {
</a><a href="#h4-0-30" id="h4-0-30" class="i">+
</a><a href="#h4-0-31" id="h4-0-31" class="i">+    @Composable
</a><a href="#h4-0-32" id="h4-0-32" class="i">+    private fun DeleteScopeEntityButton() {
</a><a href="#h4-0-33" id="h4-0-33" class="i">+        val coroutineScope = rememberCoroutineScope()
</a><a href="#h4-0-34" id="h4-0-34" class="i">+        OutlinedButton(onClick = {
</a><a href="#h4-0-35" id="h4-0-35" class="i">+            when (scope) {
</a><a href="#h4-0-36" id="h4-0-36" class="i">+                SocialScope.FRIEND -&gt; context.modDatabase.deleteFriend(id)
</a><a href="#h4-0-37" id="h4-0-37" class="i">+                SocialScope.GROUP -&gt; context.modDatabase.deleteGroup(id)
</a><a href="#h4-0-38" id="h4-0-38" class="i">+            }
</a><a href="#h4-0-39" id="h4-0-39" class="i">+            context.modDatabase.executeAsync {
</a><a href="#h4-0-40" id="h4-0-40" class="i">+                coroutineScope.launch {
</a><a href="#h4-0-41" id="h4-0-41" class="i">+                    section.onResumed()
</a><a href="#h4-0-42" id="h4-0-42" class="i">+                    navController.popBackStack()
</a><a href="#h4-0-43" id="h4-0-43" class="i">+                }
</a><a href="#h4-0-44" id="h4-0-44" class="i">+            }
</a><a href="#h4-0-45" id="h4-0-45" class="i">+        }) {
</a><a href="#h4-0-46" id="h4-0-46" class="i">+            Text(text = &quot;Delete ${scope.key}&quot;)
</a><a href="#h4-0-47" id="h4-0-47" class="i">+        }
</a><a href="#h4-0-48" id="h4-0-48" class="i">+    }
</a><a href="#h4-0-49" id="h4-0-49" class="i">+
</a><a href="#h4-0-50" id="h4-0-50" class="i">+    @Composable
</a><a href="#h4-0-51" id="h4-0-51" class="i">+    fun Content() {
</a><a href="#h4-0-52" id="h4-0-52" class="i">+        Column {
</a><a href="#h4-0-53" id="h4-0-53" class="i">+            when (scope) {
</a><a href="#h4-0-54" id="h4-0-54" class="i">+                SocialScope.FRIEND -&gt; Friend()
</a><a href="#h4-0-55" id="h4-0-55" class="i">+                SocialScope.GROUP -&gt; Group()
</a><a href="#h4-0-56" id="h4-0-56" class="i">+            }
</a><a href="#h4-0-57" id="h4-0-57" class="i">+
</a><a href="#h4-0-58" id="h4-0-58" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-0-59" id="h4-0-59" class="i">+
</a><a href="#h4-0-60" id="h4-0-60" class="i">+            val scopeRules = context.modDatabase.getRulesFromId(scope, id)
</a><a href="#h4-0-61" id="h4-0-61" class="i">+
</a><a href="#h4-0-62" id="h4-0-62" class="i">+            Text(text = &quot;Rules&quot;, maxLines = 1)
</a><a href="#h4-0-63" id="h4-0-63" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-0-64" id="h4-0-64" class="i">+
</a><a href="#h4-0-65" id="h4-0-65" class="i">+            //manager anti features etc
</a><a href="#h4-0-66" id="h4-0-66" class="i">+            MessagingRuleType.values().forEach { feature -&gt;
</a><a href="#h4-0-67" id="h4-0-67" class="i">+                var featureEnabled by remember {
</a><a href="#h4-0-68" id="h4-0-68" class="i">+                    mutableStateOf(scopeRules.any { it.subject == feature.key })
</a><a href="#h4-0-69" id="h4-0-69" class="i">+                }
</a><a href="#h4-0-70" id="h4-0-70" class="i">+                val featureEnabledText = if (featureEnabled) &quot;Enabled&quot; else &quot;Disabled&quot;
</a><a href="#h4-0-71" id="h4-0-71" class="i">+                Row {
</a><a href="#h4-0-72" id="h4-0-72" class="i">+                    Text(text = &quot;${feature.key}: $featureEnabledText&quot;, maxLines = 1)
</a><a href="#h4-0-73" id="h4-0-73" class="i">+                    Switch(checked = featureEnabled, onCheckedChange = {
</a><a href="#h4-0-74" id="h4-0-74" class="i">+                        context.modDatabase.toggleRuleFor(scope, id, feature.key, it)
</a><a href="#h4-0-75" id="h4-0-75" class="i">+                        featureEnabled = it
</a><a href="#h4-0-76" id="h4-0-76" class="i">+                    })
</a><a href="#h4-0-77" id="h4-0-77" class="i">+                }
</a><a href="#h4-0-78" id="h4-0-78" class="i">+            }
</a><a href="#h4-0-79" id="h4-0-79" class="i">+        }
</a><a href="#h4-0-80" id="h4-0-80" class="i">+    }
</a><a href="#h4-0-81" id="h4-0-81" class="i">+
</a><a href="#h4-0-82" id="h4-0-82" class="i">+    @Composable
</a><a href="#h4-0-83" id="h4-0-83" class="i">+    private fun Friend() {
</a><a href="#h4-0-84" id="h4-0-84" class="i">+        //fetch the friend from the database
</a><a href="#h4-0-85" id="h4-0-85" class="i">+        val friend = remember { context.modDatabase.getFriendInfo(id) } ?: run {
</a><a href="#h4-0-86" id="h4-0-86" class="i">+            Text(text = &quot;Friend not found&quot;)
</a><a href="#h4-0-87" id="h4-0-87" class="i">+            return
</a><a href="#h4-0-88" id="h4-0-88" class="i">+        }
</a><a href="#h4-0-89" id="h4-0-89" class="i">+        Column {
</a><a href="#h4-0-90" id="h4-0-90" class="i">+            Text(text = friend.displayName ?: &quot;No display name&quot;, maxLines = 1)
</a><a href="#h4-0-91" id="h4-0-91" class="i">+            Text(text = &quot;bitmojiId: ${friend.bitmojiId ?: &quot;No bitmojiId&quot;}&quot;, maxLines = 1)
</a><a href="#h4-0-92" id="h4-0-92" class="i">+            Text(text = &quot;selfieId: ${friend.selfieId ?: &quot;No selfieId&quot;}&quot;, maxLines = 1)
</a><a href="#h4-0-93" id="h4-0-93" class="i">+
</a><a href="#h4-0-94" id="h4-0-94" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-0-95" id="h4-0-95" class="i">+            DeleteScopeEntityButton()
</a><a href="#h4-0-96" id="h4-0-96" class="i">+        }
</a><a href="#h4-0-97" id="h4-0-97" class="i">+
</a><a href="#h4-0-98" id="h4-0-98" class="i">+    }
</a><a href="#h4-0-99" id="h4-0-99" class="i">+
</a><a href="#h4-0-100" id="h4-0-100" class="i">+    @Composable
</a><a href="#h4-0-101" id="h4-0-101" class="i">+    private fun Group() {
</a><a href="#h4-0-102" id="h4-0-102" class="i">+        //fetch the group from the database
</a><a href="#h4-0-103" id="h4-0-103" class="i">+        val group = remember { context.modDatabase.getGroupInfo(id) } ?: run {
</a><a href="#h4-0-104" id="h4-0-104" class="i">+            Text(text = &quot;Group not found&quot;)
</a><a href="#h4-0-105" id="h4-0-105" class="i">+            return
</a><a href="#h4-0-106" id="h4-0-106" class="i">+        }
</a><a href="#h4-0-107" id="h4-0-107" class="i">+
</a><a href="#h4-0-108" id="h4-0-108" class="i">+        Column {
</a><a href="#h4-0-109" id="h4-0-109" class="i">+            Text(text = group.name, maxLines = 1)
</a><a href="#h4-0-110" id="h4-0-110" class="i">+            Text(text = &quot;participantsCount: ${group.participantsCount}&quot;, maxLines = 1)
</a><a href="#h4-0-111" id="h4-0-111" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h4-0-112" id="h4-0-112" class="i">+            DeleteScopeEntityButton()
</a><a href="#h4-0-113" id="h4-0-113" class="i">+        }
</a><a href="#h4-0-114" id="h4-0-114" class="i">+    }
</a><a href="#h4-0-115" id="h4-0-115" class="i">+}</a><a href="#h4-0-116" id="h4-0-116" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeTab.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeTab.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeTab.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/ScopeTab.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -1,72 +0,0 @@
</a><a href="#h5-0-0" id="h5-0-0" class="d">-package me.rhunk.snapenhance.ui.manager.sections.social
</a><a href="#h5-0-1" id="h5-0-1" class="d">-
</a><a href="#h5-0-2" id="h5-0-2" class="d">-import androidx.compose.foundation.layout.Column
</a><a href="#h5-0-3" id="h5-0-3" class="d">-import androidx.compose.foundation.layout.Spacer
</a><a href="#h5-0-4" id="h5-0-4" class="d">-import androidx.compose.foundation.layout.height
</a><a href="#h5-0-5" id="h5-0-5" class="d">-import androidx.compose.material3.OutlinedButton
</a><a href="#h5-0-6" id="h5-0-6" class="d">-import androidx.compose.material3.Text
</a><a href="#h5-0-7" id="h5-0-7" class="d">-import androidx.compose.runtime.Composable
</a><a href="#h5-0-8" id="h5-0-8" class="d">-import androidx.compose.runtime.remember
</a><a href="#h5-0-9" id="h5-0-9" class="d">-import androidx.compose.ui.Modifier
</a><a href="#h5-0-10" id="h5-0-10" class="d">-import androidx.compose.ui.unit.dp
</a><a href="#h5-0-11" id="h5-0-11" class="d">-import androidx.navigation.NavController
</a><a href="#h5-0-12" id="h5-0-12" class="d">-import me.rhunk.snapenhance.RemoteSideContext
</a><a href="#h5-0-13" id="h5-0-13" class="d">-
</a><a href="#h5-0-14" id="h5-0-14" class="d">-class ScopeTab(
</a><a href="#h5-0-15" id="h5-0-15" class="d">-    private val context: RemoteSideContext,
</a><a href="#h5-0-16" id="h5-0-16" class="d">-    private val section: SocialSection,
</a><a href="#h5-0-17" id="h5-0-17" class="d">-    private val navController: NavController,
</a><a href="#h5-0-18" id="h5-0-18" class="d">-    private val id: String
</a><a href="#h5-0-19" id="h5-0-19" class="d">-) {
</a><a href="#h5-0-20" id="h5-0-20" class="d">-    @Composable
</a><a href="#h5-0-21" id="h5-0-21" class="d">-    fun Friend() {
</a><a href="#h5-0-22" id="h5-0-22" class="d">-        //fetch the friend from the database
</a><a href="#h5-0-23" id="h5-0-23" class="d">-        val friend = remember { context.modDatabase.getFriendInfo(id) } ?: run {
</a><a href="#h5-0-24" id="h5-0-24" class="d">-            Text(text = &quot;Friend not found&quot;)
</a><a href="#h5-0-25" id="h5-0-25" class="d">-            return
</a><a href="#h5-0-26" id="h5-0-26" class="d">-        }
</a><a href="#h5-0-27" id="h5-0-27" class="d">-        Column {
</a><a href="#h5-0-28" id="h5-0-28" class="d">-            Text(text = friend.displayName ?: &quot;No display name&quot;, maxLines = 1)
</a><a href="#h5-0-29" id="h5-0-29" class="d">-            Text(text = &quot;bitmojiId: ${friend.bitmojiId ?: &quot;No bitmojiId&quot;}&quot;, maxLines = 1)
</a><a href="#h5-0-30" id="h5-0-30" class="d">-            Text(text = &quot;selfieId: ${friend.selfieId ?: &quot;No selfieId&quot;}&quot;, maxLines = 1)
</a><a href="#h5-0-31" id="h5-0-31" class="d">-
</a><a href="#h5-0-32" id="h5-0-32" class="d">-            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h5-0-33" id="h5-0-33" class="d">-
</a><a href="#h5-0-34" id="h5-0-34" class="d">-            OutlinedButton(onClick = {
</a><a href="#h5-0-35" id="h5-0-35" class="d">-                context.modDatabase.deleteFriend(id)
</a><a href="#h5-0-36" id="h5-0-36" class="d">-                section.onResumed()
</a><a href="#h5-0-37" id="h5-0-37" class="d">-                navController.popBackStack()
</a><a href="#h5-0-38" id="h5-0-38" class="d">-            }) {
</a><a href="#h5-0-39" id="h5-0-39" class="d">-                Text(text = &quot;Delete friend&quot;)
</a><a href="#h5-0-40" id="h5-0-40" class="d">-            }
</a><a href="#h5-0-41" id="h5-0-41" class="d">-        }
</a><a href="#h5-0-42" id="h5-0-42" class="d">-
</a><a href="#h5-0-43" id="h5-0-43" class="d">-    }
</a><a href="#h5-0-44" id="h5-0-44" class="d">-
</a><a href="#h5-0-45" id="h5-0-45" class="d">-
</a><a href="#h5-0-46" id="h5-0-46" class="d">-    @Composable
</a><a href="#h5-0-47" id="h5-0-47" class="d">-    fun Group() {
</a><a href="#h5-0-48" id="h5-0-48" class="d">-        //fetch the group from the database
</a><a href="#h5-0-49" id="h5-0-49" class="d">-        val group = remember { context.modDatabase.getGroupInfo(id) } ?: run {
</a><a href="#h5-0-50" id="h5-0-50" class="d">-            Text(text = &quot;Group not found&quot;)
</a><a href="#h5-0-51" id="h5-0-51" class="d">-            return
</a><a href="#h5-0-52" id="h5-0-52" class="d">-        }
</a><a href="#h5-0-53" id="h5-0-53" class="d">-
</a><a href="#h5-0-54" id="h5-0-54" class="d">-        Column {
</a><a href="#h5-0-55" id="h5-0-55" class="d">-            Text(text = group.name, maxLines = 1)
</a><a href="#h5-0-56" id="h5-0-56" class="d">-            Text(text = &quot;participantsCount: ${group.participantsCount}&quot;, maxLines = 1)
</a><a href="#h5-0-57" id="h5-0-57" class="d">-
</a><a href="#h5-0-58" id="h5-0-58" class="d">-            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h5-0-59" id="h5-0-59" class="d">-
</a><a href="#h5-0-60" id="h5-0-60" class="d">-
</a><a href="#h5-0-61" id="h5-0-61" class="d">-            OutlinedButton(onClick = {
</a><a href="#h5-0-62" id="h5-0-62" class="d">-                context.modDatabase.deleteGroup(id)
</a><a href="#h5-0-63" id="h5-0-63" class="d">-                section.onResumed()
</a><a href="#h5-0-64" id="h5-0-64" class="d">-                navController.popBackStack()
</a><a href="#h5-0-65" id="h5-0-65" class="d">-            }) {
</a><a href="#h5-0-66" id="h5-0-66" class="d">-                Text(text = &quot;Delete group&quot;)
</a><a href="#h5-0-67" id="h5-0-67" class="d">-            }
</a><a href="#h5-0-68" id="h5-0-68" class="d">-        }
</a><a href="#h5-0-69" id="h5-0-69" class="d">-
</a><a href="#h5-0-70" id="h5-0-70" class="d">-    }
</a><a href="#h5-0-71" id="h5-0-71" class="d">-}</a><a href="#h5-0-72" id="h5-0-72" class="d">-
\ No newline at end of file
</a><b>diff --git a/<a id="h6" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/social/SocialSection.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -2,9 +2,9 @@ package me.rhunk.snapenhance.ui.manager.sections.social
</a> 
 import androidx.compose.foundation.ExperimentalFoundationApi
 import androidx.compose.foundation.clickable
<a href="#h6-0-3" id="h6-0-3" class="d">-import androidx.compose.foundation.gestures.Orientation
</a><a href="#h6-0-4" id="h6-0-4" class="d">-import androidx.compose.foundation.gestures.scrollable
</a> import androidx.compose.foundation.layout.Column
<a href="#h6-0-6" id="h6-0-6" class="i">+import androidx.compose.foundation.layout.Row
</a><a href="#h6-0-7" id="h6-0-7" class="i">+import androidx.compose.foundation.layout.fillMaxHeight
</a> import androidx.compose.foundation.layout.fillMaxSize
 import androidx.compose.foundation.layout.fillMaxWidth
 import androidx.compose.foundation.layout.height
<a href="#h6-1" id="h6-1" class="h">@@ -12,7 +12,6 @@ import androidx.compose.foundation.layout.padding
</a> import androidx.compose.foundation.lazy.LazyColumn
 import androidx.compose.foundation.pager.HorizontalPager
 import androidx.compose.foundation.pager.rememberPagerState
<a href="#h6-1-3" id="h6-1-3" class="d">-import androidx.compose.foundation.rememberScrollState
</a> import androidx.compose.foundation.shape.RoundedCornerShape
 import androidx.compose.material.icons.Icons
 import androidx.compose.material.icons.rounded.Add
<a href="#h6-2" id="h6-2" class="h">@@ -26,12 +25,13 @@ import androidx.compose.material3.TabRow
</a> import androidx.compose.material3.TabRowDefaults
 import androidx.compose.material3.Text
 import androidx.compose.runtime.Composable
<a href="#h6-2-3" id="h6-2-3" class="d">-import androidx.compose.runtime.LaunchedEffect
</a> import androidx.compose.runtime.getValue
<a href="#h6-2-5" id="h6-2-5" class="i">+import androidx.compose.runtime.mutableIntStateOf
</a> import androidx.compose.runtime.mutableStateOf
 import androidx.compose.runtime.remember
 import androidx.compose.runtime.rememberCoroutineScope
 import androidx.compose.runtime.setValue
<a href="#h6-2-10" id="h6-2-10" class="i">+import androidx.compose.ui.Alignment
</a> import androidx.compose.ui.Modifier
 import androidx.compose.ui.text.style.TextOverflow
 import androidx.compose.ui.unit.dp
<a href="#h6-3" id="h6-3" class="h">@@ -41,8 +41,11 @@ import androidx.navigation.navigation
</a> import kotlinx.coroutines.launch
 import me.rhunk.snapenhance.core.messaging.MessagingFriendInfo
 import me.rhunk.snapenhance.core.messaging.MessagingGroupInfo
<a href="#h6-3-3" id="h6-3-3" class="i">+import me.rhunk.snapenhance.core.messaging.SocialScope
</a> import me.rhunk.snapenhance.ui.manager.Section
<a href="#h6-3-5" id="h6-3-5" class="i">+import me.rhunk.snapenhance.ui.util.BitmojiImage
</a> import me.rhunk.snapenhance.ui.util.pagerTabIndicatorOffset
<a href="#h6-3-7" id="h6-3-7" class="i">+import me.rhunk.snapenhance.util.snap.BitmojiSelfie
</a> 
 class SocialSection : Section() {
     private lateinit var friendList: List&lt;MessagingFriendInfo&gt;
<a href="#h6-4" id="h6-4" class="h">@@ -54,7 +57,7 @@ class SocialSection : Section() {
</a>         const val GROUP_INFO_ROUTE = &quot;group_info/{id}&quot;
     }
 
<a href="#h6-4-3" id="h6-4-3" class="d">-    private var currentScopeTab: ScopeTab? = null
</a><a href="#h6-4-4" id="h6-4-4" class="i">+    private var currentScopeContent: ScopeContent? = null
</a> 
     private val addFriendDialog by lazy {
         AddFriendDialog(context, this)
<a href="#h6-5" id="h6-5" class="h">@@ -69,23 +72,96 @@ class SocialSection : Section() {
</a>     override fun canGoBack() = navController.currentBackStackEntry?.destination?.route != MAIN_ROUTE
 
     override fun build(navGraphBuilder: NavGraphBuilder) {
<a href="#h6-5-3" id="h6-5-3" class="d">-        fun switchTab(id: String) = ScopeTab(context, this, navController, id).also { tab -&gt;
</a><a href="#h6-5-4" id="h6-5-4" class="d">-            currentScopeTab = tab
</a><a href="#h6-5-5" id="h6-5-5" class="d">-        }
</a><a href="#h6-5-6" id="h6-5-6" class="d">-
</a>         navGraphBuilder.navigation(route = enumSection.route, startDestination = MAIN_ROUTE) {
             composable(MAIN_ROUTE) {
                 Content()
             }
 
<a href="#h6-5-12" id="h6-5-12" class="d">-            composable(FRIEND_INFO_ROUTE) {
</a><a href="#h6-5-13" id="h6-5-13" class="d">-                val id = it.arguments?.getString(&quot;id&quot;) ?: return@composable
</a><a href="#h6-5-14" id="h6-5-14" class="d">-                remember { switchTab(id) }.Friend()
</a><a href="#h6-5-15" id="h6-5-15" class="i">+            SocialScope.values().forEach { scope -&gt;
</a><a href="#h6-5-16" id="h6-5-16" class="i">+                composable(scope.tabRoute) {
</a><a href="#h6-5-17" id="h6-5-17" class="i">+                    val id = it.arguments?.getString(&quot;id&quot;) ?: return@composable
</a><a href="#h6-5-18" id="h6-5-18" class="i">+                    remember {
</a><a href="#h6-5-19" id="h6-5-19" class="i">+                        ScopeContent(context, this@SocialSection, navController, scope, id).also { tab -&gt;
</a><a href="#h6-5-20" id="h6-5-20" class="i">+                            currentScopeContent = tab
</a><a href="#h6-5-21" id="h6-5-21" class="i">+                        }
</a><a href="#h6-5-22" id="h6-5-22" class="i">+                    }.Content()
</a><a href="#h6-5-23" id="h6-5-23" class="i">+                }
</a>             }
<a href="#h6-5-25" id="h6-5-25" class="i">+        }
</a><a href="#h6-5-26" id="h6-5-26" class="i">+    }
</a> 
<a href="#h6-5-28" id="h6-5-28" class="d">-            composable(GROUP_INFO_ROUTE) {
</a><a href="#h6-5-29" id="h6-5-29" class="d">-                val id = it.arguments?.getString(&quot;id&quot;) ?: return@composable
</a><a href="#h6-5-30" id="h6-5-30" class="d">-                remember { switchTab(id) }.Group()
</a><a href="#h6-5-31" id="h6-5-31" class="i">+
</a><a href="#h6-5-32" id="h6-5-32" class="i">+    @Composable
</a><a href="#h6-5-33" id="h6-5-33" class="i">+    private fun ScopeList(scope: SocialScope) {
</a><a href="#h6-5-34" id="h6-5-34" class="i">+        LazyColumn(
</a><a href="#h6-5-35" id="h6-5-35" class="i">+            modifier = Modifier
</a><a href="#h6-5-36" id="h6-5-36" class="i">+                .padding(2.dp)
</a><a href="#h6-5-37" id="h6-5-37" class="i">+                .fillMaxWidth()
</a><a href="#h6-5-38" id="h6-5-38" class="i">+                .fillMaxHeight()
</a><a href="#h6-5-39" id="h6-5-39" class="i">+        ) {
</a><a href="#h6-5-40" id="h6-5-40" class="i">+            //check if scope list is empty
</a><a href="#h6-5-41" id="h6-5-41" class="i">+            val listSize = when (scope) {
</a><a href="#h6-5-42" id="h6-5-42" class="i">+                SocialScope.GROUP -&gt; groupList.size
</a><a href="#h6-5-43" id="h6-5-43" class="i">+                SocialScope.FRIEND -&gt; friendList.size
</a><a href="#h6-5-44" id="h6-5-44" class="i">+            }
</a><a href="#h6-5-45" id="h6-5-45" class="i">+
</a><a href="#h6-5-46" id="h6-5-46" class="i">+            if (listSize == 0) {
</a><a href="#h6-5-47" id="h6-5-47" class="i">+                item {
</a><a href="#h6-5-48" id="h6-5-48" class="i">+                    //TODO: i18n
</a><a href="#h6-5-49" id="h6-5-49" class="i">+                    Text(text = &quot;No ${scope.key.lowercase()}s found&quot;)
</a><a href="#h6-5-50" id="h6-5-50" class="i">+                }
</a><a href="#h6-5-51" id="h6-5-51" class="i">+            }
</a><a href="#h6-5-52" id="h6-5-52" class="i">+
</a><a href="#h6-5-53" id="h6-5-53" class="i">+            items(listSize) { index -&gt;
</a><a href="#h6-5-54" id="h6-5-54" class="i">+                val id = when (scope) {
</a><a href="#h6-5-55" id="h6-5-55" class="i">+                    SocialScope.GROUP -&gt; groupList[index].conversationId
</a><a href="#h6-5-56" id="h6-5-56" class="i">+                    SocialScope.FRIEND -&gt; friendList[index].userId
</a><a href="#h6-5-57" id="h6-5-57" class="i">+                }
</a><a href="#h6-5-58" id="h6-5-58" class="i">+
</a><a href="#h6-5-59" id="h6-5-59" class="i">+                Card(
</a><a href="#h6-5-60" id="h6-5-60" class="i">+                    modifier = Modifier
</a><a href="#h6-5-61" id="h6-5-61" class="i">+                        .padding(10.dp)
</a><a href="#h6-5-62" id="h6-5-62" class="i">+                        .fillMaxWidth()
</a><a href="#h6-5-63" id="h6-5-63" class="i">+                        .height(80.dp)
</a><a href="#h6-5-64" id="h6-5-64" class="i">+                        .clickable {
</a><a href="#h6-5-65" id="h6-5-65" class="i">+                            navController.navigate(
</a><a href="#h6-5-66" id="h6-5-66" class="i">+                                scope.tabRoute.replace(&quot;{id}&quot;, id)
</a><a href="#h6-5-67" id="h6-5-67" class="i">+                            )
</a><a href="#h6-5-68" id="h6-5-68" class="i">+                        },
</a><a href="#h6-5-69" id="h6-5-69" class="i">+                ) {
</a><a href="#h6-5-70" id="h6-5-70" class="i">+                    when (scope) {
</a><a href="#h6-5-71" id="h6-5-71" class="i">+                        SocialScope.GROUP -&gt; {
</a><a href="#h6-5-72" id="h6-5-72" class="i">+                            val group = groupList[index]
</a><a href="#h6-5-73" id="h6-5-73" class="i">+                            Column {
</a><a href="#h6-5-74" id="h6-5-74" class="i">+                                Text(text = group.name, maxLines = 1)
</a><a href="#h6-5-75" id="h6-5-75" class="i">+                                Text(text = &quot;participantsCount: ${group.participantsCount}&quot;, maxLines = 1)
</a><a href="#h6-5-76" id="h6-5-76" class="i">+                            }
</a><a href="#h6-5-77" id="h6-5-77" class="i">+                        }
</a><a href="#h6-5-78" id="h6-5-78" class="i">+                        SocialScope.FRIEND -&gt; {
</a><a href="#h6-5-79" id="h6-5-79" class="i">+                            val friend = friendList[index]
</a><a href="#h6-5-80" id="h6-5-80" class="i">+                            Row(
</a><a href="#h6-5-81" id="h6-5-81" class="i">+                                modifier = Modifier
</a><a href="#h6-5-82" id="h6-5-82" class="i">+                                    .padding(10.dp)
</a><a href="#h6-5-83" id="h6-5-83" class="i">+                                    .fillMaxSize(),
</a><a href="#h6-5-84" id="h6-5-84" class="i">+                                verticalAlignment = Alignment.CenterVertically
</a><a href="#h6-5-85" id="h6-5-85" class="i">+                            ) {
</a><a href="#h6-5-86" id="h6-5-86" class="i">+                                val bitmojiUrl = (friend.selfieId to friend.bitmojiId).let { (selfieId, bitmojiId) -&gt;
</a><a href="#h6-5-87" id="h6-5-87" class="i">+                                    if (selfieId == null || bitmojiId == null) return@let null
</a><a href="#h6-5-88" id="h6-5-88" class="i">+                                    BitmojiSelfie.getBitmojiSelfie(selfieId, bitmojiId, BitmojiSelfie.BitmojiSelfieType.STANDARD)
</a><a href="#h6-5-89" id="h6-5-89" class="i">+                                }
</a><a href="#h6-5-90" id="h6-5-90" class="i">+                                BitmojiImage(context = context, url = bitmojiUrl)
</a><a href="#h6-5-91" id="h6-5-91" class="i">+                                Column(
</a><a href="#h6-5-92" id="h6-5-92" class="i">+                                    modifier = Modifier
</a><a href="#h6-5-93" id="h6-5-93" class="i">+                                        .padding(10.dp)
</a><a href="#h6-5-94" id="h6-5-94" class="i">+                                        .fillMaxWidth()
</a><a href="#h6-5-95" id="h6-5-95" class="i">+                                ) {
</a><a href="#h6-5-96" id="h6-5-96" class="i">+                                    Text(text = friend.displayName ?: friend.mutableUsername, maxLines = 1)
</a><a href="#h6-5-97" id="h6-5-97" class="i">+                                    Text(text = friend.userId, maxLines = 1)
</a><a href="#h6-5-98" id="h6-5-98" class="i">+                                }
</a><a href="#h6-5-99" id="h6-5-99" class="i">+                            }
</a><a href="#h6-5-100" id="h6-5-100" class="i">+                        }
</a><a href="#h6-5-101" id="h6-5-101" class="i">+                    }
</a><a href="#h6-5-102" id="h6-5-102" class="i">+                }
</a>             }
         }
     }
<a href="#h6-6" id="h6-6" class="h">@@ -145,60 +221,10 @@ class SocialSection : Section() {
</a>                     }
                 }
 
<a href="#h6-6-3" id="h6-6-3" class="d">-
</a>                 HorizontalPager(modifier = Modifier.padding(paddingValues), state = pagerState) { page -&gt;
                     when (page) {
<a href="#h6-6-6" id="h6-6-6" class="d">-                        0 -&gt; {
</a><a href="#h6-6-7" id="h6-6-7" class="d">-                            LazyColumn(
</a><a href="#h6-6-8" id="h6-6-8" class="d">-                                modifier = Modifier
</a><a href="#h6-6-9" id="h6-6-9" class="d">-                                    .padding(10.dp)
</a><a href="#h6-6-10" id="h6-6-10" class="d">-                                    .fillMaxWidth()
</a><a href="#h6-6-11" id="h6-6-11" class="d">-                            ) {
</a><a href="#h6-6-12" id="h6-6-12" class="d">-                                if (friendList.isEmpty()) {
</a><a href="#h6-6-13" id="h6-6-13" class="d">-                                    item {
</a><a href="#h6-6-14" id="h6-6-14" class="d">-                                        Text(text = &quot;No friends found&quot;)
</a><a href="#h6-6-15" id="h6-6-15" class="d">-                                    }
</a><a href="#h6-6-16" id="h6-6-16" class="d">-                                }
</a><a href="#h6-6-17" id="h6-6-17" class="d">-                                items(friendList.size) { index -&gt;
</a><a href="#h6-6-18" id="h6-6-18" class="d">-                                    val friend = friendList[index]
</a><a href="#h6-6-19" id="h6-6-19" class="d">-                                    Card(
</a><a href="#h6-6-20" id="h6-6-20" class="d">-                                        modifier = Modifier
</a><a href="#h6-6-21" id="h6-6-21" class="d">-                                            .padding(10.dp)
</a><a href="#h6-6-22" id="h6-6-22" class="d">-                                            .fillMaxWidth()
</a><a href="#h6-6-23" id="h6-6-23" class="d">-                                            .height(100.dp)
</a><a href="#h6-6-24" id="h6-6-24" class="d">-                                            .clickable {
</a><a href="#h6-6-25" id="h6-6-25" class="d">-                                                navController.navigate(
</a><a href="#h6-6-26" id="h6-6-26" class="d">-                                                    FRIEND_INFO_ROUTE.replace(
</a><a href="#h6-6-27" id="h6-6-27" class="d">-                                                        &quot;{id}&quot;,
</a><a href="#h6-6-28" id="h6-6-28" class="d">-                                                        friend.userId
</a><a href="#h6-6-29" id="h6-6-29" class="d">-                                                    )
</a><a href="#h6-6-30" id="h6-6-30" class="d">-                                                )
</a><a href="#h6-6-31" id="h6-6-31" class="d">-                                            },
</a><a href="#h6-6-32" id="h6-6-32" class="d">-                                    ) {
</a><a href="#h6-6-33" id="h6-6-33" class="d">-                                        Text(text = friend.displayName ?: friend.mutableUsername)
</a><a href="#h6-6-34" id="h6-6-34" class="d">-                                    }
</a><a href="#h6-6-35" id="h6-6-35" class="d">-                                }
</a><a href="#h6-6-36" id="h6-6-36" class="d">-                            }
</a><a href="#h6-6-37" id="h6-6-37" class="d">-                        }
</a><a href="#h6-6-38" id="h6-6-38" class="d">-                        1 -&gt; {
</a><a href="#h6-6-39" id="h6-6-39" class="d">-                            Column(
</a><a href="#h6-6-40" id="h6-6-40" class="d">-                                modifier = Modifier
</a><a href="#h6-6-41" id="h6-6-41" class="d">-                                    .padding(10.dp)
</a><a href="#h6-6-42" id="h6-6-42" class="d">-                                    .fillMaxSize()
</a><a href="#h6-6-43" id="h6-6-43" class="d">-                                    .scrollable(rememberScrollState(), Orientation.Vertical)
</a><a href="#h6-6-44" id="h6-6-44" class="d">-                            ) {
</a><a href="#h6-6-45" id="h6-6-45" class="d">-                                groupList.forEach {
</a><a href="#h6-6-46" id="h6-6-46" class="d">-                                    Card(
</a><a href="#h6-6-47" id="h6-6-47" class="d">-                                        modifier = Modifier
</a><a href="#h6-6-48" id="h6-6-48" class="d">-                                            .padding(10.dp)
</a><a href="#h6-6-49" id="h6-6-49" class="d">-                                            .fillMaxWidth()
</a><a href="#h6-6-50" id="h6-6-50" class="d">-                                            .height(100.dp),
</a><a href="#h6-6-51" id="h6-6-51" class="d">-                                    ) {
</a><a href="#h6-6-52" id="h6-6-52" class="d">-                                        Text(text = it.name)
</a><a href="#h6-6-53" id="h6-6-53" class="d">-                                    }
</a><a href="#h6-6-54" id="h6-6-54" class="d">-                                }
</a><a href="#h6-6-55" id="h6-6-55" class="d">-                            }
</a><a href="#h6-6-56" id="h6-6-56" class="d">-                        }
</a><a href="#h6-6-57" id="h6-6-57" class="i">+                        0 -&gt; ScopeList(SocialScope.FRIEND)
</a><a href="#h6-6-58" id="h6-6-58" class="i">+                        1 -&gt; ScopeList(SocialScope.GROUP)
</a>                     }
                 }
             }
<b>diff --git a/<a id="h7" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/util/ComposeImageHelper.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/util/ComposeImageHelper.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/util/ComposeImageHelper.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/util/ComposeImageHelper.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -0,0 +1,53 @@
</a><a href="#h7-0-0" id="h7-0-0" class="i">+package me.rhunk.snapenhance.ui.util
</a><a href="#h7-0-1" id="h7-0-1" class="i">+
</a><a href="#h7-0-2" id="h7-0-2" class="i">+import android.content.Context
</a><a href="#h7-0-3" id="h7-0-3" class="i">+import androidx.compose.foundation.Image
</a><a href="#h7-0-4" id="h7-0-4" class="i">+import androidx.compose.foundation.layout.height
</a><a href="#h7-0-5" id="h7-0-5" class="i">+import androidx.compose.foundation.layout.requiredWidthIn
</a><a href="#h7-0-6" id="h7-0-6" class="i">+import androidx.compose.material3.MaterialTheme
</a><a href="#h7-0-7" id="h7-0-7" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h7-0-8" id="h7-0-8" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h7-0-9" id="h7-0-9" class="i">+import androidx.compose.ui.draw.clip
</a><a href="#h7-0-10" id="h7-0-10" class="i">+import androidx.compose.ui.layout.ContentScale
</a><a href="#h7-0-11" id="h7-0-11" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h7-0-12" id="h7-0-12" class="i">+import coil.compose.rememberAsyncImagePainter
</a><a href="#h7-0-13" id="h7-0-13" class="i">+import coil.request.ImageRequest
</a><a href="#h7-0-14" id="h7-0-14" class="i">+import coil.size.Precision
</a><a href="#h7-0-15" id="h7-0-15" class="i">+import me.rhunk.snapenhance.R
</a><a href="#h7-0-16" id="h7-0-16" class="i">+import me.rhunk.snapenhance.RemoteSideContext
</a><a href="#h7-0-17" id="h7-0-17" class="i">+
</a><a href="#h7-0-18" id="h7-0-18" class="i">+@Composable
</a><a href="#h7-0-19" id="h7-0-19" class="i">+fun BitmojiImage(context: RemoteSideContext, modifier: Modifier = Modifier, size: Int = 48, url: String?) {
</a><a href="#h7-0-20" id="h7-0-20" class="i">+    Image(
</a><a href="#h7-0-21" id="h7-0-21" class="i">+        painter = rememberAsyncImagePainter(
</a><a href="#h7-0-22" id="h7-0-22" class="i">+            model = ImageRequestHelper.newBitmojiImageRequest(
</a><a href="#h7-0-23" id="h7-0-23" class="i">+                context.androidContext,
</a><a href="#h7-0-24" id="h7-0-24" class="i">+                url
</a><a href="#h7-0-25" id="h7-0-25" class="i">+            ),
</a><a href="#h7-0-26" id="h7-0-26" class="i">+            imageLoader = context.imageLoader
</a><a href="#h7-0-27" id="h7-0-27" class="i">+        ),
</a><a href="#h7-0-28" id="h7-0-28" class="i">+        contentDescription = null,
</a><a href="#h7-0-29" id="h7-0-29" class="i">+        contentScale = ContentScale.Crop,
</a><a href="#h7-0-30" id="h7-0-30" class="i">+        modifier = Modifier
</a><a href="#h7-0-31" id="h7-0-31" class="i">+            .requiredWidthIn(min = 0.dp, max = size.dp)
</a><a href="#h7-0-32" id="h7-0-32" class="i">+            .height(size.dp)
</a><a href="#h7-0-33" id="h7-0-33" class="i">+            .clip(MaterialTheme.shapes.medium)
</a><a href="#h7-0-34" id="h7-0-34" class="i">+            .then(modifier)
</a><a href="#h7-0-35" id="h7-0-35" class="i">+    )
</a><a href="#h7-0-36" id="h7-0-36" class="i">+}
</a><a href="#h7-0-37" id="h7-0-37" class="i">+
</a><a href="#h7-0-38" id="h7-0-38" class="i">+object ImageRequestHelper {
</a><a href="#h7-0-39" id="h7-0-39" class="i">+    fun newBitmojiImageRequest(context: Context, url: String?) = ImageRequest.Builder(context)
</a><a href="#h7-0-40" id="h7-0-40" class="i">+        .data(url)
</a><a href="#h7-0-41" id="h7-0-41" class="i">+        .fallback(R.drawable.bitmoji_blank)
</a><a href="#h7-0-42" id="h7-0-42" class="i">+        .precision(Precision.INEXACT)
</a><a href="#h7-0-43" id="h7-0-43" class="i">+        .crossfade(true)
</a><a href="#h7-0-44" id="h7-0-44" class="i">+        .memoryCacheKey(url)
</a><a href="#h7-0-45" id="h7-0-45" class="i">+        .build()
</a><a href="#h7-0-46" id="h7-0-46" class="i">+
</a><a href="#h7-0-47" id="h7-0-47" class="i">+    fun newDownloadPreviewImageRequest(context: Context, filePath: String?) = ImageRequest.Builder(context)
</a><a href="#h7-0-48" id="h7-0-48" class="i">+        .data(filePath)
</a><a href="#h7-0-49" id="h7-0-49" class="i">+        .memoryCacheKey(filePath)
</a><a href="#h7-0-50" id="h7-0-50" class="i">+        .crossfade(true)
</a><a href="#h7-0-51" id="h7-0-51" class="i">+        .build()
</a><a href="#h7-0-52" id="h7-0-52" class="i">+}</a><a href="#h7-0-53" id="h7-0-53" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h8" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeClient.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeClient.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeClient.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/bridge/BridgeClient.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -16,7 +16,7 @@ import me.rhunk.snapenhance.bridge.types.BridgeFileType
</a> import me.rhunk.snapenhance.bridge.types.FileActionType
 import me.rhunk.snapenhance.core.BuildConfig
 import me.rhunk.snapenhance.core.messaging.MessagingRule
<a href="#h8-0-3" id="h8-0-3" class="d">-import me.rhunk.snapenhance.core.messaging.MessagingScope
</a><a href="#h8-0-4" id="h8-0-4" class="i">+import me.rhunk.snapenhance.core.messaging.SocialScope
</a> import me.rhunk.snapenhance.data.LocalePair
 import me.rhunk.snapenhance.util.SerializableDataObject
 import java.util.concurrent.CompletableFuture
<a href="#h8-1" id="h8-1" class="h">@@ -136,7 +136,7 @@ class BridgeClient(
</a> 
     fun passGroupsAndFriends(groups: List&lt;String&gt;, friends: List&lt;String&gt;) = service.passGroupsAndFriends(groups, friends)
 
<a href="#h8-1-3" id="h8-1-3" class="d">-    fun getRulesFromId(type: MessagingScope, targetUuid: String): List&lt;MessagingRule&gt; {
</a><a href="#h8-1-4" id="h8-1-4" class="i">+    fun getRulesFromId(type: SocialScope, targetUuid: String): List&lt;MessagingRule&gt; {
</a>         return service.getRules(type.name, targetUuid).map {
             SerializableDataObject.fromJson(it, MessagingRule::class.java)
         }.toList()
<b>diff --git a/<a id="h9" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/core/messaging/MessagingCoreObjects.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -8,18 +8,21 @@ enum class Mode {
</a>     WHITELIST
 }
 
<a href="#h9-0-3" id="h9-0-3" class="d">-enum class MessagingScope {
</a><a href="#h9-0-4" id="h9-0-4" class="d">-    FRIEND,
</a><a href="#h9-0-5" id="h9-0-5" class="d">-    GROUP
</a><a href="#h9-0-6" id="h9-0-6" class="i">+enum class SocialScope(
</a><a href="#h9-0-7" id="h9-0-7" class="i">+    val key: String,
</a><a href="#h9-0-8" id="h9-0-8" class="i">+    val tabRoute: String,
</a><a href="#h9-0-9" id="h9-0-9" class="i">+) {
</a><a href="#h9-0-10" id="h9-0-10" class="i">+    FRIEND(&quot;friend&quot;, &quot;friend_info/{id}&quot;),
</a><a href="#h9-0-11" id="h9-0-11" class="i">+    GROUP(&quot;group&quot;, &quot;group_info/{id}&quot;),
</a> }
 
<a href="#h9-0-14" id="h9-0-14" class="d">-enum class ConversationFeature(
</a><a href="#h9-0-15" id="h9-0-15" class="d">-    val value: String,
</a><a href="#h9-0-16" id="h9-0-16" class="d">-    val messagingScope: MessagingScope,
</a><a href="#h9-0-17" id="h9-0-17" class="i">+enum class MessagingRuleType(
</a><a href="#h9-0-18" id="h9-0-18" class="i">+    val key: String,
</a><a href="#h9-0-19" id="h9-0-19" class="i">+    val socialScope: SocialScope,
</a> ) {
<a href="#h9-0-21" id="h9-0-21" class="d">-    DOWNLOAD(&quot;download&quot;, MessagingScope.FRIEND),
</a><a href="#h9-0-22" id="h9-0-22" class="d">-    STEALTH(&quot;stealth&quot;, MessagingScope.GROUP),
</a><a href="#h9-0-23" id="h9-0-23" class="d">-    AUTO_SAVE(&quot;auto_save&quot;, MessagingScope.GROUP);
</a><a href="#h9-0-24" id="h9-0-24" class="i">+    DOWNLOAD(&quot;download&quot;, SocialScope.FRIEND),
</a><a href="#h9-0-25" id="h9-0-25" class="i">+    STEALTH(&quot;stealth&quot;, SocialScope.GROUP),
</a><a href="#h9-0-26" id="h9-0-26" class="i">+    AUTO_SAVE(&quot;auto_save&quot;, SocialScope.GROUP);
</a> }
 
 data class FriendStreaks(
<a href="#h9-1" id="h9-1" class="h">@@ -47,9 +50,8 @@ data class MessagingFriendInfo(
</a> 
 data class MessagingRule(
     val id: Int,
<a href="#h9-1-3" id="h9-1-3" class="d">-    val messagingScope: MessagingScope,
</a><a href="#h9-1-4" id="h9-1-4" class="i">+    val socialScope: SocialScope,
</a>     val targetUuid: String,
<a href="#h9-1-6" id="h9-1-6" class="d">-    val enabled: Boolean,
</a><a href="#h9-1-7" id="h9-1-7" class="d">-    val mode: Mode?,
</a><a href="#h9-1-8" id="h9-1-8" class="i">+    //val mode: Mode?,
</a>     val subject: String
 ) : SerializableDataObject() 
\ No newline at end of file
</pre>
</div>
</body>
</html>
