<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>feat(manager): SE build downloader - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/b65109447553a317ff8acb1f67dd053d1da77519.html">b65109447553a317ff8acb1f67dd053d1da77519</a>
<b>parent</b> <a href="../commit/abdb95c402c3f3b3adf94d8808ef92dbd70543a6.html">abdb95c402c3f3b3adf94d8808ef92dbd70543a6</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Mon, 23 Oct 2023 18:50:36 +0200

feat(manager): SE build downloader

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">manager/build.gradle.kts</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">manager/src/main/AndroidManifest.xml</a></td><td> | </td><td class="num">13</td><td><span class="i">+++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h2">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/SharedConfig.kt</a></td><td> | </td><td class="num">16</td><td><span class="i">++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h3">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/InstallStage.kt</a></td><td> | </td><td class="num">10</td><td><span class="i">++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h4">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEArtifact.kt</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEVersion.kt</a></td><td> | </td><td class="num">8</td><td><span class="i">++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/MainActivity.kt</a></td><td> | </td><td class="num">122</td><td><span class="i">+++++++++++++++++++++++++++</span><span class="d">----------------------------------------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h7">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Navigation.kt</a></td><td> | </td><td class="num">121</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h8">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Tab.kt</a></td><td> | </td><td class="num">50</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h9">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/HomeTab.kt</a></td><td> | </td><td class="num">140</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h10">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/SettingsTab.kt</a></td><td> | </td><td class="num">118</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/InstallAppTab.kt</a></td><td> | </td><td class="num">176</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/SEDownloadTab.kt</a></td><td> | </td><td class="num">278</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">manager/src/main/res/xml/provider_paths.xml</a></td><td> | </td><td class="num">4</td><td><span class="i">++++</span><span class="d"></span></td></tr>
</table></pre><pre>14 files changed, 989 insertions(+), 81 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/manager/build.gradle.kts.html">manager/build.gradle.kts</a> b/<a href="../file/manager/build.gradle.kts.html">manager/build.gradle.kts</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -3,6 +3,7 @@ import com.android.build.gradle.internal.api.BaseVariantOutputImpl
</a> plugins {
     alias(libs.plugins.androidApplication)
     alias(libs.plugins.kotlinAndroid)
<a href="#h0-0-3" id="h0-0-3" class="i">+    id(&quot;kotlin-parcelize&quot;)
</a> }
 
 android {
<a href="#h0-1" id="h0-1" class="h">@@ -74,6 +75,7 @@ dependencies {
</a>     implementation(libs.guava)
     implementation(libs.apksig)
     implementation(libs.gson)
<a href="#h0-1-3" id="h0-1-3" class="i">+    implementation(libs.okhttp)
</a>     implementation(libs.androidx.material3)
     implementation(libs.androidx.activity.ktx)
     implementation(libs.androidx.navigation.compose)
<b>diff --git a/<a id="h1" href="../file/manager/src/main/AndroidManifest.xml.html">manager/src/main/AndroidManifest.xml</a> b/<a href="../file/manager/src/main/AndroidManifest.xml.html">manager/src/main/AndroidManifest.xml</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -5,10 +5,13 @@
</a>     &lt;uses-permission android:name=&quot;android.permission.QUERY_ALL_PACKAGES&quot;
         tools:ignore=&quot;QueryAllPackagesPermission&quot; /&gt;
     &lt;uses-permission android:name=&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot; /&gt;
<a href="#h1-0-3" id="h1-0-3" class="i">+    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
</a>     &lt;uses-permission android:name=&quot;android.permission.REQUEST_DELETE_PACKAGES&quot; /&gt;
 
     &lt;application
         android:label=&quot;SE Manager&quot;
<a href="#h1-0-8" id="h1-0-8" class="i">+        tools:targetApi=&quot;34&quot;
</a><a href="#h1-0-9" id="h1-0-9" class="i">+        android:enableOnBackInvokedCallback=&quot;true&quot;
</a>         android:icon=&quot;@android:drawable/ic_input_add&quot;&gt;
         &lt;activity android:name=&quot;.ui.MainActivity&quot; android:exported=&quot;true&quot;&gt;
             &lt;intent-filter&gt;
<a href="#h1-1" id="h1-1" class="h">@@ -16,5 +19,15 @@
</a>                 &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
             &lt;/intent-filter&gt;
         &lt;/activity&gt;
<a href="#h1-1-3" id="h1-1-3" class="i">+
</a><a href="#h1-1-4" id="h1-1-4" class="i">+        &lt;provider
</a><a href="#h1-1-5" id="h1-1-5" class="i">+            android:name=&quot;androidx.core.content.FileProvider&quot;
</a><a href="#h1-1-6" id="h1-1-6" class="i">+            android:authorities=&quot;me.rhunk.snapenhance.manager.provider&quot;
</a><a href="#h1-1-7" id="h1-1-7" class="i">+            android:exported=&quot;false&quot;
</a><a href="#h1-1-8" id="h1-1-8" class="i">+            android:grantUriPermissions=&quot;true&quot;&gt;
</a><a href="#h1-1-9" id="h1-1-9" class="i">+            &lt;meta-data
</a><a href="#h1-1-10" id="h1-1-10" class="i">+                android:name=&quot;android.support.FILE_PROVIDER_PATHS&quot;
</a><a href="#h1-1-11" id="h1-1-11" class="i">+                android:resource=&quot;@xml/provider_paths&quot; /&gt;
</a><a href="#h1-1-12" id="h1-1-12" class="i">+        &lt;/provider&gt;
</a>     &lt;/application&gt;
 &lt;/manifest&gt; 
\ No newline at end of file
<b>diff --git a/<a id="h2" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/SharedConfig.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/SharedConfig.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/SharedConfig.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/SharedConfig.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -0,0 +1,15 @@
</a><a href="#h2-0-0" id="h2-0-0" class="i">+package me.rhunk.snapenhance.manager.data
</a><a href="#h2-0-1" id="h2-0-1" class="i">+
</a><a href="#h2-0-2" id="h2-0-2" class="i">+import android.content.Context
</a><a href="#h2-0-3" id="h2-0-3" class="i">+
</a><a href="#h2-0-4" id="h2-0-4" class="i">+class SharedConfig(
</a><a href="#h2-0-5" id="h2-0-5" class="i">+    context: Context
</a><a href="#h2-0-6" id="h2-0-6" class="i">+) {
</a><a href="#h2-0-7" id="h2-0-7" class="i">+    private val sharedPreferences = context.getSharedPreferences(&quot;snapenhance&quot;, Context.MODE_PRIVATE)
</a><a href="#h2-0-8" id="h2-0-8" class="i">+
</a><a href="#h2-0-9" id="h2-0-9" class="i">+    var snapchatPackageName get() = sharedPreferences.getString(&quot;snapchatPackageName&quot;, &quot;com.snapchat.android&quot;)?.takeIf { it.isNotEmpty() }
</a><a href="#h2-0-10" id="h2-0-10" class="i">+        set(value) = sharedPreferences.edit().putString(&quot;snapchatPackageName&quot;, value).apply()
</a><a href="#h2-0-11" id="h2-0-11" class="i">+
</a><a href="#h2-0-12" id="h2-0-12" class="i">+    var snapEnhancePackageName get() = sharedPreferences.getString(&quot;snapEnhancePackageName&quot;, &quot;me.rhunk.snapenhance&quot;)?.takeIf { it.isNotEmpty() }
</a><a href="#h2-0-13" id="h2-0-13" class="i">+        set(value) = sharedPreferences.edit().putString(&quot;snapEnhancePackageName&quot;, value).apply()
</a><a href="#h2-0-14" id="h2-0-14" class="i">+}</a><a href="#h2-0-15" id="h2-0-15" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h3" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/InstallStage.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/InstallStage.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/InstallStage.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/InstallStage.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -0,0 +1,9 @@
</a><a href="#h3-0-0" id="h3-0-0" class="i">+package me.rhunk.snapenhance.manager.data.download
</a><a href="#h3-0-1" id="h3-0-1" class="i">+
</a><a href="#h3-0-2" id="h3-0-2" class="i">+enum class InstallStage {
</a><a href="#h3-0-3" id="h3-0-3" class="i">+    DOWNLOADING,
</a><a href="#h3-0-4" id="h3-0-4" class="i">+    UNINSTALLING,
</a><a href="#h3-0-5" id="h3-0-5" class="i">+    INSTALLING,
</a><a href="#h3-0-6" id="h3-0-6" class="i">+    DONE,
</a><a href="#h3-0-7" id="h3-0-7" class="i">+    ERROR;
</a><a href="#h3-0-8" id="h3-0-8" class="i">+}</a><a href="#h3-0-9" id="h3-0-9" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h4" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEArtifact.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEArtifact.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEArtifact.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEArtifact.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h4-0-0" id="h4-0-0" class="i">+package me.rhunk.snapenhance.manager.data.download
</a><a href="#h4-0-1" id="h4-0-1" class="i">+
</a><a href="#h4-0-2" id="h4-0-2" class="i">+import android.os.Parcelable
</a><a href="#h4-0-3" id="h4-0-3" class="i">+import kotlinx.parcelize.Parcelize
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a><a href="#h4-0-5" id="h4-0-5" class="i">+@Parcelize
</a><a href="#h4-0-6" id="h4-0-6" class="i">+class SEArtifact(
</a><a href="#h4-0-7" id="h4-0-7" class="i">+    val fileName: String,
</a><a href="#h4-0-8" id="h4-0-8" class="i">+    val size: Long,
</a><a href="#h4-0-9" id="h4-0-9" class="i">+    val downloadUrl: String,
</a><a href="#h4-0-10" id="h4-0-10" class="i">+) : Parcelable</a><a href="#h4-0-11" id="h4-0-11" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h5" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEVersion.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEVersion.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEVersion.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/data/download/SEVersion.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,7 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+package me.rhunk.snapenhance.manager.data.download
</a><a href="#h5-0-1" id="h5-0-1" class="i">+
</a><a href="#h5-0-2" id="h5-0-2" class="i">+data class SEVersion(
</a><a href="#h5-0-3" id="h5-0-3" class="i">+    val versionName: String,
</a><a href="#h5-0-4" id="h5-0-4" class="i">+    val releaseDate: String,
</a><a href="#h5-0-5" id="h5-0-5" class="i">+    val downloadAssets: Map&lt;String, SEArtifact&gt;,
</a><a href="#h5-0-6" id="h5-0-6" class="i">+)</a><a href="#h5-0-7" id="h5-0-7" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h6" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/MainActivity.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/MainActivity.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/MainActivity.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/MainActivity.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -4,106 +4,66 @@ import android.os.Build
</a> import android.os.Bundle
 import androidx.activity.ComponentActivity
 import androidx.activity.compose.setContent
<a href="#h6-0-3" id="h6-0-3" class="d">-import androidx.compose.foundation.border
</a> import androidx.compose.foundation.isSystemInDarkTheme
<a href="#h6-0-5" id="h6-0-5" class="d">-import androidx.compose.foundation.layout.Arrangement
</a><a href="#h6-0-6" id="h6-0-6" class="d">-import androidx.compose.foundation.layout.Column
</a><a href="#h6-0-7" id="h6-0-7" class="d">-import androidx.compose.foundation.layout.fillMaxWidth
</a><a href="#h6-0-8" id="h6-0-8" class="d">-import androidx.compose.foundation.layout.height
</a><a href="#h6-0-9" id="h6-0-9" class="d">-import androidx.compose.foundation.layout.padding
</a><a href="#h6-0-10" id="h6-0-10" class="d">-import androidx.compose.foundation.lazy.LazyColumn
</a><a href="#h6-0-11" id="h6-0-11" class="d">-import androidx.compose.foundation.lazy.items
</a><a href="#h6-0-12" id="h6-0-12" class="d">-import androidx.compose.foundation.lazy.rememberLazyListState
</a><a href="#h6-0-13" id="h6-0-13" class="d">-import androidx.compose.material3.Button
</a><a href="#h6-0-14" id="h6-0-14" class="d">-import androidx.compose.material3.MaterialTheme
</a><a href="#h6-0-15" id="h6-0-15" class="d">-import androidx.compose.material3.Text
</a><a href="#h6-0-16" id="h6-0-16" class="d">-import androidx.compose.material3.dynamicDarkColorScheme
</a><a href="#h6-0-17" id="h6-0-17" class="d">-import androidx.compose.material3.dynamicLightColorScheme
</a><a href="#h6-0-18" id="h6-0-18" class="d">-import androidx.compose.runtime.LaunchedEffect
</a><a href="#h6-0-19" id="h6-0-19" class="d">-import androidx.compose.runtime.mutableStateListOf
</a><a href="#h6-0-20" id="h6-0-20" class="i">+import androidx.compose.material3.*
</a> import androidx.compose.runtime.remember
<a href="#h6-0-22" id="h6-0-22" class="d">-import androidx.compose.runtime.rememberCoroutineScope
</a><a href="#h6-0-23" id="h6-0-23" class="d">-import androidx.compose.ui.Alignment
</a><a href="#h6-0-24" id="h6-0-24" class="d">-import androidx.compose.ui.Modifier
</a><a href="#h6-0-25" id="h6-0-25" class="d">-import androidx.compose.ui.graphics.Color
</a> import androidx.compose.ui.platform.LocalContext
<a href="#h6-0-27" id="h6-0-27" class="d">-import androidx.compose.ui.unit.dp
</a><a href="#h6-0-28" id="h6-0-28" class="d">-import kotlinx.coroutines.Dispatchers
</a><a href="#h6-0-29" id="h6-0-29" class="d">-import kotlinx.coroutines.launch
</a><a href="#h6-0-30" id="h6-0-30" class="d">-import me.rhunk.snapenhance.manager.BuildConfig
</a><a href="#h6-0-31" id="h6-0-31" class="d">-import me.rhunk.snapenhance.manager.lspatch.LSPatch
</a><a href="#h6-0-32" id="h6-0-32" class="d">-import java.io.File
</a><a href="#h6-0-33" id="h6-0-33" class="d">-import java.io.PrintWriter
</a><a href="#h6-0-34" id="h6-0-34" class="d">-import java.io.StringWriter
</a><a href="#h6-0-35" id="h6-0-35" class="i">+import androidx.navigation.compose.rememberNavController
</a><a href="#h6-0-36" id="h6-0-36" class="i">+import me.rhunk.snapenhance.manager.data.SharedConfig
</a><a href="#h6-0-37" id="h6-0-37" class="i">+import me.rhunk.snapenhance.manager.ui.tab.HomeTab
</a><a href="#h6-0-38" id="h6-0-38" class="i">+import me.rhunk.snapenhance.manager.ui.tab.SettingsTab
</a> 
 class MainActivity : ComponentActivity() {
<a href="#h6-0-41" id="h6-0-41" class="i">+    companion object{
</a><a href="#h6-0-42" id="h6-0-42" class="i">+        private val primaryTabs = listOf(HomeTab::class, SettingsTab::class)
</a><a href="#h6-0-43" id="h6-0-43" class="i">+    }
</a><a href="#h6-0-44" id="h6-0-44" class="i">+
</a>     override fun onCreate(savedInstanceState: Bundle?) {
         super.onCreate(savedInstanceState)
 
<a href="#h6-0-48" id="h6-0-48" class="i">+        val tabs = primaryTabs.mapNotNull {
</a><a href="#h6-0-49" id="h6-0-49" class="i">+            runCatching { it.java.constructors.first().newInstance() as Tab }.getOrNull()
</a><a href="#h6-0-50" id="h6-0-50" class="i">+        }.toMutableList().apply {
</a><a href="#h6-0-51" id="h6-0-51" class="i">+            forEach { it.init(this@MainActivity) }
</a><a href="#h6-0-52" id="h6-0-52" class="i">+            fun addNestedTabsRecursively(tabs: List&lt;Tab&gt;) {
</a><a href="#h6-0-53" id="h6-0-53" class="i">+                tabs.forEach { tab -&gt;
</a><a href="#h6-0-54" id="h6-0-54" class="i">+                    add(tab)
</a><a href="#h6-0-55" id="h6-0-55" class="i">+                    addNestedTabsRecursively(tab.nestedTabs)
</a><a href="#h6-0-56" id="h6-0-56" class="i">+                }
</a><a href="#h6-0-57" id="h6-0-57" class="i">+            }
</a><a href="#h6-0-58" id="h6-0-58" class="i">+            toList().forEach { addNestedTabsRecursively(it.nestedTabs) }
</a><a href="#h6-0-59" id="h6-0-59" class="i">+        }
</a>         setContent {
<a href="#h6-0-61" id="h6-0-61" class="d">-            val coroutineScope = rememberCoroutineScope()
</a>             MaterialTheme(
                 colorScheme = if (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.S) {
                     if (isSystemInDarkTheme()) dynamicDarkColorScheme(LocalContext.current)
                     else dynamicLightColorScheme(LocalContext.current)
<a href="#h6-0-66" id="h6-0-66" class="d">-                } else MaterialTheme.colorScheme
</a><a href="#h6-0-67" id="h6-0-67" class="i">+                } else darkColorScheme()
</a>             ) {
<a href="#h6-0-69" id="h6-0-69" class="d">-                val context = LocalContext.current
</a><a href="#h6-0-70" id="h6-0-70" class="d">-                val logs = remember { mutableStateListOf&lt;String&gt;() }
</a><a href="#h6-0-71" id="h6-0-71" class="d">-                fun printLog(data: Any) {
</a><a href="#h6-0-72" id="h6-0-72" class="d">-                    when (data) {
</a><a href="#h6-0-73" id="h6-0-73" class="d">-                        is Throwable -&gt; {
</a><a href="#h6-0-74" id="h6-0-74" class="d">-                            logs += data.message.toString()
</a><a href="#h6-0-75" id="h6-0-75" class="d">-                            logs += StringWriter().apply {
</a><a href="#h6-0-76" id="h6-0-76" class="d">-                                data.printStackTrace(PrintWriter(this))
</a><a href="#h6-0-77" id="h6-0-77" class="d">-                            }.toString()
</a><a href="#h6-0-78" id="h6-0-78" class="d">-                        }
</a><a href="#h6-0-79" id="h6-0-79" class="d">-                        else -&gt; logs += data.toString()
</a><a href="#h6-0-80" id="h6-0-80" class="d">-                    }
</a><a href="#h6-0-81" id="h6-0-81" class="d">-                }
</a><a href="#h6-0-82" id="h6-0-82" class="i">+                val navHostController = rememberNavController()
</a><a href="#h6-0-83" id="h6-0-83" class="i">+                val sharedConfig = remember { SharedConfig(this) }
</a> 
<a href="#h6-0-85" id="h6-0-85" class="d">-                val scrollState = rememberLazyListState(0)
</a> 
<a href="#h6-0-87" id="h6-0-87" class="d">-                Column(
</a><a href="#h6-0-88" id="h6-0-88" class="d">-                    horizontalAlignment = Alignment.CenterHorizontally,
</a><a href="#h6-0-89" id="h6-0-89" class="d">-                    verticalArrangement = Arrangement.spacedBy(20.dp),
</a><a href="#h6-0-90" id="h6-0-90" class="d">-                    modifier = Modifier.padding(10.dp)
</a><a href="#h6-0-91" id="h6-0-91" class="d">-                ) {
</a><a href="#h6-0-92" id="h6-0-92" class="d">-                    Text(text = &quot;SE Manager&quot;)
</a><a href="#h6-0-93" id="h6-0-93" class="d">-
</a><a href="#h6-0-94" id="h6-0-94" class="d">-                    Button(onClick = {
</a><a href="#h6-0-95" id="h6-0-95" class="d">-                        coroutineScope.launch(Dispatchers.IO) {
</a><a href="#h6-0-96" id="h6-0-96" class="d">-                            runCatching {
</a><a href="#h6-0-97" id="h6-0-97" class="d">-                                val lspatch = LSPatch(
</a><a href="#h6-0-98" id="h6-0-98" class="d">-                                    context,
</a><a href="#h6-0-99" id="h6-0-99" class="d">-                                    mapOf(
</a><a href="#h6-0-100" id="h6-0-100" class="d">-                                        BuildConfig.APPLICATION_ID to File(context.packageManager.getPackageInfo(
</a><a href="#h6-0-101" id="h6-0-101" class="d">-                                            BuildConfig.APPLICATION_ID, 0).applicationInfo.sourceDir)
</a><a href="#h6-0-102" id="h6-0-102" class="d">-                                    )
</a><a href="#h6-0-103" id="h6-0-103" class="d">-                                ) { printLog(it) }
</a><a href="#h6-0-104" id="h6-0-104" class="d">-                                lspatch.patch(
</a><a href="#h6-0-105" id="h6-0-105" class="d">-                                    File(context.packageManager.getPackageInfo(&quot;com.snapchat.android&quot;, 0).applicationInfo.sourceDir),
</a><a href="#h6-0-106" id="h6-0-106" class="d">-                                    File(context.filesDir, &quot;patched.apk&quot;)
</a><a href="#h6-0-107" id="h6-0-107" class="d">-                                )
</a><a href="#h6-0-108" id="h6-0-108" class="d">-                            }.onFailure { printLog(it) }
</a><a href="#h6-0-109" id="h6-0-109" class="i">+                val navigation = remember {
</a><a href="#h6-0-110" id="h6-0-110" class="i">+                    Navigation(
</a><a href="#h6-0-111" id="h6-0-111" class="i">+                        navHostController = navHostController,
</a><a href="#h6-0-112" id="h6-0-112" class="i">+                        tabs = tabs,
</a><a href="#h6-0-113" id="h6-0-113" class="i">+                        defaultTab = HomeTab::class
</a><a href="#h6-0-114" id="h6-0-114" class="i">+                    ).also {
</a><a href="#h6-0-115" id="h6-0-115" class="i">+                        tabs.forEach { tab -&gt;
</a><a href="#h6-0-116" id="h6-0-116" class="i">+                            tab.navigation = it
</a><a href="#h6-0-117" id="h6-0-117" class="i">+                            tab.sharedConfig = sharedConfig
</a>                         }
<a href="#h6-0-119" id="h6-0-119" class="d">-                    }) {
</a><a href="#h6-0-120" id="h6-0-120" class="d">-                        Text(text = &quot;Test patch apk&quot;)
</a>                     }
<a href="#h6-0-122" id="h6-0-122" class="i">+                }
</a> 
<a href="#h6-0-124" id="h6-0-124" class="d">-                    LazyColumn(
</a><a href="#h6-0-125" id="h6-0-125" class="d">-                        state = scrollState,
</a><a href="#h6-0-126" id="h6-0-126" class="d">-                        modifier = Modifier.fillMaxWidth().padding(5.dp).height(500.dp).border(1.dp, color = Color.Black),
</a><a href="#h6-0-127" id="h6-0-127" class="d">-                        content = {
</a><a href="#h6-0-128" id="h6-0-128" class="d">-                            items(logs) {
</a><a href="#h6-0-129" id="h6-0-129" class="d">-                                Text(text = it, modifier = Modifier.padding(2.dp))
</a><a href="#h6-0-130" id="h6-0-130" class="d">-                            }
</a><a href="#h6-0-131" id="h6-0-131" class="d">-                        }
</a><a href="#h6-0-132" id="h6-0-132" class="d">-                    )
</a><a href="#h6-0-133" id="h6-0-133" class="d">-
</a><a href="#h6-0-134" id="h6-0-134" class="d">-                    LaunchedEffect(logs.size) {
</a><a href="#h6-0-135" id="h6-0-135" class="d">-                        scrollState.scrollToItem((logs.size - 1).coerceAtLeast(0))
</a><a href="#h6-0-136" id="h6-0-136" class="d">-                    }
</a><a href="#h6-0-137" id="h6-0-137" class="i">+                Scaffold(
</a><a href="#h6-0-138" id="h6-0-138" class="i">+                    bottomBar = { navigation.BottomBar() },
</a><a href="#h6-0-139" id="h6-0-139" class="i">+                    topBar = { navigation.TopBar() },
</a><a href="#h6-0-140" id="h6-0-140" class="i">+                    floatingActionButton = { navigation.FloatingActionButtons() },
</a><a href="#h6-0-141" id="h6-0-141" class="i">+                    floatingActionButtonPosition = FabPosition.End,
</a><a href="#h6-0-142" id="h6-0-142" class="i">+                ) {
</a><a href="#h6-0-143" id="h6-0-143" class="i">+                    navigation.NavigationHost(it)
</a>                 }
             }
         }
<b>diff --git a/<a id="h7" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Navigation.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Navigation.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Navigation.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Navigation.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -0,0 +1,120 @@
</a><a href="#h7-0-0" id="h7-0-0" class="i">+package me.rhunk.snapenhance.manager.ui
</a><a href="#h7-0-1" id="h7-0-1" class="i">+
</a><a href="#h7-0-2" id="h7-0-2" class="i">+import android.os.Bundle
</a><a href="#h7-0-3" id="h7-0-3" class="i">+import androidx.compose.animation.core.tween
</a><a href="#h7-0-4" id="h7-0-4" class="i">+import androidx.compose.animation.fadeIn
</a><a href="#h7-0-5" id="h7-0-5" class="i">+import androidx.compose.animation.fadeOut
</a><a href="#h7-0-6" id="h7-0-6" class="i">+import androidx.compose.foundation.layout.PaddingValues
</a><a href="#h7-0-7" id="h7-0-7" class="i">+import androidx.compose.foundation.layout.fillMaxHeight
</a><a href="#h7-0-8" id="h7-0-8" class="i">+import androidx.compose.foundation.layout.padding
</a><a href="#h7-0-9" id="h7-0-9" class="i">+import androidx.compose.foundation.layout.wrapContentWidth
</a><a href="#h7-0-10" id="h7-0-10" class="i">+import androidx.compose.material3.Icon
</a><a href="#h7-0-11" id="h7-0-11" class="i">+import androidx.compose.material3.NavigationBar
</a><a href="#h7-0-12" id="h7-0-12" class="i">+import androidx.compose.material3.NavigationBarItem
</a><a href="#h7-0-13" id="h7-0-13" class="i">+import androidx.compose.material3.Text
</a><a href="#h7-0-14" id="h7-0-14" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h7-0-15" id="h7-0-15" class="i">+import androidx.compose.runtime.getValue
</a><a href="#h7-0-16" id="h7-0-16" class="i">+import androidx.compose.runtime.remember
</a><a href="#h7-0-17" id="h7-0-17" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h7-0-18" id="h7-0-18" class="i">+import androidx.compose.ui.text.style.TextAlign
</a><a href="#h7-0-19" id="h7-0-19" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h7-0-20" id="h7-0-20" class="i">+import androidx.navigation.NavDestination.Companion.hierarchy
</a><a href="#h7-0-21" id="h7-0-21" class="i">+import androidx.navigation.NavGraph.Companion.findStartDestination
</a><a href="#h7-0-22" id="h7-0-22" class="i">+import androidx.navigation.NavHostController
</a><a href="#h7-0-23" id="h7-0-23" class="i">+import androidx.navigation.compose.NavHost
</a><a href="#h7-0-24" id="h7-0-24" class="i">+import androidx.navigation.compose.currentBackStackEntryAsState
</a><a href="#h7-0-25" id="h7-0-25" class="i">+import kotlin.reflect.KClass
</a><a href="#h7-0-26" id="h7-0-26" class="i">+
</a><a href="#h7-0-27" id="h7-0-27" class="i">+
</a><a href="#h7-0-28" id="h7-0-28" class="i">+class Navigation(
</a><a href="#h7-0-29" id="h7-0-29" class="i">+    val navHostController: NavHostController,
</a><a href="#h7-0-30" id="h7-0-30" class="i">+    private val tabs: List&lt;Tab&gt;,
</a><a href="#h7-0-31" id="h7-0-31" class="i">+    private val defaultTab: KClass&lt;out Tab&gt;
</a><a href="#h7-0-32" id="h7-0-32" class="i">+) {
</a><a href="#h7-0-33" id="h7-0-33" class="i">+
</a><a href="#h7-0-34" id="h7-0-34" class="i">+    @Composable
</a><a href="#h7-0-35" id="h7-0-35" class="i">+    fun TopBar() {
</a><a href="#h7-0-36" id="h7-0-36" class="i">+
</a><a href="#h7-0-37" id="h7-0-37" class="i">+    }
</a><a href="#h7-0-38" id="h7-0-38" class="i">+
</a><a href="#h7-0-39" id="h7-0-39" class="i">+    @Composable
</a><a href="#h7-0-40" id="h7-0-40" class="i">+    fun FloatingActionButtons() {
</a><a href="#h7-0-41" id="h7-0-41" class="i">+
</a><a href="#h7-0-42" id="h7-0-42" class="i">+    }
</a><a href="#h7-0-43" id="h7-0-43" class="i">+
</a><a href="#h7-0-44" id="h7-0-44" class="i">+    fun navigateTo(tab: KClass&lt;out Tab&gt;) {
</a><a href="#h7-0-45" id="h7-0-45" class="i">+        navHostController.navigate(tabs.first { it::class == tab }.route)
</a><a href="#h7-0-46" id="h7-0-46" class="i">+    }
</a><a href="#h7-0-47" id="h7-0-47" class="i">+
</a><a href="#h7-0-48" id="h7-0-48" class="i">+    fun navigateTo(tab: KClass&lt;out Tab&gt;, noHistory: Boolean) {
</a><a href="#h7-0-49" id="h7-0-49" class="i">+        navHostController.navigate(tabs.first { it::class == tab }.route) {
</a><a href="#h7-0-50" id="h7-0-50" class="i">+            restoreState = false
</a><a href="#h7-0-51" id="h7-0-51" class="i">+            launchSingleTop = true
</a><a href="#h7-0-52" id="h7-0-52" class="i">+            popUpTo(navHostController.graph.findStartDestination().id) {
</a><a href="#h7-0-53" id="h7-0-53" class="i">+                saveState = true
</a><a href="#h7-0-54" id="h7-0-54" class="i">+            }
</a><a href="#h7-0-55" id="h7-0-55" class="i">+        }
</a><a href="#h7-0-56" id="h7-0-56" class="i">+    }
</a><a href="#h7-0-57" id="h7-0-57" class="i">+
</a><a href="#h7-0-58" id="h7-0-58" class="i">+    fun navigateTo(tab: KClass&lt;out Tab&gt;, args: Bundle) {
</a><a href="#h7-0-59" id="h7-0-59" class="i">+        navHostController.currentBackStackEntry?.savedStateHandle?.apply {
</a><a href="#h7-0-60" id="h7-0-60" class="i">+            set(&quot;args&quot;, args)
</a><a href="#h7-0-61" id="h7-0-61" class="i">+        }
</a><a href="#h7-0-62" id="h7-0-62" class="i">+        navigateTo(tab)
</a><a href="#h7-0-63" id="h7-0-63" class="i">+    }
</a><a href="#h7-0-64" id="h7-0-64" class="i">+
</a><a href="#h7-0-65" id="h7-0-65" class="i">+    @Composable
</a><a href="#h7-0-66" id="h7-0-66" class="i">+    fun NavigationHost(
</a><a href="#h7-0-67" id="h7-0-67" class="i">+        innerPadding: PaddingValues
</a><a href="#h7-0-68" id="h7-0-68" class="i">+    ) {
</a><a href="#h7-0-69" id="h7-0-69" class="i">+        NavHost(
</a><a href="#h7-0-70" id="h7-0-70" class="i">+            navHostController,
</a><a href="#h7-0-71" id="h7-0-71" class="i">+            startDestination = tabs.first { it::class == defaultTab }.route,
</a><a href="#h7-0-72" id="h7-0-72" class="i">+            Modifier.padding(innerPadding),
</a><a href="#h7-0-73" id="h7-0-73" class="i">+            enterTransition = { fadeIn(tween(200)) },
</a><a href="#h7-0-74" id="h7-0-74" class="i">+            exitTransition = { fadeOut(tween(200)) }
</a><a href="#h7-0-75" id="h7-0-75" class="i">+        ) {
</a><a href="#h7-0-76" id="h7-0-76" class="i">+            tabs.forEach { tab -&gt;
</a><a href="#h7-0-77" id="h7-0-77" class="i">+                tab.build(this)
</a><a href="#h7-0-78" id="h7-0-78" class="i">+            }
</a><a href="#h7-0-79" id="h7-0-79" class="i">+        }
</a><a href="#h7-0-80" id="h7-0-80" class="i">+    }
</a><a href="#h7-0-81" id="h7-0-81" class="i">+
</a><a href="#h7-0-82" id="h7-0-82" class="i">+
</a><a href="#h7-0-83" id="h7-0-83" class="i">+    @Composable
</a><a href="#h7-0-84" id="h7-0-84" class="i">+    fun BottomBar() {
</a><a href="#h7-0-85" id="h7-0-85" class="i">+        NavigationBar {
</a><a href="#h7-0-86" id="h7-0-86" class="i">+            val navBackStackEntry by navHostController.currentBackStackEntryAsState()
</a><a href="#h7-0-87" id="h7-0-87" class="i">+
</a><a href="#h7-0-88" id="h7-0-88" class="i">+            remember { tabs.filter { it.isPrimary } }.forEach { tab -&gt;
</a><a href="#h7-0-89" id="h7-0-89" class="i">+                val tabSubRoutes = remember { tab.nestedTabs.map { it.route } }
</a><a href="#h7-0-90" id="h7-0-90" class="i">+                NavigationBarItem(
</a><a href="#h7-0-91" id="h7-0-91" class="i">+                    selected = navBackStackEntry?.destination?.hierarchy?.any { it.route == tab.route || tabSubRoutes.contains(it.route) } == true,
</a><a href="#h7-0-92" id="h7-0-92" class="i">+                    alwaysShowLabel = false,
</a><a href="#h7-0-93" id="h7-0-93" class="i">+                    modifier = Modifier.fillMaxHeight(),
</a><a href="#h7-0-94" id="h7-0-94" class="i">+                    icon = {
</a><a href="#h7-0-95" id="h7-0-95" class="i">+                        Icon(imageVector = tab.icon!!, contentDescription = null)
</a><a href="#h7-0-96" id="h7-0-96" class="i">+                    },
</a><a href="#h7-0-97" id="h7-0-97" class="i">+                    label = {
</a><a href="#h7-0-98" id="h7-0-98" class="i">+                        Text(
</a><a href="#h7-0-99" id="h7-0-99" class="i">+                            textAlign = TextAlign.Center,
</a><a href="#h7-0-100" id="h7-0-100" class="i">+                            softWrap = false,
</a><a href="#h7-0-101" id="h7-0-101" class="i">+                            fontSize = 12.sp,
</a><a href="#h7-0-102" id="h7-0-102" class="i">+                            modifier = Modifier.wrapContentWidth(unbounded = true),
</a><a href="#h7-0-103" id="h7-0-103" class="i">+                            text = tab.route
</a><a href="#h7-0-104" id="h7-0-104" class="i">+                        )
</a><a href="#h7-0-105" id="h7-0-105" class="i">+                    },
</a><a href="#h7-0-106" id="h7-0-106" class="i">+                    onClick = {
</a><a href="#h7-0-107" id="h7-0-107" class="i">+                        navHostController.navigate(tab.route) {
</a><a href="#h7-0-108" id="h7-0-108" class="i">+                            popUpTo(navHostController.graph.findStartDestination().id) {
</a><a href="#h7-0-109" id="h7-0-109" class="i">+                                saveState = true
</a><a href="#h7-0-110" id="h7-0-110" class="i">+                            }
</a><a href="#h7-0-111" id="h7-0-111" class="i">+                            launchSingleTop = true
</a><a href="#h7-0-112" id="h7-0-112" class="i">+                            restoreState = true
</a><a href="#h7-0-113" id="h7-0-113" class="i">+                        }
</a><a href="#h7-0-114" id="h7-0-114" class="i">+                    }
</a><a href="#h7-0-115" id="h7-0-115" class="i">+                )
</a><a href="#h7-0-116" id="h7-0-116" class="i">+            }
</a><a href="#h7-0-117" id="h7-0-117" class="i">+        }
</a><a href="#h7-0-118" id="h7-0-118" class="i">+    }
</a><a href="#h7-0-119" id="h7-0-119" class="i">+}</a><a href="#h7-0-120" id="h7-0-120" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h8" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Tab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Tab.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Tab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/Tab.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -0,0 +1,49 @@
</a><a href="#h8-0-0" id="h8-0-0" class="i">+package me.rhunk.snapenhance.manager.ui
</a><a href="#h8-0-1" id="h8-0-1" class="i">+
</a><a href="#h8-0-2" id="h8-0-2" class="i">+import android.os.Bundle
</a><a href="#h8-0-3" id="h8-0-3" class="i">+import androidx.activity.ComponentActivity
</a><a href="#h8-0-4" id="h8-0-4" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h8-0-5" id="h8-0-5" class="i">+import androidx.compose.ui.graphics.vector.ImageVector
</a><a href="#h8-0-6" id="h8-0-6" class="i">+import androidx.navigation.NavGraphBuilder
</a><a href="#h8-0-7" id="h8-0-7" class="i">+import androidx.navigation.compose.composable
</a><a href="#h8-0-8" id="h8-0-8" class="i">+import me.rhunk.snapenhance.manager.data.SharedConfig
</a><a href="#h8-0-9" id="h8-0-9" class="i">+import kotlin.reflect.KClass
</a><a href="#h8-0-10" id="h8-0-10" class="i">+
</a><a href="#h8-0-11" id="h8-0-11" class="i">+open class Tab(
</a><a href="#h8-0-12" id="h8-0-12" class="i">+    val route: String,
</a><a href="#h8-0-13" id="h8-0-13" class="i">+    val isPrimary: Boolean = false,
</a><a href="#h8-0-14" id="h8-0-14" class="i">+    val icon: ImageVector? = null,
</a><a href="#h8-0-15" id="h8-0-15" class="i">+) {
</a><a href="#h8-0-16" id="h8-0-16" class="i">+    lateinit var activity: ComponentActivity
</a><a href="#h8-0-17" id="h8-0-17" class="i">+    val nestedTabs = mutableListOf&lt;Tab&gt;()
</a><a href="#h8-0-18" id="h8-0-18" class="i">+
</a><a href="#h8-0-19" id="h8-0-19" class="i">+    fun getNestedTab(tab: KClass&lt;out Tab&gt;) = nestedTabs.firstOrNull { it::class == tab }
</a><a href="#h8-0-20" id="h8-0-20" class="i">+
</a><a href="#h8-0-21" id="h8-0-21" class="i">+    fun registerNestedTab(tab: KClass&lt;out Tab&gt;) = nestedTabs.add((tab.java.constructors.first().newInstance() as Tab).also {
</a><a href="#h8-0-22" id="h8-0-22" class="i">+        it.init(activity)
</a><a href="#h8-0-23" id="h8-0-23" class="i">+    })
</a><a href="#h8-0-24" id="h8-0-24" class="i">+
</a><a href="#h8-0-25" id="h8-0-25" class="i">+    lateinit var navigation: Navigation
</a><a href="#h8-0-26" id="h8-0-26" class="i">+    lateinit var sharedConfig: SharedConfig
</a><a href="#h8-0-27" id="h8-0-27" class="i">+
</a><a href="#h8-0-28" id="h8-0-28" class="i">+    fun getArguments() = navigation.navHostController.previousBackStackEntry?.savedStateHandle?.get&lt;Bundle&gt;(&quot;args&quot;)
</a><a href="#h8-0-29" id="h8-0-29" class="i">+
</a><a href="#h8-0-30" id="h8-0-30" class="i">+    open fun init(activity: ComponentActivity) {
</a><a href="#h8-0-31" id="h8-0-31" class="i">+        this.activity = activity
</a><a href="#h8-0-32" id="h8-0-32" class="i">+    }
</a><a href="#h8-0-33" id="h8-0-33" class="i">+
</a><a href="#h8-0-34" id="h8-0-34" class="i">+    open fun build(navGraphBuilder: NavGraphBuilder) {
</a><a href="#h8-0-35" id="h8-0-35" class="i">+        navGraphBuilder.composable(route) {
</a><a href="#h8-0-36" id="h8-0-36" class="i">+            Content()
</a><a href="#h8-0-37" id="h8-0-37" class="i">+        }
</a><a href="#h8-0-38" id="h8-0-38" class="i">+    }
</a><a href="#h8-0-39" id="h8-0-39" class="i">+
</a><a href="#h8-0-40" id="h8-0-40" class="i">+    @Composable
</a><a href="#h8-0-41" id="h8-0-41" class="i">+    open fun TopBar() {}
</a><a href="#h8-0-42" id="h8-0-42" class="i">+
</a><a href="#h8-0-43" id="h8-0-43" class="i">+    @Composable
</a><a href="#h8-0-44" id="h8-0-44" class="i">+    open fun FloatingActionButtons() {}
</a><a href="#h8-0-45" id="h8-0-45" class="i">+
</a><a href="#h8-0-46" id="h8-0-46" class="i">+    @Composable
</a><a href="#h8-0-47" id="h8-0-47" class="i">+    open fun Content() {}
</a><a href="#h8-0-48" id="h8-0-48" class="i">+}</a><a href="#h8-0-49" id="h8-0-49" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h9" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/HomeTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/HomeTab.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/HomeTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/HomeTab.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -0,0 +1,139 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+package me.rhunk.snapenhance.manager.ui.tab
</a><a href="#h9-0-1" id="h9-0-1" class="i">+
</a><a href="#h9-0-2" id="h9-0-2" class="i">+import android.content.pm.ApplicationInfo.FLAG_DEBUGGABLE
</a><a href="#h9-0-3" id="h9-0-3" class="i">+import android.content.pm.PackageInfo
</a><a href="#h9-0-4" id="h9-0-4" class="i">+import androidx.activity.ComponentActivity
</a><a href="#h9-0-5" id="h9-0-5" class="i">+import androidx.compose.foundation.clickable
</a><a href="#h9-0-6" id="h9-0-6" class="i">+import androidx.compose.foundation.layout.Arrangement
</a><a href="#h9-0-7" id="h9-0-7" class="i">+import androidx.compose.foundation.layout.Column
</a><a href="#h9-0-8" id="h9-0-8" class="i">+import androidx.compose.foundation.layout.Row
</a><a href="#h9-0-9" id="h9-0-9" class="i">+import androidx.compose.foundation.layout.fillMaxWidth
</a><a href="#h9-0-10" id="h9-0-10" class="i">+import androidx.compose.foundation.layout.padding
</a><a href="#h9-0-11" id="h9-0-11" class="i">+import androidx.compose.material.icons.Icons
</a><a href="#h9-0-12" id="h9-0-12" class="i">+import androidx.compose.material.icons.automirrored.filled.OpenInNew
</a><a href="#h9-0-13" id="h9-0-13" class="i">+import androidx.compose.material.icons.filled.Home
</a><a href="#h9-0-14" id="h9-0-14" class="i">+import androidx.compose.material3.Card
</a><a href="#h9-0-15" id="h9-0-15" class="i">+import androidx.compose.material3.Icon
</a><a href="#h9-0-16" id="h9-0-16" class="i">+import androidx.compose.material3.MaterialTheme
</a><a href="#h9-0-17" id="h9-0-17" class="i">+import androidx.compose.material3.OutlinedButton
</a><a href="#h9-0-18" id="h9-0-18" class="i">+import androidx.compose.material3.Text
</a><a href="#h9-0-19" id="h9-0-19" class="i">+import androidx.compose.runtime.*
</a><a href="#h9-0-20" id="h9-0-20" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h9-0-21" id="h9-0-21" class="i">+import androidx.compose.ui.platform.LocalContext
</a><a href="#h9-0-22" id="h9-0-22" class="i">+import androidx.compose.ui.text.font.FontWeight
</a><a href="#h9-0-23" id="h9-0-23" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h9-0-24" id="h9-0-24" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h9-0-25" id="h9-0-25" class="i">+import kotlinx.coroutines.Dispatchers
</a><a href="#h9-0-26" id="h9-0-26" class="i">+import kotlinx.coroutines.launch
</a><a href="#h9-0-27" id="h9-0-27" class="i">+import me.rhunk.snapenhance.manager.BuildConfig
</a><a href="#h9-0-28" id="h9-0-28" class="i">+import me.rhunk.snapenhance.manager.lspatch.config.Constants
</a><a href="#h9-0-29" id="h9-0-29" class="i">+import me.rhunk.snapenhance.manager.ui.Tab
</a><a href="#h9-0-30" id="h9-0-30" class="i">+import me.rhunk.snapenhance.manager.ui.tab.download.SEDownloadTab
</a><a href="#h9-0-31" id="h9-0-31" class="i">+
</a><a href="#h9-0-32" id="h9-0-32" class="i">+class HomeTab : Tab(&quot;home&quot;, true, icon = Icons.Default.Home) {
</a><a href="#h9-0-33" id="h9-0-33" class="i">+    override fun init(activity: ComponentActivity) {
</a><a href="#h9-0-34" id="h9-0-34" class="i">+        super.init(activity)
</a><a href="#h9-0-35" id="h9-0-35" class="i">+        registerNestedTab(SEDownloadTab::class)
</a><a href="#h9-0-36" id="h9-0-36" class="i">+    }
</a><a href="#h9-0-37" id="h9-0-37" class="i">+
</a><a href="#h9-0-38" id="h9-0-38" class="i">+    @Composable
</a><a href="#h9-0-39" id="h9-0-39" class="i">+    override fun Content() {
</a><a href="#h9-0-40" id="h9-0-40" class="i">+        val context = LocalContext.current
</a><a href="#h9-0-41" id="h9-0-41" class="i">+        val coroutineScope = rememberCoroutineScope()
</a><a href="#h9-0-42" id="h9-0-42" class="i">+        var snapchatAppInfo by remember { mutableStateOf(null as PackageInfo?) }
</a><a href="#h9-0-43" id="h9-0-43" class="i">+        var snapEnhanceInfo by remember { mutableStateOf(null as PackageInfo?) }
</a><a href="#h9-0-44" id="h9-0-44" class="i">+
</a><a href="#h9-0-45" id="h9-0-45" class="i">+        Column {
</a><a href="#h9-0-46" id="h9-0-46" class="i">+            Card(
</a><a href="#h9-0-47" id="h9-0-47" class="i">+                modifier = Modifier
</a><a href="#h9-0-48" id="h9-0-48" class="i">+                    .fillMaxWidth()
</a><a href="#h9-0-49" id="h9-0-49" class="i">+                    .padding(10.dp),
</a><a href="#h9-0-50" id="h9-0-50" class="i">+            ) {
</a><a href="#h9-0-51" id="h9-0-51" class="i">+                Row(
</a><a href="#h9-0-52" id="h9-0-52" class="i">+                    modifier = Modifier
</a><a href="#h9-0-53" id="h9-0-53" class="i">+                        .fillMaxWidth()
</a><a href="#h9-0-54" id="h9-0-54" class="i">+                        .padding(16.dp),
</a><a href="#h9-0-55" id="h9-0-55" class="i">+                    verticalAlignment = androidx.compose.ui.Alignment.CenterVertically
</a><a href="#h9-0-56" id="h9-0-56" class="i">+                ) {
</a><a href="#h9-0-57" id="h9-0-57" class="i">+                    Column {
</a><a href="#h9-0-58" id="h9-0-58" class="i">+                        Text(text = &quot;Snapchat&quot;, fontSize = 24.sp, color = MaterialTheme.colorScheme.onSurface, fontWeight = FontWeight.Bold)
</a><a href="#h9-0-59" id="h9-0-59" class="i">+                        snapchatAppInfo?.let {
</a><a href="#h9-0-60" id="h9-0-60" class="i">+                            Text(text = &quot;${it.versionName} (${it.longVersionCode})&quot;, fontSize = 12.sp, color = MaterialTheme.colorScheme.onSurfaceVariant)
</a><a href="#h9-0-61" id="h9-0-61" class="i">+                        }
</a><a href="#h9-0-62" id="h9-0-62" class="i">+                    }
</a><a href="#h9-0-63" id="h9-0-63" class="i">+                    Row(
</a><a href="#h9-0-64" id="h9-0-64" class="i">+                        modifier = Modifier
</a><a href="#h9-0-65" id="h9-0-65" class="i">+                            .weight(1f),
</a><a href="#h9-0-66" id="h9-0-66" class="i">+                        horizontalArrangement = Arrangement.End,
</a><a href="#h9-0-67" id="h9-0-67" class="i">+                        verticalAlignment = androidx.compose.ui.Alignment.CenterVertically
</a><a href="#h9-0-68" id="h9-0-68" class="i">+                    ) {
</a><a href="#h9-0-69" id="h9-0-69" class="i">+                        snapchatAppInfo?.let { appInfo -&gt;
</a><a href="#h9-0-70" id="h9-0-70" class="i">+                            val isLSPatched = appInfo.applicationInfo.appComponentFactory == Constants.PROXY_APP_COMPONENT_FACTORY
</a><a href="#h9-0-71" id="h9-0-71" class="i">+                            if (isLSPatched) {
</a><a href="#h9-0-72" id="h9-0-72" class="i">+                                Text(text = &quot;Patched&quot;, fontSize = 16.sp, color = MaterialTheme.colorScheme.onSurface)
</a><a href="#h9-0-73" id="h9-0-73" class="i">+                            }
</a><a href="#h9-0-74" id="h9-0-74" class="i">+                            OutlinedButton(onClick = {
</a><a href="#h9-0-75" id="h9-0-75" class="i">+
</a><a href="#h9-0-76" id="h9-0-76" class="i">+                            }) {
</a><a href="#h9-0-77" id="h9-0-77" class="i">+                                Text(text = if (isLSPatched) &quot;Repatch&quot; else &quot;Patch&quot;)
</a><a href="#h9-0-78" id="h9-0-78" class="i">+                            }
</a><a href="#h9-0-79" id="h9-0-79" class="i">+                        } ?: run {
</a><a href="#h9-0-80" id="h9-0-80" class="i">+                            Text(text = &quot;Not installed&quot;, fontSize = 16.sp, color = MaterialTheme.colorScheme.onSurface)
</a><a href="#h9-0-81" id="h9-0-81" class="i">+                        }
</a><a href="#h9-0-82" id="h9-0-82" class="i">+                    }
</a><a href="#h9-0-83" id="h9-0-83" class="i">+                }
</a><a href="#h9-0-84" id="h9-0-84" class="i">+
</a><a href="#h9-0-85" id="h9-0-85" class="i">+            }
</a><a href="#h9-0-86" id="h9-0-86" class="i">+
</a><a href="#h9-0-87" id="h9-0-87" class="i">+            Card(
</a><a href="#h9-0-88" id="h9-0-88" class="i">+                modifier = Modifier
</a><a href="#h9-0-89" id="h9-0-89" class="i">+                    .fillMaxWidth()
</a><a href="#h9-0-90" id="h9-0-90" class="i">+                    .padding(10.dp),
</a><a href="#h9-0-91" id="h9-0-91" class="i">+            ) {
</a><a href="#h9-0-92" id="h9-0-92" class="i">+                Row(
</a><a href="#h9-0-93" id="h9-0-93" class="i">+                    modifier = Modifier
</a><a href="#h9-0-94" id="h9-0-94" class="i">+                        .fillMaxWidth()
</a><a href="#h9-0-95" id="h9-0-95" class="i">+                        .clickable {
</a><a href="#h9-0-96" id="h9-0-96" class="i">+                            navigation.navigateTo(SEDownloadTab::class)
</a><a href="#h9-0-97" id="h9-0-97" class="i">+                        }
</a><a href="#h9-0-98" id="h9-0-98" class="i">+                        .padding(16.dp),
</a><a href="#h9-0-99" id="h9-0-99" class="i">+                    verticalAlignment = androidx.compose.ui.Alignment.CenterVertically
</a><a href="#h9-0-100" id="h9-0-100" class="i">+                ) {
</a><a href="#h9-0-101" id="h9-0-101" class="i">+                    Column {
</a><a href="#h9-0-102" id="h9-0-102" class="i">+                        Text(text = &quot;SnapEnhance&quot;, fontSize = 24.sp, color = MaterialTheme.colorScheme.onSurface, fontWeight = FontWeight.Bold)
</a><a href="#h9-0-103" id="h9-0-103" class="i">+                        snapEnhanceInfo?.let {
</a><a href="#h9-0-104" id="h9-0-104" class="i">+                            Text(text = &quot;${it.versionName} (${it.longVersionCode}) - ${if ((it.applicationInfo.flags and FLAG_DEBUGGABLE) != 0) &quot;Debug&quot; else &quot;Release&quot;}&quot;, fontSize = 12.sp, color = MaterialTheme.colorScheme.onSurfaceVariant)
</a><a href="#h9-0-105" id="h9-0-105" class="i">+                        }
</a><a href="#h9-0-106" id="h9-0-106" class="i">+                    }
</a><a href="#h9-0-107" id="h9-0-107" class="i">+                    Row(
</a><a href="#h9-0-108" id="h9-0-108" class="i">+                        modifier = Modifier
</a><a href="#h9-0-109" id="h9-0-109" class="i">+                            .weight(1f),
</a><a href="#h9-0-110" id="h9-0-110" class="i">+                        horizontalArrangement = Arrangement.End,
</a><a href="#h9-0-111" id="h9-0-111" class="i">+                        verticalAlignment = androidx.compose.ui.Alignment.CenterVertically
</a><a href="#h9-0-112" id="h9-0-112" class="i">+                    ) {
</a><a href="#h9-0-113" id="h9-0-113" class="i">+                        snapEnhanceInfo?.let {
</a><a href="#h9-0-114" id="h9-0-114" class="i">+                            Text(text = &quot;Installed&quot;, fontSize = 16.sp, color = MaterialTheme.colorScheme.onSurface)
</a><a href="#h9-0-115" id="h9-0-115" class="i">+                        } ?: run {
</a><a href="#h9-0-116" id="h9-0-116" class="i">+                            Text(text = &quot;Not installed&quot;, fontSize = 16.sp, color = MaterialTheme.colorScheme.onSurface)
</a><a href="#h9-0-117" id="h9-0-117" class="i">+                        }
</a><a href="#h9-0-118" id="h9-0-118" class="i">+
</a><a href="#h9-0-119" id="h9-0-119" class="i">+                        Icon(imageVector = Icons.AutoMirrored.Default.OpenInNew, contentDescription = null, Modifier.padding(10.dp))
</a><a href="#h9-0-120" id="h9-0-120" class="i">+                    }
</a><a href="#h9-0-121" id="h9-0-121" class="i">+                }
</a><a href="#h9-0-122" id="h9-0-122" class="i">+            }
</a><a href="#h9-0-123" id="h9-0-123" class="i">+        }
</a><a href="#h9-0-124" id="h9-0-124" class="i">+
</a><a href="#h9-0-125" id="h9-0-125" class="i">+        SideEffect {
</a><a href="#h9-0-126" id="h9-0-126" class="i">+            coroutineScope.launch(Dispatchers.IO) {
</a><a href="#h9-0-127" id="h9-0-127" class="i">+                runCatching {
</a><a href="#h9-0-128" id="h9-0-128" class="i">+                    snapchatAppInfo = runCatching {
</a><a href="#h9-0-129" id="h9-0-129" class="i">+                        context.packageManager.getPackageInfo(sharedConfig.snapchatPackageName ?: &quot;com.snapchat.android&quot;, 0)
</a><a href="#h9-0-130" id="h9-0-130" class="i">+                    }.getOrNull()
</a><a href="#h9-0-131" id="h9-0-131" class="i">+                    snapEnhanceInfo = runCatching {
</a><a href="#h9-0-132" id="h9-0-132" class="i">+                        context.packageManager.getPackageInfo(sharedConfig.snapEnhancePackageName ?: BuildConfig.APPLICATION_ID, 0)
</a><a href="#h9-0-133" id="h9-0-133" class="i">+                    }.getOrNull()
</a><a href="#h9-0-134" id="h9-0-134" class="i">+                }
</a><a href="#h9-0-135" id="h9-0-135" class="i">+            }
</a><a href="#h9-0-136" id="h9-0-136" class="i">+        }
</a><a href="#h9-0-137" id="h9-0-137" class="i">+    }
</a><a href="#h9-0-138" id="h9-0-138" class="i">+}</a><a href="#h9-0-139" id="h9-0-139" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h10" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/SettingsTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/SettingsTab.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/SettingsTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/SettingsTab.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -0,0 +1,117 @@
</a><a href="#h10-0-0" id="h10-0-0" class="i">+package me.rhunk.snapenhance.manager.ui.tab
</a><a href="#h10-0-1" id="h10-0-1" class="i">+
</a><a href="#h10-0-2" id="h10-0-2" class="i">+import androidx.compose.foundation.clickable
</a><a href="#h10-0-3" id="h10-0-3" class="i">+import androidx.compose.foundation.layout.*
</a><a href="#h10-0-4" id="h10-0-4" class="i">+import androidx.compose.material.icons.Icons
</a><a href="#h10-0-5" id="h10-0-5" class="i">+import androidx.compose.material.icons.filled.Edit
</a><a href="#h10-0-6" id="h10-0-6" class="i">+import androidx.compose.material.icons.filled.Settings
</a><a href="#h10-0-7" id="h10-0-7" class="i">+import androidx.compose.material3.*
</a><a href="#h10-0-8" id="h10-0-8" class="i">+import androidx.compose.runtime.Composable
</a><a href="#h10-0-9" id="h10-0-9" class="i">+import androidx.compose.runtime.getValue
</a><a href="#h10-0-10" id="h10-0-10" class="i">+import androidx.compose.runtime.mutableStateOf
</a><a href="#h10-0-11" id="h10-0-11" class="i">+import androidx.compose.runtime.remember
</a><a href="#h10-0-12" id="h10-0-12" class="i">+import androidx.compose.runtime.setValue
</a><a href="#h10-0-13" id="h10-0-13" class="i">+import androidx.compose.ui.Alignment
</a><a href="#h10-0-14" id="h10-0-14" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h10-0-15" id="h10-0-15" class="i">+import androidx.compose.ui.focus.FocusRequester
</a><a href="#h10-0-16" id="h10-0-16" class="i">+import androidx.compose.ui.focus.focusRequester
</a><a href="#h10-0-17" id="h10-0-17" class="i">+import androidx.compose.ui.layout.onGloballyPositioned
</a><a href="#h10-0-18" id="h10-0-18" class="i">+import androidx.compose.ui.text.TextRange
</a><a href="#h10-0-19" id="h10-0-19" class="i">+import androidx.compose.ui.text.input.TextFieldValue
</a><a href="#h10-0-20" id="h10-0-20" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h10-0-21" id="h10-0-21" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h10-0-22" id="h10-0-22" class="i">+import androidx.compose.ui.window.Dialog
</a><a href="#h10-0-23" id="h10-0-23" class="i">+import me.rhunk.snapenhance.manager.ui.Tab
</a><a href="#h10-0-24" id="h10-0-24" class="i">+
</a><a href="#h10-0-25" id="h10-0-25" class="i">+class SettingsTab : Tab(&quot;settings&quot;, isPrimary = true, icon = Icons.Default.Settings) {
</a><a href="#h10-0-26" id="h10-0-26" class="i">+    @Composable
</a><a href="#h10-0-27" id="h10-0-27" class="i">+    private fun ConfigEditRow(getValue: () -&gt; String?, setValue: (String) -&gt; Unit, label: String) {
</a><a href="#h10-0-28" id="h10-0-28" class="i">+        var showDialog by remember { mutableStateOf(false) }
</a><a href="#h10-0-29" id="h10-0-29" class="i">+
</a><a href="#h10-0-30" id="h10-0-30" class="i">+        if (showDialog) {
</a><a href="#h10-0-31" id="h10-0-31" class="i">+            val focusRequester = remember { FocusRequester() }
</a><a href="#h10-0-32" id="h10-0-32" class="i">+
</a><a href="#h10-0-33" id="h10-0-33" class="i">+            Dialog(onDismissRequest = {
</a><a href="#h10-0-34" id="h10-0-34" class="i">+                showDialog = false
</a><a href="#h10-0-35" id="h10-0-35" class="i">+            }) {
</a><a href="#h10-0-36" id="h10-0-36" class="i">+                Card {
</a><a href="#h10-0-37" id="h10-0-37" class="i">+                    Column(
</a><a href="#h10-0-38" id="h10-0-38" class="i">+                        modifier = Modifier.padding(16.dp),
</a><a href="#h10-0-39" id="h10-0-39" class="i">+                        horizontalAlignment = Alignment.CenterHorizontally,
</a><a href="#h10-0-40" id="h10-0-40" class="i">+                        verticalArrangement = Arrangement.spacedBy(16.dp)
</a><a href="#h10-0-41" id="h10-0-41" class="i">+                    ) {
</a><a href="#h10-0-42" id="h10-0-42" class="i">+                        Text(text = label)
</a><a href="#h10-0-43" id="h10-0-43" class="i">+                        var textFieldValue by remember { mutableStateOf((getValue() ?: &quot;&quot;).let {
</a><a href="#h10-0-44" id="h10-0-44" class="i">+                            TextFieldValue(it, TextRange(it.length))
</a><a href="#h10-0-45" id="h10-0-45" class="i">+                        }) }
</a><a href="#h10-0-46" id="h10-0-46" class="i">+
</a><a href="#h10-0-47" id="h10-0-47" class="i">+                        TextField(
</a><a href="#h10-0-48" id="h10-0-48" class="i">+                            value = textFieldValue,
</a><a href="#h10-0-49" id="h10-0-49" class="i">+                            onValueChange = {
</a><a href="#h10-0-50" id="h10-0-50" class="i">+                                textFieldValue = it
</a><a href="#h10-0-51" id="h10-0-51" class="i">+                            },
</a><a href="#h10-0-52" id="h10-0-52" class="i">+                            modifier = Modifier
</a><a href="#h10-0-53" id="h10-0-53" class="i">+                                .focusRequester(focusRequester)
</a><a href="#h10-0-54" id="h10-0-54" class="i">+                                .onGloballyPositioned {
</a><a href="#h10-0-55" id="h10-0-55" class="i">+                                    focusRequester.requestFocus()
</a><a href="#h10-0-56" id="h10-0-56" class="i">+                                }
</a><a href="#h10-0-57" id="h10-0-57" class="i">+                        )
</a><a href="#h10-0-58" id="h10-0-58" class="i">+                        Row(
</a><a href="#h10-0-59" id="h10-0-59" class="i">+                            modifier = Modifier.fillMaxWidth(),
</a><a href="#h10-0-60" id="h10-0-60" class="i">+                            horizontalArrangement = Arrangement.SpaceAround
</a><a href="#h10-0-61" id="h10-0-61" class="i">+                        ) {
</a><a href="#h10-0-62" id="h10-0-62" class="i">+                            Button(onClick = {
</a><a href="#h10-0-63" id="h10-0-63" class="i">+                                showDialog = false
</a><a href="#h10-0-64" id="h10-0-64" class="i">+                            }) {
</a><a href="#h10-0-65" id="h10-0-65" class="i">+                                Text(text = &quot;Cancel&quot;)
</a><a href="#h10-0-66" id="h10-0-66" class="i">+                            }
</a><a href="#h10-0-67" id="h10-0-67" class="i">+                            Button(onClick = {
</a><a href="#h10-0-68" id="h10-0-68" class="i">+                                setValue(textFieldValue.text)
</a><a href="#h10-0-69" id="h10-0-69" class="i">+                                showDialog = false
</a><a href="#h10-0-70" id="h10-0-70" class="i">+                            }) {
</a><a href="#h10-0-71" id="h10-0-71" class="i">+                                Text(text = &quot;Save&quot;)
</a><a href="#h10-0-72" id="h10-0-72" class="i">+                            }
</a><a href="#h10-0-73" id="h10-0-73" class="i">+                        }
</a><a href="#h10-0-74" id="h10-0-74" class="i">+                    }
</a><a href="#h10-0-75" id="h10-0-75" class="i">+                }
</a><a href="#h10-0-76" id="h10-0-76" class="i">+            }
</a><a href="#h10-0-77" id="h10-0-77" class="i">+        }
</a><a href="#h10-0-78" id="h10-0-78" class="i">+
</a><a href="#h10-0-79" id="h10-0-79" class="i">+        Row(
</a><a href="#h10-0-80" id="h10-0-80" class="i">+            modifier = Modifier
</a><a href="#h10-0-81" id="h10-0-81" class="i">+                .fillMaxWidth()
</a><a href="#h10-0-82" id="h10-0-82" class="i">+                .clickable {
</a><a href="#h10-0-83" id="h10-0-83" class="i">+                    showDialog = true
</a><a href="#h10-0-84" id="h10-0-84" class="i">+                },
</a><a href="#h10-0-85" id="h10-0-85" class="i">+            verticalAlignment = Alignment.CenterVertically
</a><a href="#h10-0-86" id="h10-0-86" class="i">+        ) {
</a><a href="#h10-0-87" id="h10-0-87" class="i">+            Column(
</a><a href="#h10-0-88" id="h10-0-88" class="i">+                modifier = Modifier
</a><a href="#h10-0-89" id="h10-0-89" class="i">+                    .weight(1f)
</a><a href="#h10-0-90" id="h10-0-90" class="i">+                    .padding(16.dp),
</a><a href="#h10-0-91" id="h10-0-91" class="i">+                verticalArrangement = Arrangement.spacedBy(4.dp)
</a><a href="#h10-0-92" id="h10-0-92" class="i">+            ) {
</a><a href="#h10-0-93" id="h10-0-93" class="i">+                Text(text = label, fontSize = 16.sp)
</a><a href="#h10-0-94" id="h10-0-94" class="i">+                Text(text = getValue() ?: &quot;(Not specified)&quot;, fontSize = 12.sp, color = MaterialTheme.colorScheme.onSurfaceVariant)
</a><a href="#h10-0-95" id="h10-0-95" class="i">+            }
</a><a href="#h10-0-96" id="h10-0-96" class="i">+            Icon(imageVector = Icons.Default.Edit, contentDescription = null, modifier = Modifier.padding(16.dp))
</a><a href="#h10-0-97" id="h10-0-97" class="i">+        }
</a><a href="#h10-0-98" id="h10-0-98" class="i">+    }
</a><a href="#h10-0-99" id="h10-0-99" class="i">+
</a><a href="#h10-0-100" id="h10-0-100" class="i">+    @Composable
</a><a href="#h10-0-101" id="h10-0-101" class="i">+    override fun Content() {
</a><a href="#h10-0-102" id="h10-0-102" class="i">+        Column {
</a><a href="#h10-0-103" id="h10-0-103" class="i">+            Spacer(modifier = Modifier.height(16.dp))
</a><a href="#h10-0-104" id="h10-0-104" class="i">+            ConfigEditRow(
</a><a href="#h10-0-105" id="h10-0-105" class="i">+                getValue = { sharedConfig.snapchatPackageName },
</a><a href="#h10-0-106" id="h10-0-106" class="i">+                setValue = { sharedConfig.snapchatPackageName = it },
</a><a href="#h10-0-107" id="h10-0-107" class="i">+                label = &quot;Snapchat package name&quot;
</a><a href="#h10-0-108" id="h10-0-108" class="i">+            )
</a><a href="#h10-0-109" id="h10-0-109" class="i">+            ConfigEditRow(
</a><a href="#h10-0-110" id="h10-0-110" class="i">+                getValue = { sharedConfig.snapEnhancePackageName },
</a><a href="#h10-0-111" id="h10-0-111" class="i">+                setValue = { sharedConfig.snapEnhancePackageName = it },
</a><a href="#h10-0-112" id="h10-0-112" class="i">+                label = &quot;SnapEnhance package name&quot;
</a><a href="#h10-0-113" id="h10-0-113" class="i">+            )
</a><a href="#h10-0-114" id="h10-0-114" class="i">+        }
</a><a href="#h10-0-115" id="h10-0-115" class="i">+    }
</a><a href="#h10-0-116" id="h10-0-116" class="i">+}</a><a href="#h10-0-117" id="h10-0-117" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h11" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/InstallAppTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/InstallAppTab.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/InstallAppTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/InstallAppTab.kt</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -0,0 +1,176 @@
</a><a href="#h11-0-0" id="h11-0-0" class="i">+package me.rhunk.snapenhance.manager.ui.tab.download
</a><a href="#h11-0-1" id="h11-0-1" class="i">+
</a><a href="#h11-0-2" id="h11-0-2" class="i">+import android.content.Intent
</a><a href="#h11-0-3" id="h11-0-3" class="i">+import android.widget.Toast
</a><a href="#h11-0-4" id="h11-0-4" class="i">+import androidx.activity.ComponentActivity
</a><a href="#h11-0-5" id="h11-0-5" class="i">+import androidx.activity.result.ActivityResultLauncher
</a><a href="#h11-0-6" id="h11-0-6" class="i">+import androidx.activity.result.contract.ActivityResultContracts
</a><a href="#h11-0-7" id="h11-0-7" class="i">+import androidx.compose.foundation.layout.Arrangement
</a><a href="#h11-0-8" id="h11-0-8" class="i">+import androidx.compose.foundation.layout.Column
</a><a href="#h11-0-9" id="h11-0-9" class="i">+import androidx.compose.foundation.layout.Row
</a><a href="#h11-0-10" id="h11-0-10" class="i">+import androidx.compose.foundation.layout.fillMaxSize
</a><a href="#h11-0-11" id="h11-0-11" class="i">+import androidx.compose.foundation.layout.fillMaxWidth
</a><a href="#h11-0-12" id="h11-0-12" class="i">+import androidx.compose.material3.CircularProgressIndicator
</a><a href="#h11-0-13" id="h11-0-13" class="i">+import androidx.compose.material3.Text
</a><a href="#h11-0-14" id="h11-0-14" class="i">+import androidx.compose.runtime.*
</a><a href="#h11-0-15" id="h11-0-15" class="i">+import androidx.compose.ui.Alignment
</a><a href="#h11-0-16" id="h11-0-16" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h11-0-17" id="h11-0-17" class="i">+import androidx.compose.ui.platform.LocalContext
</a><a href="#h11-0-18" id="h11-0-18" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h11-0-19" id="h11-0-19" class="i">+import androidx.core.content.FileProvider
</a><a href="#h11-0-20" id="h11-0-20" class="i">+import androidx.core.net.toUri
</a><a href="#h11-0-21" id="h11-0-21" class="i">+import kotlinx.coroutines.Dispatchers
</a><a href="#h11-0-22" id="h11-0-22" class="i">+import kotlinx.coroutines.launch
</a><a href="#h11-0-23" id="h11-0-23" class="i">+import me.rhunk.snapenhance.manager.data.download.InstallStage
</a><a href="#h11-0-24" id="h11-0-24" class="i">+import me.rhunk.snapenhance.manager.data.download.SEArtifact
</a><a href="#h11-0-25" id="h11-0-25" class="i">+import me.rhunk.snapenhance.manager.ui.Tab
</a><a href="#h11-0-26" id="h11-0-26" class="i">+import me.rhunk.snapenhance.manager.ui.tab.HomeTab
</a><a href="#h11-0-27" id="h11-0-27" class="i">+import okhttp3.OkHttpClient
</a><a href="#h11-0-28" id="h11-0-28" class="i">+import okhttp3.Request
</a><a href="#h11-0-29" id="h11-0-29" class="i">+import java.io.File
</a><a href="#h11-0-30" id="h11-0-30" class="i">+
</a><a href="#h11-0-31" id="h11-0-31" class="i">+
</a><a href="#h11-0-32" id="h11-0-32" class="i">+class InstallAppTab : Tab(&quot;install_app&quot;) {
</a><a href="#h11-0-33" id="h11-0-33" class="i">+    private lateinit var installPackageIntentLauncher: ActivityResultLauncher&lt;Intent&gt;
</a><a href="#h11-0-34" id="h11-0-34" class="i">+    private lateinit var uninstallPackageIntentLauncher: ActivityResultLauncher&lt;Intent&gt;
</a><a href="#h11-0-35" id="h11-0-35" class="i">+    private var uninstallPackageCallback: ((resultCode: Int, data: Intent?) -&gt; Unit)? = null
</a><a href="#h11-0-36" id="h11-0-36" class="i">+    private var installPackageCallback: ((resultCode: Int, data: Intent?) -&gt; Unit)? = null
</a><a href="#h11-0-37" id="h11-0-37" class="i">+
</a><a href="#h11-0-38" id="h11-0-38" class="i">+    override fun init(activity: ComponentActivity) {
</a><a href="#h11-0-39" id="h11-0-39" class="i">+        super.init(activity)
</a><a href="#h11-0-40" id="h11-0-40" class="i">+        installPackageIntentLauncher = activity.registerForActivityResult(ActivityResultContracts.StartActivityForResult()) {
</a><a href="#h11-0-41" id="h11-0-41" class="i">+            installPackageCallback?.invoke(it.resultCode, it.data)
</a><a href="#h11-0-42" id="h11-0-42" class="i">+        }
</a><a href="#h11-0-43" id="h11-0-43" class="i">+        uninstallPackageIntentLauncher = activity.registerForActivityResult(ActivityResultContracts.StartActivityForResult()) {
</a><a href="#h11-0-44" id="h11-0-44" class="i">+            uninstallPackageCallback?.invoke(it.resultCode, it.data)
</a><a href="#h11-0-45" id="h11-0-45" class="i">+        }
</a><a href="#h11-0-46" id="h11-0-46" class="i">+    }
</a><a href="#h11-0-47" id="h11-0-47" class="i">+
</a><a href="#h11-0-48" id="h11-0-48" class="i">+
</a><a href="#h11-0-49" id="h11-0-49" class="i">+    private fun downloadArtifact(artifact: SEArtifact, progress: (Int) -&gt; Unit): File? {
</a><a href="#h11-0-50" id="h11-0-50" class="i">+        val endpoint = Request.Builder().url(artifact.downloadUrl).build()
</a><a href="#h11-0-51" id="h11-0-51" class="i">+        val response = OkHttpClient().newCall(endpoint).execute()
</a><a href="#h11-0-52" id="h11-0-52" class="i">+        if (!response.isSuccessful) throw Throwable(&quot;Failed to download artifact: ${response.code}&quot;)
</a><a href="#h11-0-53" id="h11-0-53" class="i">+
</a><a href="#h11-0-54" id="h11-0-54" class="i">+        return response.body.byteStream().use { input -&gt;
</a><a href="#h11-0-55" id="h11-0-55" class="i">+            val file = activity.externalCacheDirs.first().resolve(artifact.fileName)
</a><a href="#h11-0-56" id="h11-0-56" class="i">+            runCatching {
</a><a href="#h11-0-57" id="h11-0-57" class="i">+                file.outputStream().use { output -&gt;
</a><a href="#h11-0-58" id="h11-0-58" class="i">+                    val buffer = ByteArray(4 * 1024)
</a><a href="#h11-0-59" id="h11-0-59" class="i">+                    var read: Int
</a><a href="#h11-0-60" id="h11-0-60" class="i">+                    var totalRead = 0L
</a><a href="#h11-0-61" id="h11-0-61" class="i">+                    val totalSize = response.body.contentLength()
</a><a href="#h11-0-62" id="h11-0-62" class="i">+                    while (input.read(buffer).also { read = it } != -1) {
</a><a href="#h11-0-63" id="h11-0-63" class="i">+                        output.write(buffer, 0, read)
</a><a href="#h11-0-64" id="h11-0-64" class="i">+                        totalRead += read
</a><a href="#h11-0-65" id="h11-0-65" class="i">+                        progress((totalRead * 100 / totalSize).toInt())
</a><a href="#h11-0-66" id="h11-0-66" class="i">+                    }
</a><a href="#h11-0-67" id="h11-0-67" class="i">+                }
</a><a href="#h11-0-68" id="h11-0-68" class="i">+                file
</a><a href="#h11-0-69" id="h11-0-69" class="i">+            }.getOrNull()
</a><a href="#h11-0-70" id="h11-0-70" class="i">+        }
</a><a href="#h11-0-71" id="h11-0-71" class="i">+    }
</a><a href="#h11-0-72" id="h11-0-72" class="i">+
</a><a href="#h11-0-73" id="h11-0-73" class="i">+
</a><a href="#h11-0-74" id="h11-0-74" class="i">+    @Composable
</a><a href="#h11-0-75" id="h11-0-75" class="i">+    @Suppress(&quot;DEPRECATION&quot;)
</a><a href="#h11-0-76" id="h11-0-76" class="i">+    override fun Content() {
</a><a href="#h11-0-77" id="h11-0-77" class="i">+        val coroutineScope = rememberCoroutineScope()
</a><a href="#h11-0-78" id="h11-0-78" class="i">+        val context = LocalContext.current
</a><a href="#h11-0-79" id="h11-0-79" class="i">+        var installStage by remember { mutableStateOf(InstallStage.DOWNLOADING) }
</a><a href="#h11-0-80" id="h11-0-80" class="i">+        var downloadProgress by remember { mutableIntStateOf(0) }
</a><a href="#h11-0-81" id="h11-0-81" class="i">+        var downloadedFile by remember { mutableStateOf&lt;File?&gt;(null) }
</a><a href="#h11-0-82" id="h11-0-82" class="i">+
</a><a href="#h11-0-83" id="h11-0-83" class="i">+        LaunchedEffect(Unit) {
</a><a href="#h11-0-84" id="h11-0-84" class="i">+            uninstallPackageCallback = null
</a><a href="#h11-0-85" id="h11-0-85" class="i">+            installPackageCallback = null
</a><a href="#h11-0-86" id="h11-0-86" class="i">+        }
</a><a href="#h11-0-87" id="h11-0-87" class="i">+
</a><a href="#h11-0-88" id="h11-0-88" class="i">+        val artifact = getArguments()?.getParcelable&lt;SEArtifact&gt;(&quot;artifact&quot;) ?: return
</a><a href="#h11-0-89" id="h11-0-89" class="i">+        val appPackage = getArguments()?.getString(&quot;appPackage&quot;) ?: return
</a><a href="#h11-0-90" id="h11-0-90" class="i">+        val shouldUninstall = getArguments()?.getBoolean(&quot;uninstall&quot;) ?: false
</a><a href="#h11-0-91" id="h11-0-91" class="i">+
</a><a href="#h11-0-92" id="h11-0-92" class="i">+        Column(
</a><a href="#h11-0-93" id="h11-0-93" class="i">+            modifier = Modifier.fillMaxSize(),
</a><a href="#h11-0-94" id="h11-0-94" class="i">+            horizontalAlignment = Alignment.CenterHorizontally,
</a><a href="#h11-0-95" id="h11-0-95" class="i">+            verticalArrangement = Arrangement.spacedBy(16.dp, Alignment.CenterVertically)
</a><a href="#h11-0-96" id="h11-0-96" class="i">+        ) {
</a><a href="#h11-0-97" id="h11-0-97" class="i">+            Row(
</a><a href="#h11-0-98" id="h11-0-98" class="i">+                modifier = Modifier.fillMaxWidth(),
</a><a href="#h11-0-99" id="h11-0-99" class="i">+                horizontalArrangement = Arrangement.Center
</a><a href="#h11-0-100" id="h11-0-100" class="i">+            ) {
</a><a href="#h11-0-101" id="h11-0-101" class="i">+                if (installStage != InstallStage.DONE &amp;&amp; installStage != InstallStage.ERROR) {
</a><a href="#h11-0-102" id="h11-0-102" class="i">+                    CircularProgressIndicator()
</a><a href="#h11-0-103" id="h11-0-103" class="i">+                }
</a><a href="#h11-0-104" id="h11-0-104" class="i">+            }
</a><a href="#h11-0-105" id="h11-0-105" class="i">+
</a><a href="#h11-0-106" id="h11-0-106" class="i">+            when (installStage) {
</a><a href="#h11-0-107" id="h11-0-107" class="i">+                InstallStage.DOWNLOADING -&gt; {
</a><a href="#h11-0-108" id="h11-0-108" class="i">+                    Text(text = &quot;Downloading ${artifact.fileName}... ($downloadProgress%)&quot;)
</a><a href="#h11-0-109" id="h11-0-109" class="i">+                }
</a><a href="#h11-0-110" id="h11-0-110" class="i">+                InstallStage.UNINSTALLING -&gt; {
</a><a href="#h11-0-111" id="h11-0-111" class="i">+                    Text(text = &quot;Uninstalling app $appPackage...&quot;)
</a><a href="#h11-0-112" id="h11-0-112" class="i">+                }
</a><a href="#h11-0-113" id="h11-0-113" class="i">+                InstallStage.INSTALLING -&gt; {
</a><a href="#h11-0-114" id="h11-0-114" class="i">+                    Text(text = &quot;Installing ${artifact.fileName}...&quot;)
</a><a href="#h11-0-115" id="h11-0-115" class="i">+                }
</a><a href="#h11-0-116" id="h11-0-116" class="i">+                InstallStage.DONE -&gt; {
</a><a href="#h11-0-117" id="h11-0-117" class="i">+                    LaunchedEffect(Unit) {
</a><a href="#h11-0-118" id="h11-0-118" class="i">+                        navigation.navigateTo(HomeTab::class, noHistory = true)
</a><a href="#h11-0-119" id="h11-0-119" class="i">+                        Toast.makeText(context, &quot;${artifact.fileName} installed successfully!&quot;, Toast.LENGTH_SHORT).show()
</a><a href="#h11-0-120" id="h11-0-120" class="i">+                    }
</a><a href="#h11-0-121" id="h11-0-121" class="i">+                }
</a><a href="#h11-0-122" id="h11-0-122" class="i">+                InstallStage.ERROR -&gt; Text(text = &quot;Failed to install ${artifact.fileName}. Check logcat for more details.&quot;)
</a><a href="#h11-0-123" id="h11-0-123" class="i">+            }
</a><a href="#h11-0-124" id="h11-0-124" class="i">+        }
</a><a href="#h11-0-125" id="h11-0-125" class="i">+
</a><a href="#h11-0-126" id="h11-0-126" class="i">+        fun installPackage() {
</a><a href="#h11-0-127" id="h11-0-127" class="i">+            installStage = InstallStage.INSTALLING
</a><a href="#h11-0-128" id="h11-0-128" class="i">+            installPackageCallback = resultCallbacks@{ code, _ -&gt;
</a><a href="#h11-0-129" id="h11-0-129" class="i">+                installStage = if (code != ComponentActivity.RESULT_OK) {
</a><a href="#h11-0-130" id="h11-0-130" class="i">+                    InstallStage.ERROR
</a><a href="#h11-0-131" id="h11-0-131" class="i">+                } else {
</a><a href="#h11-0-132" id="h11-0-132" class="i">+                    InstallStage.DONE
</a><a href="#h11-0-133" id="h11-0-133" class="i">+                }
</a><a href="#h11-0-134" id="h11-0-134" class="i">+                downloadedFile?.delete()
</a><a href="#h11-0-135" id="h11-0-135" class="i">+            }
</a><a href="#h11-0-136" id="h11-0-136" class="i">+
</a><a href="#h11-0-137" id="h11-0-137" class="i">+            installPackageIntentLauncher.launch(Intent(Intent.ACTION_INSTALL_PACKAGE).apply {
</a><a href="#h11-0-138" id="h11-0-138" class="i">+                println(context)
</a><a href="#h11-0-139" id="h11-0-139" class="i">+                data = FileProvider.getUriForFile(context, &quot;me.rhunk.snapenhance.manager.provider&quot;, downloadedFile!!)
</a><a href="#h11-0-140" id="h11-0-140" class="i">+                setFlags(Intent.FLAG_GRANT_READ_URI_PERMISSION)
</a><a href="#h11-0-141" id="h11-0-141" class="i">+                putExtra(Intent.EXTRA_RETURN_RESULT, true)
</a><a href="#h11-0-142" id="h11-0-142" class="i">+            })
</a><a href="#h11-0-143" id="h11-0-143" class="i">+        }
</a><a href="#h11-0-144" id="h11-0-144" class="i">+
</a><a href="#h11-0-145" id="h11-0-145" class="i">+
</a><a href="#h11-0-146" id="h11-0-146" class="i">+        LaunchedEffect(Unit) {
</a><a href="#h11-0-147" id="h11-0-147" class="i">+            coroutineScope.launch(Dispatchers.IO) {
</a><a href="#h11-0-148" id="h11-0-148" class="i">+                downloadedFile = downloadArtifact(artifact) {
</a><a href="#h11-0-149" id="h11-0-149" class="i">+                    downloadProgress = it
</a><a href="#h11-0-150" id="h11-0-150" class="i">+                } ?: run {
</a><a href="#h11-0-151" id="h11-0-151" class="i">+                    installStage = InstallStage.ERROR
</a><a href="#h11-0-152" id="h11-0-152" class="i">+                    return@launch
</a><a href="#h11-0-153" id="h11-0-153" class="i">+                }
</a><a href="#h11-0-154" id="h11-0-154" class="i">+                if (shouldUninstall) {
</a><a href="#h11-0-155" id="h11-0-155" class="i">+                    installStage = InstallStage.UNINSTALLING
</a><a href="#h11-0-156" id="h11-0-156" class="i">+                    val intent = Intent(Intent.ACTION_UNINSTALL_PACKAGE).apply {
</a><a href="#h11-0-157" id="h11-0-157" class="i">+                        data = &quot;package:$appPackage&quot;.toUri()
</a><a href="#h11-0-158" id="h11-0-158" class="i">+                        putExtra(Intent.EXTRA_RETURN_RESULT, true)
</a><a href="#h11-0-159" id="h11-0-159" class="i">+                    }
</a><a href="#h11-0-160" id="h11-0-160" class="i">+                    uninstallPackageCallback = resultCallback@{ resultCode, _ -&gt;
</a><a href="#h11-0-161" id="h11-0-161" class="i">+                        if (resultCode != ComponentActivity.RESULT_OK) {
</a><a href="#h11-0-162" id="h11-0-162" class="i">+                            installStage = InstallStage.ERROR
</a><a href="#h11-0-163" id="h11-0-163" class="i">+                            downloadedFile?.delete()
</a><a href="#h11-0-164" id="h11-0-164" class="i">+                            return@resultCallback
</a><a href="#h11-0-165" id="h11-0-165" class="i">+                        }
</a><a href="#h11-0-166" id="h11-0-166" class="i">+                        installPackage()
</a><a href="#h11-0-167" id="h11-0-167" class="i">+                    }
</a><a href="#h11-0-168" id="h11-0-168" class="i">+                    uninstallPackageIntentLauncher.launch(intent)
</a><a href="#h11-0-169" id="h11-0-169" class="i">+                } else {
</a><a href="#h11-0-170" id="h11-0-170" class="i">+                    installPackage()
</a><a href="#h11-0-171" id="h11-0-171" class="i">+                }
</a><a href="#h11-0-172" id="h11-0-172" class="i">+            }
</a><a href="#h11-0-173" id="h11-0-173" class="i">+        }
</a><a href="#h11-0-174" id="h11-0-174" class="i">+    }
</a><a href="#h11-0-175" id="h11-0-175" class="i">+}
</a><b>diff --git a/<a id="h12" href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/SEDownloadTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/SEDownloadTab.kt</a> b/<a href="../file/manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/SEDownloadTab.kt.html">manager/src/main/kotlin/me/rhunk/snapenhance/manager/ui/tab/download/SEDownloadTab.kt</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,277 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+package me.rhunk.snapenhance.manager.ui.tab.download
</a><a href="#h12-0-1" id="h12-0-1" class="i">+
</a><a href="#h12-0-2" id="h12-0-2" class="i">+import android.os.Bundle
</a><a href="#h12-0-3" id="h12-0-3" class="i">+import androidx.activity.ComponentActivity
</a><a href="#h12-0-4" id="h12-0-4" class="i">+import androidx.compose.foundation.background
</a><a href="#h12-0-5" id="h12-0-5" class="i">+import androidx.compose.foundation.border
</a><a href="#h12-0-6" id="h12-0-6" class="i">+import androidx.compose.foundation.clickable
</a><a href="#h12-0-7" id="h12-0-7" class="i">+import androidx.compose.foundation.layout.*
</a><a href="#h12-0-8" id="h12-0-8" class="i">+import androidx.compose.foundation.lazy.LazyColumn
</a><a href="#h12-0-9" id="h12-0-9" class="i">+import androidx.compose.foundation.lazy.items
</a><a href="#h12-0-10" id="h12-0-10" class="i">+import androidx.compose.material.icons.Icons
</a><a href="#h12-0-11" id="h12-0-11" class="i">+import androidx.compose.material.icons.filled.Android
</a><a href="#h12-0-12" id="h12-0-12" class="i">+import androidx.compose.material3.*
</a><a href="#h12-0-13" id="h12-0-13" class="i">+import androidx.compose.runtime.*
</a><a href="#h12-0-14" id="h12-0-14" class="i">+import androidx.compose.ui.Alignment
</a><a href="#h12-0-15" id="h12-0-15" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h12-0-16" id="h12-0-16" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h12-0-17" id="h12-0-17" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h12-0-18" id="h12-0-18" class="i">+import androidx.compose.ui.window.Dialog
</a><a href="#h12-0-19" id="h12-0-19" class="i">+import com.google.gson.JsonParser
</a><a href="#h12-0-20" id="h12-0-20" class="i">+import kotlinx.coroutines.Dispatchers
</a><a href="#h12-0-21" id="h12-0-21" class="i">+import kotlinx.coroutines.launch
</a><a href="#h12-0-22" id="h12-0-22" class="i">+import me.rhunk.snapenhance.manager.BuildConfig
</a><a href="#h12-0-23" id="h12-0-23" class="i">+import me.rhunk.snapenhance.manager.data.download.SEArtifact
</a><a href="#h12-0-24" id="h12-0-24" class="i">+import me.rhunk.snapenhance.manager.data.download.SEVersion
</a><a href="#h12-0-25" id="h12-0-25" class="i">+import me.rhunk.snapenhance.manager.ui.Tab
</a><a href="#h12-0-26" id="h12-0-26" class="i">+import okhttp3.OkHttpClient
</a><a href="#h12-0-27" id="h12-0-27" class="i">+import okhttp3.Request
</a><a href="#h12-0-28" id="h12-0-28" class="i">+import java.text.SimpleDateFormat
</a><a href="#h12-0-29" id="h12-0-29" class="i">+import java.util.Locale
</a><a href="#h12-0-30" id="h12-0-30" class="i">+
</a><a href="#h12-0-31" id="h12-0-31" class="i">+
</a><a href="#h12-0-32" id="h12-0-32" class="i">+class SEDownloadTab : Tab(&quot;se_downloads&quot;) {
</a><a href="#h12-0-33" id="h12-0-33" class="i">+    private fun fetchSEReleases(): List&lt;SEVersion&gt;? {
</a><a href="#h12-0-34" id="h12-0-34" class="i">+        return runCatching {
</a><a href="#h12-0-35" id="h12-0-35" class="i">+            val endpoint =
</a><a href="#h12-0-36" id="h12-0-36" class="i">+                Request.Builder().url(&quot;https://api.github.com/repos/rhunk/SnapEnhance/releases&quot;)
</a><a href="#h12-0-37" id="h12-0-37" class="i">+                    .build()
</a><a href="#h12-0-38" id="h12-0-38" class="i">+            val response = OkHttpClient().newCall(endpoint).execute()
</a><a href="#h12-0-39" id="h12-0-39" class="i">+            if (!response.isSuccessful) return null
</a><a href="#h12-0-40" id="h12-0-40" class="i">+
</a><a href="#h12-0-41" id="h12-0-41" class="i">+            val releases = JsonParser.parseString(response.body.string()).asJsonArray.also {
</a><a href="#h12-0-42" id="h12-0-42" class="i">+                if (it.size() == 0) return null
</a><a href="#h12-0-43" id="h12-0-43" class="i">+            }
</a><a href="#h12-0-44" id="h12-0-44" class="i">+            val isoDateFormat = SimpleDateFormat(&quot;yyyy-MM-dd&#39;T&#39;HH:mm:ss&#39;Z&#39;&quot;, Locale.getDefault())
</a><a href="#h12-0-45" id="h12-0-45" class="i">+
</a><a href="#h12-0-46" id="h12-0-46" class="i">+            releases.map { releaseObject -&gt;
</a><a href="#h12-0-47" id="h12-0-47" class="i">+                val release = releaseObject.asJsonObject
</a><a href="#h12-0-48" id="h12-0-48" class="i">+                val versionName = release.getAsJsonPrimitive(&quot;tag_name&quot;).asString
</a><a href="#h12-0-49" id="h12-0-49" class="i">+                val releaseDate = release.getAsJsonPrimitive(&quot;published_at&quot;).asString.let { time -&gt;
</a><a href="#h12-0-50" id="h12-0-50" class="i">+                    isoDateFormat.parse(time)?.let { date -&gt;
</a><a href="#h12-0-51" id="h12-0-51" class="i">+                        SimpleDateFormat(&quot;dd MMM yyyy&quot;, Locale.getDefault()).format(date)
</a><a href="#h12-0-52" id="h12-0-52" class="i">+                    } ?: time
</a><a href="#h12-0-53" id="h12-0-53" class="i">+                }
</a><a href="#h12-0-54" id="h12-0-54" class="i">+                val downloadAssets = release.getAsJsonArray(&quot;assets&quot;).associate { asset -&gt;
</a><a href="#h12-0-55" id="h12-0-55" class="i">+                    val assetObject = asset.asJsonObject
</a><a href="#h12-0-56" id="h12-0-56" class="i">+                    SEArtifact(
</a><a href="#h12-0-57" id="h12-0-57" class="i">+                        fileName = assetObject.getAsJsonPrimitive(&quot;name&quot;).asString,
</a><a href="#h12-0-58" id="h12-0-58" class="i">+                        size = assetObject.getAsJsonPrimitive(&quot;size&quot;).asLong,
</a><a href="#h12-0-59" id="h12-0-59" class="i">+                        downloadUrl = assetObject.getAsJsonPrimitive(&quot;browser_download_url&quot;).asString
</a><a href="#h12-0-60" id="h12-0-60" class="i">+                    ).let { it.fileName to it }
</a><a href="#h12-0-61" id="h12-0-61" class="i">+                }
</a><a href="#h12-0-62" id="h12-0-62" class="i">+                SEVersion(versionName, releaseDate, downloadAssets)
</a><a href="#h12-0-63" id="h12-0-63" class="i">+            }
</a><a href="#h12-0-64" id="h12-0-64" class="i">+        }.onFailure {
</a><a href="#h12-0-65" id="h12-0-65" class="i">+            it.printStackTrace()
</a><a href="#h12-0-66" id="h12-0-66" class="i">+        }.getOrNull()
</a><a href="#h12-0-67" id="h12-0-67" class="i">+    }
</a><a href="#h12-0-68" id="h12-0-68" class="i">+
</a><a href="#h12-0-69" id="h12-0-69" class="i">+    override fun init(activity: ComponentActivity) {
</a><a href="#h12-0-70" id="h12-0-70" class="i">+        super.init(activity)
</a><a href="#h12-0-71" id="h12-0-71" class="i">+        registerNestedTab(InstallAppTab::class)
</a><a href="#h12-0-72" id="h12-0-72" class="i">+    }
</a><a href="#h12-0-73" id="h12-0-73" class="i">+
</a><a href="#h12-0-74" id="h12-0-74" class="i">+    @Composable
</a><a href="#h12-0-75" id="h12-0-75" class="i">+    private fun DowngradeNoticeDialog(onDismiss: () -&gt; Unit, onSuccess: () -&gt; Unit) {
</a><a href="#h12-0-76" id="h12-0-76" class="i">+        Card {
</a><a href="#h12-0-77" id="h12-0-77" class="i">+            Column(
</a><a href="#h12-0-78" id="h12-0-78" class="i">+                modifier = Modifier
</a><a href="#h12-0-79" id="h12-0-79" class="i">+                    .fillMaxWidth()
</a><a href="#h12-0-80" id="h12-0-80" class="i">+                    .padding(16.dp),
</a><a href="#h12-0-81" id="h12-0-81" class="i">+                horizontalAlignment = Alignment.CenterHorizontally,
</a><a href="#h12-0-82" id="h12-0-82" class="i">+                verticalArrangement = Arrangement.spacedBy(16.dp),
</a><a href="#h12-0-83" id="h12-0-83" class="i">+            ) {
</a><a href="#h12-0-84" id="h12-0-84" class="i">+                Text(text = &quot;Downgrade Notice&quot;, fontSize = 24.sp)
</a><a href="#h12-0-85" id="h12-0-85" class="i">+                Text(text = &quot;You are about to update the app. If you&#39;re installing an older version over a newer one, make sure you have CorePatch installed. Otherwise, you will need to uninstall and install.&quot;, fontSize = 12.sp)
</a><a href="#h12-0-86" id="h12-0-86" class="i">+            }
</a><a href="#h12-0-87" id="h12-0-87" class="i">+            Row(
</a><a href="#h12-0-88" id="h12-0-88" class="i">+                modifier = Modifier
</a><a href="#h12-0-89" id="h12-0-89" class="i">+                    .fillMaxWidth()
</a><a href="#h12-0-90" id="h12-0-90" class="i">+                    .padding(16.dp),
</a><a href="#h12-0-91" id="h12-0-91" class="i">+                horizontalArrangement = Arrangement.SpaceAround
</a><a href="#h12-0-92" id="h12-0-92" class="i">+            ) {
</a><a href="#h12-0-93" id="h12-0-93" class="i">+                Button(onClick = onDismiss) {
</a><a href="#h12-0-94" id="h12-0-94" class="i">+                    Text(text = &quot;Cancel&quot;)
</a><a href="#h12-0-95" id="h12-0-95" class="i">+                }
</a><a href="#h12-0-96" id="h12-0-96" class="i">+                Button(onClick = onSuccess) {
</a><a href="#h12-0-97" id="h12-0-97" class="i">+                    Text(text = &quot;Continue&quot;)
</a><a href="#h12-0-98" id="h12-0-98" class="i">+                }
</a><a href="#h12-0-99" id="h12-0-99" class="i">+            }
</a><a href="#h12-0-100" id="h12-0-100" class="i">+        }
</a><a href="#h12-0-101" id="h12-0-101" class="i">+    }
</a><a href="#h12-0-102" id="h12-0-102" class="i">+
</a><a href="#h12-0-103" id="h12-0-103" class="i">+    @Composable
</a><a href="#h12-0-104" id="h12-0-104" class="i">+    override fun Content() {
</a><a href="#h12-0-105" id="h12-0-105" class="i">+        val coroutineScope = rememberCoroutineScope()
</a><a href="#h12-0-106" id="h12-0-106" class="i">+        val snapEnhanceReleases = remember {
</a><a href="#h12-0-107" id="h12-0-107" class="i">+            mutableStateOf(null as List&lt;SEVersion&gt;?)
</a><a href="#h12-0-108" id="h12-0-108" class="i">+        }
</a><a href="#h12-0-109" id="h12-0-109" class="i">+
</a><a href="#h12-0-110" id="h12-0-110" class="i">+        var selectedVersion by remember { mutableStateOf(null as SEVersion?) }
</a><a href="#h12-0-111" id="h12-0-111" class="i">+        var selectedArtifact by remember { mutableStateOf(null as SEArtifact?) }
</a><a href="#h12-0-112" id="h12-0-112" class="i">+        val appPackageName = remember { sharedConfig.snapEnhancePackageName ?: BuildConfig.APPLICATION_ID }
</a><a href="#h12-0-113" id="h12-0-113" class="i">+        val isAppInstalled = remember { runCatching { activity.packageManager.getPackageInfo(appPackageName, 0) != null }.getOrNull() != null }
</a><a href="#h12-0-114" id="h12-0-114" class="i">+
</a><a href="#h12-0-115" id="h12-0-115" class="i">+        var showDowngradeNotice by remember { mutableStateOf(false) }
</a><a href="#h12-0-116" id="h12-0-116" class="i">+
</a><a href="#h12-0-117" id="h12-0-117" class="i">+        fun triggerPackageInstallation(shouldUninstall: Boolean) {
</a><a href="#h12-0-118" id="h12-0-118" class="i">+            navigation.navigateTo(InstallAppTab::class, Bundle().apply {
</a><a href="#h12-0-119" id="h12-0-119" class="i">+                putParcelable(&quot;artifact&quot;, selectedArtifact)
</a><a href="#h12-0-120" id="h12-0-120" class="i">+                putString(
</a><a href="#h12-0-121" id="h12-0-121" class="i">+                    &quot;appPackage&quot;,
</a><a href="#h12-0-122" id="h12-0-122" class="i">+                    sharedConfig.snapEnhancePackageName ?: BuildConfig.APPLICATION_ID
</a><a href="#h12-0-123" id="h12-0-123" class="i">+                )
</a><a href="#h12-0-124" id="h12-0-124" class="i">+                putBoolean(&quot;uninstall&quot;, shouldUninstall)
</a><a href="#h12-0-125" id="h12-0-125" class="i">+            })
</a><a href="#h12-0-126" id="h12-0-126" class="i">+        }
</a><a href="#h12-0-127" id="h12-0-127" class="i">+
</a><a href="#h12-0-128" id="h12-0-128" class="i">+        if (showDowngradeNotice) {
</a><a href="#h12-0-129" id="h12-0-129" class="i">+            Dialog(onDismissRequest = { showDowngradeNotice = false }) {
</a><a href="#h12-0-130" id="h12-0-130" class="i">+                DowngradeNoticeDialog(onDismiss = { showDowngradeNotice = false }, onSuccess = {
</a><a href="#h12-0-131" id="h12-0-131" class="i">+                    triggerPackageInstallation(false)
</a><a href="#h12-0-132" id="h12-0-132" class="i">+                })
</a><a href="#h12-0-133" id="h12-0-133" class="i">+            }
</a><a href="#h12-0-134" id="h12-0-134" class="i">+        }
</a><a href="#h12-0-135" id="h12-0-135" class="i">+
</a><a href="#h12-0-136" id="h12-0-136" class="i">+        Column(
</a><a href="#h12-0-137" id="h12-0-137" class="i">+            modifier = Modifier
</a><a href="#h12-0-138" id="h12-0-138" class="i">+                .fillMaxWidth()
</a><a href="#h12-0-139" id="h12-0-139" class="i">+                .padding(16.dp),
</a><a href="#h12-0-140" id="h12-0-140" class="i">+            verticalArrangement = Arrangement.spacedBy(16.dp),
</a><a href="#h12-0-141" id="h12-0-141" class="i">+            horizontalAlignment = Alignment.CenterHorizontally
</a><a href="#h12-0-142" id="h12-0-142" class="i">+        ) {
</a><a href="#h12-0-143" id="h12-0-143" class="i">+            Text(text = &quot;SnapEnhance Builds&quot;)
</a><a href="#h12-0-144" id="h12-0-144" class="i">+
</a><a href="#h12-0-145" id="h12-0-145" class="i">+            LazyColumn(
</a><a href="#h12-0-146" id="h12-0-146" class="i">+                modifier = Modifier
</a><a href="#h12-0-147" id="h12-0-147" class="i">+                    .fillMaxWidth()
</a><a href="#h12-0-148" id="h12-0-148" class="i">+                    .fillMaxHeight(0.8f),
</a><a href="#h12-0-149" id="h12-0-149" class="i">+                verticalArrangement = Arrangement.spacedBy(10.dp)
</a><a href="#h12-0-150" id="h12-0-150" class="i">+            ) {
</a><a href="#h12-0-151" id="h12-0-151" class="i">+                item {
</a><a href="#h12-0-152" id="h12-0-152" class="i">+                    if (snapEnhanceReleases.value == null) {
</a><a href="#h12-0-153" id="h12-0-153" class="i">+                        Row(
</a><a href="#h12-0-154" id="h12-0-154" class="i">+                            horizontalArrangement = Arrangement.Center,
</a><a href="#h12-0-155" id="h12-0-155" class="i">+                            modifier = Modifier
</a><a href="#h12-0-156" id="h12-0-156" class="i">+                                .fillMaxWidth()
</a><a href="#h12-0-157" id="h12-0-157" class="i">+                                .padding(16.dp)
</a><a href="#h12-0-158" id="h12-0-158" class="i">+                        ) {
</a><a href="#h12-0-159" id="h12-0-159" class="i">+                            CircularProgressIndicator()
</a><a href="#h12-0-160" id="h12-0-160" class="i">+                        }
</a><a href="#h12-0-161" id="h12-0-161" class="i">+                    }
</a><a href="#h12-0-162" id="h12-0-162" class="i">+                }
</a><a href="#h12-0-163" id="h12-0-163" class="i">+                items(snapEnhanceReleases.value ?: listOf()) { version -&gt;
</a><a href="#h12-0-164" id="h12-0-164" class="i">+                    OutlinedCard(
</a><a href="#h12-0-165" id="h12-0-165" class="i">+                        shape = MaterialTheme.shapes.small,
</a><a href="#h12-0-166" id="h12-0-166" class="i">+                        modifier = Modifier
</a><a href="#h12-0-167" id="h12-0-167" class="i">+                            .clickable {
</a><a href="#h12-0-168" id="h12-0-168" class="i">+                                selectedArtifact =
</a><a href="#h12-0-169" id="h12-0-169" class="i">+                                    if (selectedVersion != version) null else selectedArtifact
</a><a href="#h12-0-170" id="h12-0-170" class="i">+                                selectedVersion = if (selectedVersion == version) null else version
</a><a href="#h12-0-171" id="h12-0-171" class="i">+                            },
</a><a href="#h12-0-172" id="h12-0-172" class="i">+                    ) {
</a><a href="#h12-0-173" id="h12-0-173" class="i">+                        Row(
</a><a href="#h12-0-174" id="h12-0-174" class="i">+                            modifier = Modifier
</a><a href="#h12-0-175" id="h12-0-175" class="i">+                                .fillMaxWidth()
</a><a href="#h12-0-176" id="h12-0-176" class="i">+                                .padding(16.dp),
</a><a href="#h12-0-177" id="h12-0-177" class="i">+                            verticalAlignment = Alignment.CenterVertically
</a><a href="#h12-0-178" id="h12-0-178" class="i">+                        ) {
</a><a href="#h12-0-179" id="h12-0-179" class="i">+                            Column {
</a><a href="#h12-0-180" id="h12-0-180" class="i">+                                Text(text = version.versionName, fontSize = 24.sp)
</a><a href="#h12-0-181" id="h12-0-181" class="i">+                                Text(text = &quot;Release ${version.releaseDate}&quot;, fontSize = 12.sp)
</a><a href="#h12-0-182" id="h12-0-182" class="i">+                            }
</a><a href="#h12-0-183" id="h12-0-183" class="i">+                            Row(
</a><a href="#h12-0-184" id="h12-0-184" class="i">+                                modifier = Modifier
</a><a href="#h12-0-185" id="h12-0-185" class="i">+                                    .weight(1f),
</a><a href="#h12-0-186" id="h12-0-186" class="i">+                                horizontalArrangement = Arrangement.End,
</a><a href="#h12-0-187" id="h12-0-187" class="i">+                                verticalAlignment = Alignment.CenterVertically
</a><a href="#h12-0-188" id="h12-0-188" class="i">+                            ) {
</a><a href="#h12-0-189" id="h12-0-189" class="i">+                                Text(text = &quot;${version.downloadAssets.size} assets&quot;, fontSize = 12.sp)
</a><a href="#h12-0-190" id="h12-0-190" class="i">+                            }
</a><a href="#h12-0-191" id="h12-0-191" class="i">+                        }
</a><a href="#h12-0-192" id="h12-0-192" class="i">+                    }
</a><a href="#h12-0-193" id="h12-0-193" class="i">+
</a><a href="#h12-0-194" id="h12-0-194" class="i">+                    selectedVersion?.takeIf { it == version }?.let { selVersion -&gt;
</a><a href="#h12-0-195" id="h12-0-195" class="i">+                        Column(
</a><a href="#h12-0-196" id="h12-0-196" class="i">+                            modifier = Modifier
</a><a href="#h12-0-197" id="h12-0-197" class="i">+                                .fillMaxWidth()
</a><a href="#h12-0-198" id="h12-0-198" class="i">+                                .padding(10.dp),
</a><a href="#h12-0-199" id="h12-0-199" class="i">+                            verticalArrangement = Arrangement.spacedBy(16.dp),
</a><a href="#h12-0-200" id="h12-0-200" class="i">+                        ) {
</a><a href="#h12-0-201" id="h12-0-201" class="i">+                            selVersion.downloadAssets.values.forEach { artifact -&gt;
</a><a href="#h12-0-202" id="h12-0-202" class="i">+                                Row(
</a><a href="#h12-0-203" id="h12-0-203" class="i">+                                    modifier = Modifier
</a><a href="#h12-0-204" id="h12-0-204" class="i">+                                        .fillMaxWidth()
</a><a href="#h12-0-205" id="h12-0-205" class="i">+                                        .border(
</a><a href="#h12-0-206" id="h12-0-206" class="i">+                                            shape = MaterialTheme.shapes.medium,
</a><a href="#h12-0-207" id="h12-0-207" class="i">+                                            width = 1.dp,
</a><a href="#h12-0-208" id="h12-0-208" class="i">+                                            color = MaterialTheme.colorScheme.onSurfaceVariant
</a><a href="#h12-0-209" id="h12-0-209" class="i">+                                        )
</a><a href="#h12-0-210" id="h12-0-210" class="i">+                                        .clickable {
</a><a href="#h12-0-211" id="h12-0-211" class="i">+                                            selectedArtifact =
</a><a href="#h12-0-212" id="h12-0-212" class="i">+                                                if (selectedArtifact == artifact) null else artifact
</a><a href="#h12-0-213" id="h12-0-213" class="i">+                                        }
</a><a href="#h12-0-214" id="h12-0-214" class="i">+                                        .background(
</a><a href="#h12-0-215" id="h12-0-215" class="i">+                                            if (selectedArtifact == artifact) MaterialTheme.colorScheme.surfaceVariant else MaterialTheme.colorScheme.surface,
</a><a href="#h12-0-216" id="h12-0-216" class="i">+                                            shape = MaterialTheme.shapes.medium
</a><a href="#h12-0-217" id="h12-0-217" class="i">+                                        )
</a><a href="#h12-0-218" id="h12-0-218" class="i">+                                        .padding(16.dp),
</a><a href="#h12-0-219" id="h12-0-219" class="i">+                                    verticalAlignment = Alignment.CenterVertically
</a><a href="#h12-0-220" id="h12-0-220" class="i">+                                ) {
</a><a href="#h12-0-221" id="h12-0-221" class="i">+                                    Icon(imageVector = Icons.Default.Android, contentDescription = null, modifier = Modifier.padding(start = 2.dp, end = 2.dp))
</a><a href="#h12-0-222" id="h12-0-222" class="i">+                                    Column(
</a><a href="#h12-0-223" id="h12-0-223" class="i">+                                        modifier = Modifier
</a><a href="#h12-0-224" id="h12-0-224" class="i">+                                            .padding(start = 13.dp)
</a><a href="#h12-0-225" id="h12-0-225" class="i">+                                    ) {
</a><a href="#h12-0-226" id="h12-0-226" class="i">+                                        Text(text = artifact.fileName, fontSize = 15.sp)
</a><a href="#h12-0-227" id="h12-0-227" class="i">+                                        Text(
</a><a href="#h12-0-228" id="h12-0-228" class="i">+                                            text = &quot;${artifact.size / 1024 / 1024} MB&quot;,
</a><a href="#h12-0-229" id="h12-0-229" class="i">+                                            fontSize = 10.sp
</a><a href="#h12-0-230" id="h12-0-230" class="i">+                                        )
</a><a href="#h12-0-231" id="h12-0-231" class="i">+                                    }
</a><a href="#h12-0-232" id="h12-0-232" class="i">+                                }
</a><a href="#h12-0-233" id="h12-0-233" class="i">+                            }
</a><a href="#h12-0-234" id="h12-0-234" class="i">+                        }
</a><a href="#h12-0-235" id="h12-0-235" class="i">+                    }
</a><a href="#h12-0-236" id="h12-0-236" class="i">+                }
</a><a href="#h12-0-237" id="h12-0-237" class="i">+            }
</a><a href="#h12-0-238" id="h12-0-238" class="i">+            Column(
</a><a href="#h12-0-239" id="h12-0-239" class="i">+                modifier = Modifier
</a><a href="#h12-0-240" id="h12-0-240" class="i">+                    .fillMaxWidth(),
</a><a href="#h12-0-241" id="h12-0-241" class="i">+                horizontalAlignment = Alignment.CenterHorizontally
</a><a href="#h12-0-242" id="h12-0-242" class="i">+            ) {
</a><a href="#h12-0-243" id="h12-0-243" class="i">+                if (isAppInstalled) {
</a><a href="#h12-0-244" id="h12-0-244" class="i">+                    Button(
</a><a href="#h12-0-245" id="h12-0-245" class="i">+                        onClick = {
</a><a href="#h12-0-246" id="h12-0-246" class="i">+                            triggerPackageInstallation(true)
</a><a href="#h12-0-247" id="h12-0-247" class="i">+                        },
</a><a href="#h12-0-248" id="h12-0-248" class="i">+                        enabled = selectedVersion != null &amp;&amp; selectedArtifact != null,
</a><a href="#h12-0-249" id="h12-0-249" class="i">+                        modifier = Modifier.fillMaxWidth()
</a><a href="#h12-0-250" id="h12-0-250" class="i">+                    ) {
</a><a href="#h12-0-251" id="h12-0-251" class="i">+                        Text(text = &quot;Uninstall &amp; Install&quot;)
</a><a href="#h12-0-252" id="h12-0-252" class="i">+                    }
</a><a href="#h12-0-253" id="h12-0-253" class="i">+                }
</a><a href="#h12-0-254" id="h12-0-254" class="i">+                Button(
</a><a href="#h12-0-255" id="h12-0-255" class="i">+                    onClick = {
</a><a href="#h12-0-256" id="h12-0-256" class="i">+                        if (isAppInstalled) {
</a><a href="#h12-0-257" id="h12-0-257" class="i">+                            showDowngradeNotice = true
</a><a href="#h12-0-258" id="h12-0-258" class="i">+                        } else {
</a><a href="#h12-0-259" id="h12-0-259" class="i">+                            triggerPackageInstallation(false)
</a><a href="#h12-0-260" id="h12-0-260" class="i">+                        }
</a><a href="#h12-0-261" id="h12-0-261" class="i">+                    },
</a><a href="#h12-0-262" id="h12-0-262" class="i">+                    enabled = selectedVersion != null &amp;&amp; selectedArtifact != null,
</a><a href="#h12-0-263" id="h12-0-263" class="i">+                    modifier = Modifier.fillMaxWidth()
</a><a href="#h12-0-264" id="h12-0-264" class="i">+                ) {
</a><a href="#h12-0-265" id="h12-0-265" class="i">+                    Text(text = if (isAppInstalled) &quot;Update&quot; else &quot;Install&quot;)
</a><a href="#h12-0-266" id="h12-0-266" class="i">+                }
</a><a href="#h12-0-267" id="h12-0-267" class="i">+            }
</a><a href="#h12-0-268" id="h12-0-268" class="i">+        }
</a><a href="#h12-0-269" id="h12-0-269" class="i">+
</a><a href="#h12-0-270" id="h12-0-270" class="i">+        LaunchedEffect(Unit) {
</a><a href="#h12-0-271" id="h12-0-271" class="i">+            coroutineScope.launch(Dispatchers.IO) {
</a><a href="#h12-0-272" id="h12-0-272" class="i">+                snapEnhanceReleases.value = fetchSEReleases()
</a><a href="#h12-0-273" id="h12-0-273" class="i">+            }
</a><a href="#h12-0-274" id="h12-0-274" class="i">+        }
</a><a href="#h12-0-275" id="h12-0-275" class="i">+    }
</a><a href="#h12-0-276" id="h12-0-276" class="i">+}</a><a href="#h12-0-277" id="h12-0-277" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h13" href="../file/manager/src/main/res/xml/provider_paths.xml.html">manager/src/main/res/xml/provider_paths.xml</a> b/<a href="../file/manager/src/main/res/xml/provider_paths.xml.html">manager/src/main/res/xml/provider_paths.xml</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,4 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</a><a href="#h13-0-1" id="h13-0-1" class="i">+&lt;paths&gt;
</a><a href="#h13-0-2" id="h13-0-2" class="i">+    &lt;external-path name=&quot;external_files&quot; path=&quot;.&quot;/&gt;
</a><a href="#h13-0-3" id="h13-0-3" class="i">+&lt;/paths&gt;
</a></pre>
</div>
</body>
</html>
