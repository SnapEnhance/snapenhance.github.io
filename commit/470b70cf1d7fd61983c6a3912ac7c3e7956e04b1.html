<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>feat(scripting): interface builder - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/.gitmodules.html">Submodules</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/470b70cf1d7fd61983c6a3912ac7c3e7956e04b1.html">470b70cf1d7fd61983c6a3912ac7c3e7956e04b1</a>
<b>parent</b> <a href="../commit/14d516975857dae79a784c4662f67d403c57e256.html">14d516975857dae79a784c4662f67d403c57e256</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Tue,  3 Oct 2023 00:15:23 +0200

feat(scripting): interface builder

<b>Diffstat:</b>
<table><tr><td class="D">D</td><td><a href="#h0">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteManagerIPC.kt</a></td><td> | </td><td class="num">54</td><td><span class="i"></span><span class="d">------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteScriptManager.kt</a></td><td> | </td><td class="num">16</td><td><span class="i">+++++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="A">A</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/RemoteManagerIPC.kt</a></td><td> | </td><td class="num">56</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/InterfaceManager.kt</a></td><td> | </td><td class="num">80</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/Node.kt</a></td><td> | </td><td class="num">42</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/NodeType.kt</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h6">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/impl/RowColumnNode.kt</a></td><td> | </td><td class="num">48</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a></td><td> | </td><td class="num">181</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">core/src/main/kotlin/me/rhunk/snapenhance/ModContext.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h9">core/src/main/kotlin/me/rhunk/snapenhance/scripting/IPCInterface.kt</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">core/src/main/kotlin/me/rhunk/snapenhance/scripting/JSModule.kt</a></td><td> | </td><td class="num">21</td><td><span class="i">++++++++++++++++++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h11">core/src/main/kotlin/me/rhunk/snapenhance/scripting/ScriptRuntime.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h12">core/src/main/kotlin/me/rhunk/snapenhance/scripting/core/CoreScriptRuntime.kt</a></td><td> | </td><td class="num">7</td><td><span class="i">++++</span><span class="d">---</span></td></tr>
</table></pre><pre>13 files changed, 443 insertions(+), 80 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteManagerIPC.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteManagerIPC.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteManagerIPC.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteManagerIPC.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -1,53 +0,0 @@
</a><a href="#h0-0-0" id="h0-0-0" class="d">-package me.rhunk.snapenhance.scripting
</a><a href="#h0-0-1" id="h0-0-1" class="d">-
</a><a href="#h0-0-2" id="h0-0-2" class="d">-import android.os.DeadObjectException
</a><a href="#h0-0-3" id="h0-0-3" class="d">-import me.rhunk.snapenhance.bridge.scripting.IPCListener
</a><a href="#h0-0-4" id="h0-0-4" class="d">-import me.rhunk.snapenhance.core.logger.AbstractLogger
</a><a href="#h0-0-5" id="h0-0-5" class="d">-import me.rhunk.snapenhance.scripting.type.ModuleInfo
</a><a href="#h0-0-6" id="h0-0-6" class="d">-import java.util.concurrent.ConcurrentHashMap
</a><a href="#h0-0-7" id="h0-0-7" class="d">-
</a><a href="#h0-0-8" id="h0-0-8" class="d">-typealias IPCListeners = ConcurrentHashMap&lt;String, MutableMap&lt;String, MutableSet&lt;IPCListener&gt;&gt;&gt;  // channel, eventName -&gt; listeners
</a><a href="#h0-0-9" id="h0-0-9" class="d">-
</a><a href="#h0-0-10" id="h0-0-10" class="d">-class RemoteManagerIPC(
</a><a href="#h0-0-11" id="h0-0-11" class="d">-    private val moduleInfo: ModuleInfo,
</a><a href="#h0-0-12" id="h0-0-12" class="d">-    private val logger: AbstractLogger,
</a><a href="#h0-0-13" id="h0-0-13" class="d">-    private val ipcListeners: IPCListeners = ConcurrentHashMap(),
</a><a href="#h0-0-14" id="h0-0-14" class="d">-) : IPCInterface() {
</a><a href="#h0-0-15" id="h0-0-15" class="d">-    companion object {
</a><a href="#h0-0-16" id="h0-0-16" class="d">-        private const val TAG = &quot;RemoteManagerIPC&quot;
</a><a href="#h0-0-17" id="h0-0-17" class="d">-    }
</a><a href="#h0-0-18" id="h0-0-18" class="d">-
</a><a href="#h0-0-19" id="h0-0-19" class="d">-    override fun on(eventName: String, listener: Listener) {
</a><a href="#h0-0-20" id="h0-0-20" class="d">-        onBroadcast(moduleInfo.name, eventName, listener)
</a><a href="#h0-0-21" id="h0-0-21" class="d">-    }
</a><a href="#h0-0-22" id="h0-0-22" class="d">-
</a><a href="#h0-0-23" id="h0-0-23" class="d">-    override fun emit(eventName: String, vararg args: String?) {
</a><a href="#h0-0-24" id="h0-0-24" class="d">-        emit(moduleInfo.name, eventName, *args)
</a><a href="#h0-0-25" id="h0-0-25" class="d">-    }
</a><a href="#h0-0-26" id="h0-0-26" class="d">-
</a><a href="#h0-0-27" id="h0-0-27" class="d">-    override fun onBroadcast(channel: String, eventName: String, listener: Listener) {
</a><a href="#h0-0-28" id="h0-0-28" class="d">-        ipcListeners.getOrPut(channel) { mutableMapOf() }.getOrPut(eventName) { mutableSetOf() }.add(object: IPCListener.Stub() {
</a><a href="#h0-0-29" id="h0-0-29" class="d">-            override fun onMessage(args: Array&lt;out String?&gt;) {
</a><a href="#h0-0-30" id="h0-0-30" class="d">-                try {
</a><a href="#h0-0-31" id="h0-0-31" class="d">-                    listener(args)
</a><a href="#h0-0-32" id="h0-0-32" class="d">-                } catch (doe: DeadObjectException) {
</a><a href="#h0-0-33" id="h0-0-33" class="d">-                    ipcListeners[channel]?.get(eventName)?.remove(this)
</a><a href="#h0-0-34" id="h0-0-34" class="d">-                } catch (t: Throwable) {
</a><a href="#h0-0-35" id="h0-0-35" class="d">-                    logger.error(&quot;Failed to receive message for channel: $channel, event: $eventName&quot;, t, TAG)
</a><a href="#h0-0-36" id="h0-0-36" class="d">-                }
</a><a href="#h0-0-37" id="h0-0-37" class="d">-            }
</a><a href="#h0-0-38" id="h0-0-38" class="d">-        })
</a><a href="#h0-0-39" id="h0-0-39" class="d">-    }
</a><a href="#h0-0-40" id="h0-0-40" class="d">-
</a><a href="#h0-0-41" id="h0-0-41" class="d">-    override fun broadcast(channel: String, eventName: String, vararg args: String?) {
</a><a href="#h0-0-42" id="h0-0-42" class="d">-        ipcListeners[channel]?.get(eventName)?.toList()?.forEach {
</a><a href="#h0-0-43" id="h0-0-43" class="d">-            try {
</a><a href="#h0-0-44" id="h0-0-44" class="d">-                it.onMessage(args)
</a><a href="#h0-0-45" id="h0-0-45" class="d">-            } catch (doe: DeadObjectException) {
</a><a href="#h0-0-46" id="h0-0-46" class="d">-                ipcListeners[channel]?.get(eventName)?.remove(it)
</a><a href="#h0-0-47" id="h0-0-47" class="d">-            } catch (t: Throwable) {
</a><a href="#h0-0-48" id="h0-0-48" class="d">-                logger.error(&quot;Failed to send message for channel: $channel, event: $eventName&quot;, t, TAG)
</a><a href="#h0-0-49" id="h0-0-49" class="d">-            }
</a><a href="#h0-0-50" id="h0-0-50" class="d">-        }
</a><a href="#h0-0-51" id="h0-0-51" class="d">-    }
</a><a href="#h0-0-52" id="h0-0-52" class="d">-}</a><a href="#h0-0-53" id="h0-0-53" class="d">-
\ No newline at end of file
</a><b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteScriptManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteScriptManager.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteScriptManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/RemoteScriptManager.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -5,13 +5,18 @@ import androidx.documentfile.provider.DocumentFile
</a> import me.rhunk.snapenhance.RemoteSideContext
 import me.rhunk.snapenhance.bridge.scripting.IPCListener
 import me.rhunk.snapenhance.bridge.scripting.IScripting
<a href="#h1-0-3" id="h1-0-3" class="i">+import me.rhunk.snapenhance.scripting.impl.IPCListeners
</a><a href="#h1-0-4" id="h1-0-4" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.InterfaceBuilder
</a><a href="#h1-0-5" id="h1-0-5" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.InterfaceManager
</a><a href="#h1-0-6" id="h1-0-6" class="i">+import me.rhunk.snapenhance.scripting.impl.RemoteManagerIPC
</a> import me.rhunk.snapenhance.scripting.type.ModuleInfo
 import java.io.InputStream
 
 class RemoteScriptManager(
     private val context: RemoteSideContext,
 ) : IScripting.Stub() {
<a href="#h1-0-13" id="h1-0-13" class="d">-    val runtime = ScriptRuntime(context.log, context.androidContext.classLoader)
</a><a href="#h1-0-14" id="h1-0-14" class="i">+    val runtime = ScriptRuntime(context.androidContext, context.log)
</a><a href="#h1-0-15" id="h1-0-15" class="i">+    private val userInterfaces = mutableMapOf&lt;String, MutableMap&lt;String, InterfaceBuilder&gt;&gt;()
</a> 
     private val cachedModuleInfo = mutableMapOf&lt;String, ModuleInfo&gt;()
     private val ipcListeners = IPCListeners()
<a href="#h1-1" id="h1-1" class="h">@@ -35,6 +40,11 @@ class RemoteScriptManager(
</a>     fun init() {
         runtime.buildModuleObject = { module -&gt;
             putConst(&quot;ipc&quot;, this, RemoteManagerIPC(module.moduleInfo, context.log, ipcListeners))
<a href="#h1-1-3" id="h1-1-3" class="i">+            putConst(&quot;im&quot;, this, InterfaceManager(module.moduleInfo, context.log) { name, interfaceBuilder -&gt;
</a><a href="#h1-1-4" id="h1-1-4" class="i">+                userInterfaces.getOrPut(module.moduleInfo.name) {
</a><a href="#h1-1-5" id="h1-1-5" class="i">+                    mutableMapOf()
</a><a href="#h1-1-6" id="h1-1-6" class="i">+                }[name] = interfaceBuilder
</a><a href="#h1-1-7" id="h1-1-7" class="i">+            })
</a>         }
 
         sync()
<a href="#h1-2" id="h1-2" class="h">@@ -47,6 +57,10 @@ class RemoteScriptManager(
</a>         }
     }
 
<a href="#h1-2-3" id="h1-2-3" class="i">+    fun getScriptInterface(scriptName: String, interfaceName: String)
</a><a href="#h1-2-4" id="h1-2-4" class="i">+            = userInterfaces[scriptName]?.get(interfaceName)
</a><a href="#h1-2-5" id="h1-2-5" class="i">+
</a><a href="#h1-2-6" id="h1-2-6" class="i">+
</a>     private fun &lt;R&gt; getScriptInputStream(name: String, callback: (InputStream?) -&gt; R): R {
         val file = getScriptsFolder()?.findFile(name) ?: return callback(null)
         return context.androidContext.contentResolver.openInputStream(file.uri)?.use(callback) ?: callback(null)
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/RemoteManagerIPC.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/RemoteManagerIPC.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/RemoteManagerIPC.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/RemoteManagerIPC.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -0,0 +1,55 @@
</a><a href="#h2-0-0" id="h2-0-0" class="i">+package me.rhunk.snapenhance.scripting.impl
</a><a href="#h2-0-1" id="h2-0-1" class="i">+
</a><a href="#h2-0-2" id="h2-0-2" class="i">+import android.os.DeadObjectException
</a><a href="#h2-0-3" id="h2-0-3" class="i">+import me.rhunk.snapenhance.bridge.scripting.IPCListener
</a><a href="#h2-0-4" id="h2-0-4" class="i">+import me.rhunk.snapenhance.core.logger.AbstractLogger
</a><a href="#h2-0-5" id="h2-0-5" class="i">+import me.rhunk.snapenhance.scripting.IPCInterface
</a><a href="#h2-0-6" id="h2-0-6" class="i">+import me.rhunk.snapenhance.scripting.Listener
</a><a href="#h2-0-7" id="h2-0-7" class="i">+import me.rhunk.snapenhance.scripting.type.ModuleInfo
</a><a href="#h2-0-8" id="h2-0-8" class="i">+import java.util.concurrent.ConcurrentHashMap
</a><a href="#h2-0-9" id="h2-0-9" class="i">+
</a><a href="#h2-0-10" id="h2-0-10" class="i">+typealias IPCListeners = ConcurrentHashMap&lt;String, MutableMap&lt;String, MutableSet&lt;IPCListener&gt;&gt;&gt;  // channel, eventName -&gt; listeners
</a><a href="#h2-0-11" id="h2-0-11" class="i">+
</a><a href="#h2-0-12" id="h2-0-12" class="i">+class RemoteManagerIPC(
</a><a href="#h2-0-13" id="h2-0-13" class="i">+    private val moduleInfo: ModuleInfo,
</a><a href="#h2-0-14" id="h2-0-14" class="i">+    private val logger: AbstractLogger,
</a><a href="#h2-0-15" id="h2-0-15" class="i">+    private val ipcListeners: IPCListeners = ConcurrentHashMap(),
</a><a href="#h2-0-16" id="h2-0-16" class="i">+) : IPCInterface() {
</a><a href="#h2-0-17" id="h2-0-17" class="i">+    companion object {
</a><a href="#h2-0-18" id="h2-0-18" class="i">+        private const val TAG = &quot;RemoteManagerIPC&quot;
</a><a href="#h2-0-19" id="h2-0-19" class="i">+    }
</a><a href="#h2-0-20" id="h2-0-20" class="i">+
</a><a href="#h2-0-21" id="h2-0-21" class="i">+    override fun on(eventName: String, listener: Listener) {
</a><a href="#h2-0-22" id="h2-0-22" class="i">+        onBroadcast(moduleInfo.name, eventName, listener)
</a><a href="#h2-0-23" id="h2-0-23" class="i">+    }
</a><a href="#h2-0-24" id="h2-0-24" class="i">+
</a><a href="#h2-0-25" id="h2-0-25" class="i">+    override fun emit(eventName: String, vararg args: String?) {
</a><a href="#h2-0-26" id="h2-0-26" class="i">+        emit(moduleInfo.name, eventName, *args)
</a><a href="#h2-0-27" id="h2-0-27" class="i">+    }
</a><a href="#h2-0-28" id="h2-0-28" class="i">+
</a><a href="#h2-0-29" id="h2-0-29" class="i">+    override fun onBroadcast(channel: String, eventName: String, listener: Listener) {
</a><a href="#h2-0-30" id="h2-0-30" class="i">+        ipcListeners.getOrPut(channel) { mutableMapOf() }.getOrPut(eventName) { mutableSetOf() }.add(object: IPCListener.Stub() {
</a><a href="#h2-0-31" id="h2-0-31" class="i">+            override fun onMessage(args: Array&lt;out String?&gt;) {
</a><a href="#h2-0-32" id="h2-0-32" class="i">+                try {
</a><a href="#h2-0-33" id="h2-0-33" class="i">+                    listener(args)
</a><a href="#h2-0-34" id="h2-0-34" class="i">+                } catch (doe: DeadObjectException) {
</a><a href="#h2-0-35" id="h2-0-35" class="i">+                    ipcListeners[channel]?.get(eventName)?.remove(this)
</a><a href="#h2-0-36" id="h2-0-36" class="i">+                } catch (t: Throwable) {
</a><a href="#h2-0-37" id="h2-0-37" class="i">+                    logger.error(&quot;Failed to receive message for channel: $channel, event: $eventName&quot;, t, TAG)
</a><a href="#h2-0-38" id="h2-0-38" class="i">+                }
</a><a href="#h2-0-39" id="h2-0-39" class="i">+            }
</a><a href="#h2-0-40" id="h2-0-40" class="i">+        })
</a><a href="#h2-0-41" id="h2-0-41" class="i">+    }
</a><a href="#h2-0-42" id="h2-0-42" class="i">+
</a><a href="#h2-0-43" id="h2-0-43" class="i">+    override fun broadcast(channel: String, eventName: String, vararg args: String?) {
</a><a href="#h2-0-44" id="h2-0-44" class="i">+        ipcListeners[channel]?.get(eventName)?.toList()?.forEach {
</a><a href="#h2-0-45" id="h2-0-45" class="i">+            try {
</a><a href="#h2-0-46" id="h2-0-46" class="i">+                it.onMessage(args)
</a><a href="#h2-0-47" id="h2-0-47" class="i">+            } catch (doe: DeadObjectException) {
</a><a href="#h2-0-48" id="h2-0-48" class="i">+                ipcListeners[channel]?.get(eventName)?.remove(it)
</a><a href="#h2-0-49" id="h2-0-49" class="i">+            } catch (t: Throwable) {
</a><a href="#h2-0-50" id="h2-0-50" class="i">+                logger.error(&quot;Failed to send message for channel: $channel, event: $eventName&quot;, t, TAG)
</a><a href="#h2-0-51" id="h2-0-51" class="i">+            }
</a><a href="#h2-0-52" id="h2-0-52" class="i">+        }
</a><a href="#h2-0-53" id="h2-0-53" class="i">+    }
</a><a href="#h2-0-54" id="h2-0-54" class="i">+}</a><a href="#h2-0-55" id="h2-0-55" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/InterfaceManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/InterfaceManager.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/InterfaceManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/InterfaceManager.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -0,0 +1,79 @@
</a><a href="#h3-0-0" id="h3-0-0" class="i">+package me.rhunk.snapenhance.scripting.impl.ui
</a><a href="#h3-0-1" id="h3-0-1" class="i">+
</a><a href="#h3-0-2" id="h3-0-2" class="i">+import me.rhunk.snapenhance.core.logger.AbstractLogger
</a><a href="#h3-0-3" id="h3-0-3" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.Node
</a><a href="#h3-0-4" id="h3-0-4" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.NodeType
</a><a href="#h3-0-5" id="h3-0-5" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.impl.RowColumnNode
</a><a href="#h3-0-6" id="h3-0-6" class="i">+import me.rhunk.snapenhance.scripting.type.ModuleInfo
</a><a href="#h3-0-7" id="h3-0-7" class="i">+import org.mozilla.javascript.Context
</a><a href="#h3-0-8" id="h3-0-8" class="i">+import org.mozilla.javascript.Function
</a><a href="#h3-0-9" id="h3-0-9" class="i">+import org.mozilla.javascript.annotations.JSFunction
</a><a href="#h3-0-10" id="h3-0-10" class="i">+
</a><a href="#h3-0-11" id="h3-0-11" class="i">+
</a><a href="#h3-0-12" id="h3-0-12" class="i">+class InterfaceBuilder {
</a><a href="#h3-0-13" id="h3-0-13" class="i">+    val nodes = mutableListOf&lt;Node&gt;()
</a><a href="#h3-0-14" id="h3-0-14" class="i">+    var onLaunchedCallback: (() -&gt; Unit)? = null
</a><a href="#h3-0-15" id="h3-0-15" class="i">+
</a><a href="#h3-0-16" id="h3-0-16" class="i">+
</a><a href="#h3-0-17" id="h3-0-17" class="i">+    private fun createNode(type: NodeType, block: Node.() -&gt; Unit): Node {
</a><a href="#h3-0-18" id="h3-0-18" class="i">+        return Node(type).apply(block).also { nodes.add(it) }
</a><a href="#h3-0-19" id="h3-0-19" class="i">+    }
</a><a href="#h3-0-20" id="h3-0-20" class="i">+
</a><a href="#h3-0-21" id="h3-0-21" class="i">+    fun onLaunched(block: () -&gt; Unit) {
</a><a href="#h3-0-22" id="h3-0-22" class="i">+        onLaunchedCallback = block
</a><a href="#h3-0-23" id="h3-0-23" class="i">+    }
</a><a href="#h3-0-24" id="h3-0-24" class="i">+
</a><a href="#h3-0-25" id="h3-0-25" class="i">+    fun row(block: (InterfaceBuilder) -&gt; Unit) = RowColumnNode(NodeType.ROW).apply {
</a><a href="#h3-0-26" id="h3-0-26" class="i">+        children.addAll(InterfaceBuilder().apply(block).nodes)
</a><a href="#h3-0-27" id="h3-0-27" class="i">+    }.also { nodes.add(it) }
</a><a href="#h3-0-28" id="h3-0-28" class="i">+
</a><a href="#h3-0-29" id="h3-0-29" class="i">+    fun column(block: (InterfaceBuilder) -&gt; Unit) = RowColumnNode(NodeType.COLUMN).apply {
</a><a href="#h3-0-30" id="h3-0-30" class="i">+        children.addAll(InterfaceBuilder().apply(block).nodes)
</a><a href="#h3-0-31" id="h3-0-31" class="i">+    }.also { nodes.add(it) }
</a><a href="#h3-0-32" id="h3-0-32" class="i">+
</a><a href="#h3-0-33" id="h3-0-33" class="i">+    fun text(text: String) = createNode(NodeType.TEXT) {
</a><a href="#h3-0-34" id="h3-0-34" class="i">+        label(text)
</a><a href="#h3-0-35" id="h3-0-35" class="i">+    }
</a><a href="#h3-0-36" id="h3-0-36" class="i">+
</a><a href="#h3-0-37" id="h3-0-37" class="i">+    fun switch(state: Boolean?, callback: (Boolean) -&gt; Unit) = createNode(NodeType.SWITCH) {
</a><a href="#h3-0-38" id="h3-0-38" class="i">+        attributes[&quot;state&quot;] = state
</a><a href="#h3-0-39" id="h3-0-39" class="i">+        attributes[&quot;callback&quot;] = callback
</a><a href="#h3-0-40" id="h3-0-40" class="i">+    }
</a><a href="#h3-0-41" id="h3-0-41" class="i">+
</a><a href="#h3-0-42" id="h3-0-42" class="i">+    fun button(label: String, callback: () -&gt; Unit) = createNode(NodeType.BUTTON) {
</a><a href="#h3-0-43" id="h3-0-43" class="i">+        label(label)
</a><a href="#h3-0-44" id="h3-0-44" class="i">+        attributes[&quot;callback&quot;] = callback
</a><a href="#h3-0-45" id="h3-0-45" class="i">+    }
</a><a href="#h3-0-46" id="h3-0-46" class="i">+
</a><a href="#h3-0-47" id="h3-0-47" class="i">+    fun slider(min: Int, max: Int, step: Int, value: Int, callback: (Int) -&gt; Unit) = createNode(
</a><a href="#h3-0-48" id="h3-0-48" class="i">+        NodeType.SLIDER
</a><a href="#h3-0-49" id="h3-0-49" class="i">+    ) {
</a><a href="#h3-0-50" id="h3-0-50" class="i">+        attributes[&quot;value&quot;] = value
</a><a href="#h3-0-51" id="h3-0-51" class="i">+        attributes[&quot;min&quot;] = min
</a><a href="#h3-0-52" id="h3-0-52" class="i">+        attributes[&quot;max&quot;] = max
</a><a href="#h3-0-53" id="h3-0-53" class="i">+        attributes[&quot;step&quot;] = step
</a><a href="#h3-0-54" id="h3-0-54" class="i">+        attributes[&quot;callback&quot;] = callback
</a><a href="#h3-0-55" id="h3-0-55" class="i">+    }
</a><a href="#h3-0-56" id="h3-0-56" class="i">+
</a><a href="#h3-0-57" id="h3-0-57" class="i">+    fun list(label: String, items: List&lt;String&gt;, callback: (String) -&gt; Unit) = createNode(NodeType.LIST) {
</a><a href="#h3-0-58" id="h3-0-58" class="i">+        label(label)
</a><a href="#h3-0-59" id="h3-0-59" class="i">+        attributes[&quot;items&quot;] = items
</a><a href="#h3-0-60" id="h3-0-60" class="i">+        attributes[&quot;callback&quot;] = callback
</a><a href="#h3-0-61" id="h3-0-61" class="i">+    }
</a><a href="#h3-0-62" id="h3-0-62" class="i">+}
</a><a href="#h3-0-63" id="h3-0-63" class="i">+
</a><a href="#h3-0-64" id="h3-0-64" class="i">+
</a><a href="#h3-0-65" id="h3-0-65" class="i">+
</a><a href="#h3-0-66" id="h3-0-66" class="i">+class InterfaceManager(
</a><a href="#h3-0-67" id="h3-0-67" class="i">+    private val moduleInfo: ModuleInfo,
</a><a href="#h3-0-68" id="h3-0-68" class="i">+    private val logger: AbstractLogger,
</a><a href="#h3-0-69" id="h3-0-69" class="i">+    private val registerInterface: (String, InterfaceBuilder) -&gt; Unit,
</a><a href="#h3-0-70" id="h3-0-70" class="i">+) {
</a><a href="#h3-0-71" id="h3-0-71" class="i">+    @JSFunction
</a><a href="#h3-0-72" id="h3-0-72" class="i">+    fun create(name: String, callback: Function) {
</a><a href="#h3-0-73" id="h3-0-73" class="i">+        logger.info(&quot;Creating interface for ${moduleInfo.name}&quot;)
</a><a href="#h3-0-74" id="h3-0-74" class="i">+        val interfaceBuilder = InterfaceBuilder()
</a><a href="#h3-0-75" id="h3-0-75" class="i">+        callback.call(Context.getCurrentContext(), callback, callback, arrayOf(interfaceBuilder))
</a><a href="#h3-0-76" id="h3-0-76" class="i">+        registerInterface(name, interfaceBuilder)
</a><a href="#h3-0-77" id="h3-0-77" class="i">+    }
</a><a href="#h3-0-78" id="h3-0-78" class="i">+}</a><a href="#h3-0-79" id="h3-0-79" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/Node.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/Node.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/Node.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/Node.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -0,0 +1,42 @@
</a><a href="#h4-0-0" id="h4-0-0" class="i">+package me.rhunk.snapenhance.scripting.impl.ui.components
</a><a href="#h4-0-1" id="h4-0-1" class="i">+
</a><a href="#h4-0-2" id="h4-0-2" class="i">+open class Node(
</a><a href="#h4-0-3" id="h4-0-3" class="i">+    val type: NodeType,
</a><a href="#h4-0-4" id="h4-0-4" class="i">+) {
</a><a href="#h4-0-5" id="h4-0-5" class="i">+    lateinit var uiChangeDetection: (key: String, value: Any?) -&gt; Unit
</a><a href="#h4-0-6" id="h4-0-6" class="i">+
</a><a href="#h4-0-7" id="h4-0-7" class="i">+    val children = mutableListOf&lt;Node&gt;()
</a><a href="#h4-0-8" id="h4-0-8" class="i">+    val attributes = object: HashMap&lt;String, Any?&gt;() {
</a><a href="#h4-0-9" id="h4-0-9" class="i">+        override fun put(key: String, value: Any?): Any? {
</a><a href="#h4-0-10" id="h4-0-10" class="i">+            return super.put(key, value).also {
</a><a href="#h4-0-11" id="h4-0-11" class="i">+                if (::uiChangeDetection.isInitialized) {
</a><a href="#h4-0-12" id="h4-0-12" class="i">+                    uiChangeDetection(key, value)
</a><a href="#h4-0-13" id="h4-0-13" class="i">+                }
</a><a href="#h4-0-14" id="h4-0-14" class="i">+            }
</a><a href="#h4-0-15" id="h4-0-15" class="i">+        }
</a><a href="#h4-0-16" id="h4-0-16" class="i">+    }
</a><a href="#h4-0-17" id="h4-0-17" class="i">+
</a><a href="#h4-0-18" id="h4-0-18" class="i">+    fun setAttribute(key: String, value: Any?) {
</a><a href="#h4-0-19" id="h4-0-19" class="i">+        attributes[key] = value
</a><a href="#h4-0-20" id="h4-0-20" class="i">+    }
</a><a href="#h4-0-21" id="h4-0-21" class="i">+
</a><a href="#h4-0-22" id="h4-0-22" class="i">+    fun label(text: String): Node {
</a><a href="#h4-0-23" id="h4-0-23" class="i">+        attributes[&quot;label&quot;] = text
</a><a href="#h4-0-24" id="h4-0-24" class="i">+        return this
</a><a href="#h4-0-25" id="h4-0-25" class="i">+    }
</a><a href="#h4-0-26" id="h4-0-26" class="i">+
</a><a href="#h4-0-27" id="h4-0-27" class="i">+    fun padding(padding: Int): Node {
</a><a href="#h4-0-28" id="h4-0-28" class="i">+        attributes[&quot;padding&quot;] = padding
</a><a href="#h4-0-29" id="h4-0-29" class="i">+        return this
</a><a href="#h4-0-30" id="h4-0-30" class="i">+    }
</a><a href="#h4-0-31" id="h4-0-31" class="i">+
</a><a href="#h4-0-32" id="h4-0-32" class="i">+    fun fontSize(size: Int): Node {
</a><a href="#h4-0-33" id="h4-0-33" class="i">+        attributes[&quot;fontSize&quot;] = size
</a><a href="#h4-0-34" id="h4-0-34" class="i">+        return this
</a><a href="#h4-0-35" id="h4-0-35" class="i">+    }
</a><a href="#h4-0-36" id="h4-0-36" class="i">+
</a><a href="#h4-0-37" id="h4-0-37" class="i">+    fun color(color: Long): Node {
</a><a href="#h4-0-38" id="h4-0-38" class="i">+        attributes[&quot;color&quot;] = color
</a><a href="#h4-0-39" id="h4-0-39" class="i">+        return this
</a><a href="#h4-0-40" id="h4-0-40" class="i">+    }
</a><a href="#h4-0-41" id="h4-0-41" class="i">+}
</a><b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/NodeType.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/NodeType.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/NodeType.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/NodeType.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,10 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+package me.rhunk.snapenhance.scripting.impl.ui.components
</a><a href="#h5-0-1" id="h5-0-1" class="i">+enum class NodeType {
</a><a href="#h5-0-2" id="h5-0-2" class="i">+    ROW,
</a><a href="#h5-0-3" id="h5-0-3" class="i">+    COLUMN,
</a><a href="#h5-0-4" id="h5-0-4" class="i">+    TEXT,
</a><a href="#h5-0-5" id="h5-0-5" class="i">+    SWITCH,
</a><a href="#h5-0-6" id="h5-0-6" class="i">+    BUTTON,
</a><a href="#h5-0-7" id="h5-0-7" class="i">+    SLIDER,
</a><a href="#h5-0-8" id="h5-0-8" class="i">+    LIST
</a><a href="#h5-0-9" id="h5-0-9" class="i">+}</a><a href="#h5-0-10" id="h5-0-10" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h6" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/impl/RowColumnNode.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/impl/RowColumnNode.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/impl/RowColumnNode.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/scripting/impl/ui/components/impl/RowColumnNode.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -0,0 +1,47 @@
</a><a href="#h6-0-0" id="h6-0-0" class="i">+package me.rhunk.snapenhance.scripting.impl.ui.components.impl
</a><a href="#h6-0-1" id="h6-0-1" class="i">+
</a><a href="#h6-0-2" id="h6-0-2" class="i">+import androidx.compose.foundation.layout.Arrangement
</a><a href="#h6-0-3" id="h6-0-3" class="i">+import androidx.compose.ui.Alignment
</a><a href="#h6-0-4" id="h6-0-4" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.Node
</a><a href="#h6-0-5" id="h6-0-5" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.NodeType
</a><a href="#h6-0-6" id="h6-0-6" class="i">+
</a><a href="#h6-0-7" id="h6-0-7" class="i">+
</a><a href="#h6-0-8" id="h6-0-8" class="i">+class RowColumnNode(
</a><a href="#h6-0-9" id="h6-0-9" class="i">+    type: NodeType,
</a><a href="#h6-0-10" id="h6-0-10" class="i">+) : Node(type) {
</a><a href="#h6-0-11" id="h6-0-11" class="i">+    companion object {
</a><a href="#h6-0-12" id="h6-0-12" class="i">+        private val arrangements = mapOf(
</a><a href="#h6-0-13" id="h6-0-13" class="i">+            &quot;start&quot; to Arrangement.Start,
</a><a href="#h6-0-14" id="h6-0-14" class="i">+            &quot;end&quot; to Arrangement.End,
</a><a href="#h6-0-15" id="h6-0-15" class="i">+            &quot;top&quot; to Arrangement.Top,
</a><a href="#h6-0-16" id="h6-0-16" class="i">+            &quot;bottom&quot; to Arrangement.Bottom,
</a><a href="#h6-0-17" id="h6-0-17" class="i">+            &quot;center&quot; to Arrangement.Center,
</a><a href="#h6-0-18" id="h6-0-18" class="i">+            &quot;spaceBetween&quot; to Arrangement.SpaceBetween,
</a><a href="#h6-0-19" id="h6-0-19" class="i">+            &quot;spaceAround&quot; to Arrangement.SpaceAround,
</a><a href="#h6-0-20" id="h6-0-20" class="i">+            &quot;spaceEvenly&quot; to Arrangement.SpaceEvenly,
</a><a href="#h6-0-21" id="h6-0-21" class="i">+        )
</a><a href="#h6-0-22" id="h6-0-22" class="i">+        private val alignments = mapOf(
</a><a href="#h6-0-23" id="h6-0-23" class="i">+            &quot;start&quot; to Alignment.Start,
</a><a href="#h6-0-24" id="h6-0-24" class="i">+            &quot;end&quot; to Alignment.End,
</a><a href="#h6-0-25" id="h6-0-25" class="i">+            &quot;top&quot; to Alignment.Top,
</a><a href="#h6-0-26" id="h6-0-26" class="i">+            &quot;bottom&quot; to Alignment.Bottom,
</a><a href="#h6-0-27" id="h6-0-27" class="i">+            &quot;centerVertically&quot; to Alignment.CenterVertically,
</a><a href="#h6-0-28" id="h6-0-28" class="i">+            &quot;centerHorizontally&quot; to Alignment.CenterHorizontally,
</a><a href="#h6-0-29" id="h6-0-29" class="i">+        )
</a><a href="#h6-0-30" id="h6-0-30" class="i">+    }
</a><a href="#h6-0-31" id="h6-0-31" class="i">+
</a><a href="#h6-0-32" id="h6-0-32" class="i">+    fun arrangement(arrangement: String): RowColumnNode {
</a><a href="#h6-0-33" id="h6-0-33" class="i">+        attributes[&quot;arrangement&quot;] = arrangements[arrangement] ?: throw IllegalArgumentException(&quot;Invalid arrangement&quot;)
</a><a href="#h6-0-34" id="h6-0-34" class="i">+        return this
</a><a href="#h6-0-35" id="h6-0-35" class="i">+    }
</a><a href="#h6-0-36" id="h6-0-36" class="i">+
</a><a href="#h6-0-37" id="h6-0-37" class="i">+    fun alignment(alignment: String): RowColumnNode {
</a><a href="#h6-0-38" id="h6-0-38" class="i">+        attributes[&quot;alignment&quot;] = alignments[alignment] ?: throw IllegalArgumentException(&quot;Invalid alignment&quot;)
</a><a href="#h6-0-39" id="h6-0-39" class="i">+        return this
</a><a href="#h6-0-40" id="h6-0-40" class="i">+    }
</a><a href="#h6-0-41" id="h6-0-41" class="i">+
</a><a href="#h6-0-42" id="h6-0-42" class="i">+    fun spacedBy(spacing: Int): RowColumnNode {
</a><a href="#h6-0-43" id="h6-0-43" class="i">+        attributes[&quot;spacing&quot;] = spacing
</a><a href="#h6-0-44" id="h6-0-44" class="i">+        return this
</a><a href="#h6-0-45" id="h6-0-45" class="i">+    }
</a><a href="#h6-0-46" id="h6-0-46" class="i">+}</a><a href="#h6-0-47" id="h6-0-47" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h7" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -1,27 +1,23 @@
</a> package me.rhunk.snapenhance.ui.manager.sections.scripting
 
<a href="#h7-0-2" id="h7-0-2" class="d">-import androidx.compose.foundation.layout.Column
</a><a href="#h7-0-3" id="h7-0-3" class="d">-import androidx.compose.foundation.layout.Row
</a><a href="#h7-0-4" id="h7-0-4" class="d">-import androidx.compose.foundation.layout.fillMaxSize
</a><a href="#h7-0-5" id="h7-0-5" class="d">-import androidx.compose.foundation.layout.fillMaxWidth
</a><a href="#h7-0-6" id="h7-0-6" class="d">-import androidx.compose.foundation.layout.padding
</a><a href="#h7-0-7" id="h7-0-7" class="i">+import androidx.compose.foundation.clickable
</a><a href="#h7-0-8" id="h7-0-8" class="i">+import androidx.compose.foundation.layout.*
</a> import androidx.compose.foundation.lazy.LazyColumn
<a href="#h7-0-10" id="h7-0-10" class="d">-import androidx.compose.material3.Card
</a><a href="#h7-0-11" id="h7-0-11" class="d">-import androidx.compose.material3.CardDefaults
</a><a href="#h7-0-12" id="h7-0-12" class="d">-import androidx.compose.material3.MaterialTheme
</a><a href="#h7-0-13" id="h7-0-13" class="d">-import androidx.compose.material3.Switch
</a><a href="#h7-0-14" id="h7-0-14" class="d">-import androidx.compose.material3.Text
</a><a href="#h7-0-15" id="h7-0-15" class="d">-import androidx.compose.runtime.Composable
</a><a href="#h7-0-16" id="h7-0-16" class="d">-import androidx.compose.runtime.getValue
</a><a href="#h7-0-17" id="h7-0-17" class="d">-import androidx.compose.runtime.mutableStateOf
</a><a href="#h7-0-18" id="h7-0-18" class="d">-import androidx.compose.runtime.remember
</a><a href="#h7-0-19" id="h7-0-19" class="d">-import androidx.compose.runtime.setValue
</a><a href="#h7-0-20" id="h7-0-20" class="i">+import androidx.compose.material.icons.Icons
</a><a href="#h7-0-21" id="h7-0-21" class="i">+import androidx.compose.material.icons.filled.Settings
</a><a href="#h7-0-22" id="h7-0-22" class="i">+import androidx.compose.material3.*
</a><a href="#h7-0-23" id="h7-0-23" class="i">+import androidx.compose.runtime.*
</a> import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
<a href="#h7-0-26" id="h7-0-26" class="i">+import androidx.compose.ui.graphics.Color
</a> import androidx.compose.ui.unit.dp
 import androidx.compose.ui.unit.sp
<a href="#h7-0-29" id="h7-0-29" class="i">+import kotlinx.coroutines.launch
</a><a href="#h7-0-30" id="h7-0-30" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.Node
</a><a href="#h7-0-31" id="h7-0-31" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.NodeType
</a> import me.rhunk.snapenhance.scripting.type.ModuleInfo
 import me.rhunk.snapenhance.ui.manager.Section
<a href="#h7-0-34" id="h7-0-34" class="i">+import kotlin.math.abs
</a> 
 class ScriptsSection : Section() {
     @Composable
<a href="#h7-1" id="h7-1" class="h">@@ -29,16 +25,22 @@ class ScriptsSection : Section() {
</a>         var enabled by remember {
             mutableStateOf(context.modDatabase.isScriptEnabled(script.name))
         }
<a href="#h7-1-3" id="h7-1-3" class="i">+        var openSettings by remember {
</a><a href="#h7-1-4" id="h7-1-4" class="i">+            mutableStateOf(false)
</a><a href="#h7-1-5" id="h7-1-5" class="i">+        }
</a> 
         Card(
             modifier = Modifier
                 .fillMaxWidth()
<a href="#h7-1-10" id="h7-1-10" class="d">-                .padding(8.dp),
</a><a href="#h7-1-11" id="h7-1-11" class="i">+                .padding(12.dp),
</a>             elevation = CardDefaults.cardElevation()
         ) {
             Row(
                 modifier = Modifier
                     .fillMaxWidth()
<a href="#h7-1-17" id="h7-1-17" class="i">+                    .clickable {
</a><a href="#h7-1-18" id="h7-1-18" class="i">+                        openSettings = !openSettings
</a><a href="#h7-1-19" id="h7-1-19" class="i">+                    }
</a>                     .padding(8.dp),
                 verticalAlignment = Alignment.CenterVertically
             ) {
<a href="#h7-2" id="h7-2" class="h">@@ -56,6 +58,14 @@ class ScriptsSection : Section() {
</a>                         fontSize = 14.sp,
                     )
                 }
<a href="#h7-2-3" id="h7-2-3" class="i">+                IconButton(onClick = {
</a><a href="#h7-2-4" id="h7-2-4" class="i">+                    openSettings = !openSettings
</a><a href="#h7-2-5" id="h7-2-5" class="i">+                }) {
</a><a href="#h7-2-6" id="h7-2-6" class="i">+                    Icon(
</a><a href="#h7-2-7" id="h7-2-7" class="i">+                        imageVector = Icons.Default.Settings,
</a><a href="#h7-2-8" id="h7-2-8" class="i">+                        contentDescription = &quot;Settings&quot;,
</a><a href="#h7-2-9" id="h7-2-9" class="i">+                    )
</a><a href="#h7-2-10" id="h7-2-10" class="i">+                }
</a>                 Switch(
                     checked = enabled,
                     onCheckedChange = {
<a href="#h7-3" id="h7-3" class="h">@@ -64,6 +74,145 @@ class ScriptsSection : Section() {
</a>                     }
                 )
             }
<a href="#h7-3-3" id="h7-3-3" class="i">+
</a><a href="#h7-3-4" id="h7-3-4" class="i">+
</a><a href="#h7-3-5" id="h7-3-5" class="i">+            if (openSettings) {
</a><a href="#h7-3-6" id="h7-3-6" class="i">+                ScriptSettings(script)
</a><a href="#h7-3-7" id="h7-3-7" class="i">+            }
</a><a href="#h7-3-8" id="h7-3-8" class="i">+        }
</a><a href="#h7-3-9" id="h7-3-9" class="i">+    }
</a><a href="#h7-3-10" id="h7-3-10" class="i">+
</a><a href="#h7-3-11" id="h7-3-11" class="i">+    @Composable
</a><a href="#h7-3-12" id="h7-3-12" class="i">+    private fun DrawNode(node: Node) {
</a><a href="#h7-3-13" id="h7-3-13" class="i">+        val coroutineScope = rememberCoroutineScope()
</a><a href="#h7-3-14" id="h7-3-14" class="i">+        val cachedAttributes = remember { mutableStateMapOf(*node.attributes.toList().toTypedArray()) }
</a><a href="#h7-3-15" id="h7-3-15" class="i">+
</a><a href="#h7-3-16" id="h7-3-16" class="i">+        node.uiChangeDetection = { key, value -&gt;
</a><a href="#h7-3-17" id="h7-3-17" class="i">+            coroutineScope.launch {
</a><a href="#h7-3-18" id="h7-3-18" class="i">+                cachedAttributes[key] = value
</a><a href="#h7-3-19" id="h7-3-19" class="i">+            }
</a><a href="#h7-3-20" id="h7-3-20" class="i">+        }
</a><a href="#h7-3-21" id="h7-3-21" class="i">+
</a><a href="#h7-3-22" id="h7-3-22" class="i">+        val padding = cachedAttributes[&quot;padding&quot;]?.toString()?.toInt()?.let { abs(it) } ?: 2
</a><a href="#h7-3-23" id="h7-3-23" class="i">+        val arrangement = cachedAttributes[&quot;arrangement&quot;]
</a><a href="#h7-3-24" id="h7-3-24" class="i">+        val alignment = cachedAttributes[&quot;alignment&quot;]
</a><a href="#h7-3-25" id="h7-3-25" class="i">+        val spacing = cachedAttributes[&quot;spacing&quot;]?.toString()?.toInt()?.let { abs(it) }
</a><a href="#h7-3-26" id="h7-3-26" class="i">+
</a><a href="#h7-3-27" id="h7-3-27" class="i">+        fun runCallbackSafe(callback: () -&gt; Unit) {
</a><a href="#h7-3-28" id="h7-3-28" class="i">+            runCatching {
</a><a href="#h7-3-29" id="h7-3-29" class="i">+                callback()
</a><a href="#h7-3-30" id="h7-3-30" class="i">+            }.onFailure {
</a><a href="#h7-3-31" id="h7-3-31" class="i">+                context.log.error(&quot;Error running callback&quot;, it)
</a><a href="#h7-3-32" id="h7-3-32" class="i">+            }
</a><a href="#h7-3-33" id="h7-3-33" class="i">+        }
</a><a href="#h7-3-34" id="h7-3-34" class="i">+
</a><a href="#h7-3-35" id="h7-3-35" class="i">+        @Composable
</a><a href="#h7-3-36" id="h7-3-36" class="i">+        fun NodeLabel() {
</a><a href="#h7-3-37" id="h7-3-37" class="i">+            Text(
</a><a href="#h7-3-38" id="h7-3-38" class="i">+                text = cachedAttributes[&quot;label&quot;] as String,
</a><a href="#h7-3-39" id="h7-3-39" class="i">+                fontSize = (cachedAttributes[&quot;fontSize&quot;]?.toString()?.toInt() ?: 14).sp,
</a><a href="#h7-3-40" id="h7-3-40" class="i">+                color = (cachedAttributes[&quot;color&quot;] as? Long)?.let { Color(it) } ?: Color.Unspecified
</a><a href="#h7-3-41" id="h7-3-41" class="i">+            )
</a><a href="#h7-3-42" id="h7-3-42" class="i">+        }
</a><a href="#h7-3-43" id="h7-3-43" class="i">+
</a><a href="#h7-3-44" id="h7-3-44" class="i">+        when (node.type) {
</a><a href="#h7-3-45" id="h7-3-45" class="i">+            NodeType.COLUMN -&gt; {
</a><a href="#h7-3-46" id="h7-3-46" class="i">+                Column(
</a><a href="#h7-3-47" id="h7-3-47" class="i">+                    verticalArrangement = arrangement as? Arrangement.Vertical ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.Top,
</a><a href="#h7-3-48" id="h7-3-48" class="i">+                    horizontalAlignment = alignment as? Alignment.Horizontal ?: Alignment.Start,
</a><a href="#h7-3-49" id="h7-3-49" class="i">+                    modifier = Modifier
</a><a href="#h7-3-50" id="h7-3-50" class="i">+                        .fillMaxWidth()
</a><a href="#h7-3-51" id="h7-3-51" class="i">+                        .padding(padding.dp)
</a><a href="#h7-3-52" id="h7-3-52" class="i">+                ) {
</a><a href="#h7-3-53" id="h7-3-53" class="i">+                    node.children.forEach { child -&gt;
</a><a href="#h7-3-54" id="h7-3-54" class="i">+                        DrawNode(child)
</a><a href="#h7-3-55" id="h7-3-55" class="i">+                    }
</a><a href="#h7-3-56" id="h7-3-56" class="i">+                }
</a><a href="#h7-3-57" id="h7-3-57" class="i">+            }
</a><a href="#h7-3-58" id="h7-3-58" class="i">+            NodeType.ROW -&gt; {
</a><a href="#h7-3-59" id="h7-3-59" class="i">+                Row(
</a><a href="#h7-3-60" id="h7-3-60" class="i">+                    horizontalArrangement = arrangement as? Arrangement.Horizontal ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.SpaceBetween,
</a><a href="#h7-3-61" id="h7-3-61" class="i">+                    verticalAlignment = alignment as? Alignment.Vertical ?: Alignment.CenterVertically,
</a><a href="#h7-3-62" id="h7-3-62" class="i">+                    modifier = Modifier
</a><a href="#h7-3-63" id="h7-3-63" class="i">+                        .fillMaxWidth()
</a><a href="#h7-3-64" id="h7-3-64" class="i">+                        .padding(padding.dp)
</a><a href="#h7-3-65" id="h7-3-65" class="i">+                ) {
</a><a href="#h7-3-66" id="h7-3-66" class="i">+                    node.children.forEach { child -&gt;
</a><a href="#h7-3-67" id="h7-3-67" class="i">+                        DrawNode(child)
</a><a href="#h7-3-68" id="h7-3-68" class="i">+                    }
</a><a href="#h7-3-69" id="h7-3-69" class="i">+                }
</a><a href="#h7-3-70" id="h7-3-70" class="i">+            }
</a><a href="#h7-3-71" id="h7-3-71" class="i">+            NodeType.TEXT -&gt; NodeLabel()
</a><a href="#h7-3-72" id="h7-3-72" class="i">+            NodeType.SWITCH -&gt; {
</a><a href="#h7-3-73" id="h7-3-73" class="i">+                var switchState by remember {
</a><a href="#h7-3-74" id="h7-3-74" class="i">+                    mutableStateOf(cachedAttributes[&quot;state&quot;] as Boolean)
</a><a href="#h7-3-75" id="h7-3-75" class="i">+                }
</a><a href="#h7-3-76" id="h7-3-76" class="i">+                Switch(
</a><a href="#h7-3-77" id="h7-3-77" class="i">+                    checked = switchState,
</a><a href="#h7-3-78" id="h7-3-78" class="i">+                    onCheckedChange = { state -&gt;
</a><a href="#h7-3-79" id="h7-3-79" class="i">+                        runCallbackSafe {
</a><a href="#h7-3-80" id="h7-3-80" class="i">+                            switchState = state
</a><a href="#h7-3-81" id="h7-3-81" class="i">+                            node.setAttribute(&quot;state&quot;, state)
</a><a href="#h7-3-82" id="h7-3-82" class="i">+                            (cachedAttributes[&quot;callback&quot;] as? (Boolean) -&gt; Unit)?.let { it(state) }
</a><a href="#h7-3-83" id="h7-3-83" class="i">+                        }
</a><a href="#h7-3-84" id="h7-3-84" class="i">+                    }
</a><a href="#h7-3-85" id="h7-3-85" class="i">+                )
</a><a href="#h7-3-86" id="h7-3-86" class="i">+            }
</a><a href="#h7-3-87" id="h7-3-87" class="i">+            NodeType.SLIDER -&gt; {
</a><a href="#h7-3-88" id="h7-3-88" class="i">+                var sliderValue by remember {
</a><a href="#h7-3-89" id="h7-3-89" class="i">+                    mutableFloatStateOf((cachedAttributes[&quot;value&quot;] as Int).toFloat())
</a><a href="#h7-3-90" id="h7-3-90" class="i">+                }
</a><a href="#h7-3-91" id="h7-3-91" class="i">+                Slider(
</a><a href="#h7-3-92" id="h7-3-92" class="i">+                    value = sliderValue,
</a><a href="#h7-3-93" id="h7-3-93" class="i">+                    onValueChange = { value -&gt;
</a><a href="#h7-3-94" id="h7-3-94" class="i">+                        runCallbackSafe {
</a><a href="#h7-3-95" id="h7-3-95" class="i">+                            sliderValue = value
</a><a href="#h7-3-96" id="h7-3-96" class="i">+                            node.setAttribute(&quot;value&quot;, value.toInt())
</a><a href="#h7-3-97" id="h7-3-97" class="i">+                            (cachedAttributes[&quot;callback&quot;] as? (Int) -&gt; Unit)?.let { it(value.toInt()) }
</a><a href="#h7-3-98" id="h7-3-98" class="i">+                        }
</a><a href="#h7-3-99" id="h7-3-99" class="i">+                    },
</a><a href="#h7-3-100" id="h7-3-100" class="i">+                    valueRange = (cachedAttributes[&quot;min&quot;] as Int).toFloat()..(cachedAttributes[&quot;max&quot;] as Int).toFloat(),
</a><a href="#h7-3-101" id="h7-3-101" class="i">+                    steps = cachedAttributes[&quot;step&quot;] as Int,
</a><a href="#h7-3-102" id="h7-3-102" class="i">+                )
</a><a href="#h7-3-103" id="h7-3-103" class="i">+            }
</a><a href="#h7-3-104" id="h7-3-104" class="i">+            NodeType.BUTTON -&gt; {
</a><a href="#h7-3-105" id="h7-3-105" class="i">+                OutlinedButton(onClick = {
</a><a href="#h7-3-106" id="h7-3-106" class="i">+                    runCallbackSafe {
</a><a href="#h7-3-107" id="h7-3-107" class="i">+                        (cachedAttributes[&quot;callback&quot;] as? () -&gt; Unit)?.let { it() }
</a><a href="#h7-3-108" id="h7-3-108" class="i">+                    }
</a><a href="#h7-3-109" id="h7-3-109" class="i">+                }) {
</a><a href="#h7-3-110" id="h7-3-110" class="i">+                    NodeLabel()
</a><a href="#h7-3-111" id="h7-3-111" class="i">+                }
</a><a href="#h7-3-112" id="h7-3-112" class="i">+            }
</a><a href="#h7-3-113" id="h7-3-113" class="i">+            else -&gt; {}
</a><a href="#h7-3-114" id="h7-3-114" class="i">+        }
</a><a href="#h7-3-115" id="h7-3-115" class="i">+    }
</a><a href="#h7-3-116" id="h7-3-116" class="i">+
</a><a href="#h7-3-117" id="h7-3-117" class="i">+    @Composable
</a><a href="#h7-3-118" id="h7-3-118" class="i">+    fun ScriptSettings(script: ModuleInfo) {
</a><a href="#h7-3-119" id="h7-3-119" class="i">+        val settingsInterface = remember {
</a><a href="#h7-3-120" id="h7-3-120" class="i">+            context.scriptManager.getScriptInterface(script.name, &quot;settings&quot;)
</a><a href="#h7-3-121" id="h7-3-121" class="i">+        } ?: run {
</a><a href="#h7-3-122" id="h7-3-122" class="i">+            Text(
</a><a href="#h7-3-123" id="h7-3-123" class="i">+                text = &quot;This module does not have any settings&quot;,
</a><a href="#h7-3-124" id="h7-3-124" class="i">+                style = MaterialTheme.typography.bodySmall,
</a><a href="#h7-3-125" id="h7-3-125" class="i">+                modifier = Modifier.padding(8.dp)
</a><a href="#h7-3-126" id="h7-3-126" class="i">+            )
</a><a href="#h7-3-127" id="h7-3-127" class="i">+            return
</a><a href="#h7-3-128" id="h7-3-128" class="i">+        }
</a><a href="#h7-3-129" id="h7-3-129" class="i">+
</a><a href="#h7-3-130" id="h7-3-130" class="i">+        Column(
</a><a href="#h7-3-131" id="h7-3-131" class="i">+            modifier = Modifier
</a><a href="#h7-3-132" id="h7-3-132" class="i">+                .fillMaxWidth()
</a><a href="#h7-3-133" id="h7-3-133" class="i">+                .padding(8.dp)
</a><a href="#h7-3-134" id="h7-3-134" class="i">+        ) {
</a><a href="#h7-3-135" id="h7-3-135" class="i">+            settingsInterface.nodes.forEach { node -&gt;
</a><a href="#h7-3-136" id="h7-3-136" class="i">+                DrawNode(node)
</a><a href="#h7-3-137" id="h7-3-137" class="i">+            }
</a><a href="#h7-3-138" id="h7-3-138" class="i">+
</a><a href="#h7-3-139" id="h7-3-139" class="i">+            LaunchedEffect(settingsInterface) {
</a><a href="#h7-3-140" id="h7-3-140" class="i">+                settingsInterface.onLaunchedCallback?.invoke()
</a><a href="#h7-3-141" id="h7-3-141" class="i">+            }
</a>         }
     }
 
<b>diff --git a/<a id="h8" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/ModContext.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/ModContext.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/ModContext.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/ModContext.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -58,7 +58,7 @@ class ModContext {
</a>     val event = EventBus(this)
     val eventDispatcher = EventDispatcher(this)
     val native = NativeLib()
<a href="#h8-0-3" id="h8-0-3" class="d">-    val scriptRuntime by lazy { CoreScriptRuntime(log, androidContext.classLoader) }
</a><a href="#h8-0-4" id="h8-0-4" class="i">+    val scriptRuntime by lazy { CoreScriptRuntime(androidContext, log) }
</a> 
     val isDeveloper by lazy { config.scripting.developerMode.get() }
 
<b>diff --git a/<a id="h9" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/IPCInterface.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/IPCInterface.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/IPCInterface.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/IPCInterface.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -13,5 +13,5 @@ abstract class IPCInterface {
</a>     @Suppress(&quot;unused&quot;)
     fun emit(eventName: String) = emit(eventName, *emptyArray())
     @Suppress(&quot;unused&quot;)
<a href="#h9-0-3" id="h9-0-3" class="d">-    fun emit(channel: String, eventName: String) = broadcast(channel, eventName, *emptyArray())
</a><a href="#h9-0-4" id="h9-0-4" class="i">+    fun emit(channel: String, eventName: String) = broadcast(channel, eventName)
</a> } 
\ No newline at end of file
<b>diff --git a/<a id="h10" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/JSModule.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/JSModule.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/JSModule.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/JSModule.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -1,6 +1,7 @@
</a> package me.rhunk.snapenhance.scripting
 
<a href="#h10-0-2" id="h10-0-2" class="d">-import me.rhunk.snapenhance.core.logger.AbstractLogger
</a><a href="#h10-0-3" id="h10-0-3" class="i">+import android.os.Handler
</a><a href="#h10-0-4" id="h10-0-4" class="i">+import android.widget.Toast
</a> import me.rhunk.snapenhance.scripting.ktx.contextScope
 import me.rhunk.snapenhance.scripting.ktx.putFunction
 import me.rhunk.snapenhance.scripting.ktx.scriptableObject
<a href="#h10-1" id="h10-1" class="h">@@ -20,6 +21,7 @@ class JSModule(
</a> 
     fun load(block: ScriptableObject.() -&gt; Unit) {
         contextScope {
<a href="#h10-1-3" id="h10-1-3" class="i">+            val classLoader = scriptRuntime.androidContext.classLoader
</a>             moduleObject = initSafeStandardObjects()
             moduleObject.putConst(&quot;module&quot;, moduleObject, scriptableObject {
                 putConst(&quot;info&quot;, this, scriptableObject {
<a href="#h10-2" id="h10-2" class="h">@@ -53,12 +55,12 @@ class JSModule(
</a> 
             moduleObject.putFunction(&quot;findClass&quot;) {
                 val className = it?.get(0).toString()
<a href="#h10-2-3" id="h10-2-3" class="d">-                scriptRuntime.classLoader.loadClass(className)
</a><a href="#h10-2-4" id="h10-2-4" class="i">+                classLoader.loadClass(className)
</a>             }
 
             moduleObject.putFunction(&quot;type&quot;) { args -&gt;
                 val className = args?.get(0).toString()
<a href="#h10-2-9" id="h10-2-9" class="d">-                val clazz = scriptRuntime.classLoader.loadClass(className)
</a><a href="#h10-2-10" id="h10-2-10" class="i">+                val clazz = classLoader.loadClass(className)
</a> 
                 scriptableObject(&quot;JavaClassWrapper&quot;) {
                     putFunction(&quot;newInstance&quot;) newInstance@{ args -&gt;
<a href="#h10-3" id="h10-3" class="h">@@ -90,6 +92,19 @@ class JSModule(
</a>                 Undefined.instance
             }
 
<a href="#h10-3-3" id="h10-3-3" class="i">+            for (toastFunc in listOf(&quot;longToast&quot;, &quot;shortToast&quot;)) {
</a><a href="#h10-3-4" id="h10-3-4" class="i">+                moduleObject.putFunction(toastFunc) { args -&gt;
</a><a href="#h10-3-5" id="h10-3-5" class="i">+                    Handler(scriptRuntime.androidContext.mainLooper).post {
</a><a href="#h10-3-6" id="h10-3-6" class="i">+                        Toast.makeText(
</a><a href="#h10-3-7" id="h10-3-7" class="i">+                            scriptRuntime.androidContext,
</a><a href="#h10-3-8" id="h10-3-8" class="i">+                            args?.joinToString(&quot; &quot;) ?: &quot;&quot;,
</a><a href="#h10-3-9" id="h10-3-9" class="i">+                            if (toastFunc == &quot;longToast&quot;) Toast.LENGTH_LONG else Toast.LENGTH_SHORT
</a><a href="#h10-3-10" id="h10-3-10" class="i">+                        ).show()
</a><a href="#h10-3-11" id="h10-3-11" class="i">+                    }
</a><a href="#h10-3-12" id="h10-3-12" class="i">+                    Undefined.instance
</a><a href="#h10-3-13" id="h10-3-13" class="i">+                }
</a><a href="#h10-3-14" id="h10-3-14" class="i">+            }
</a><a href="#h10-3-15" id="h10-3-15" class="i">+
</a>             block(moduleObject)
             evaluateString(moduleObject, content, moduleInfo.name, 1, null)
         }
<b>diff --git a/<a id="h11" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/ScriptRuntime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/ScriptRuntime.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/ScriptRuntime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/ScriptRuntime.kt</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -1,5 +1,6 @@
</a> package me.rhunk.snapenhance.scripting
 
<a href="#h11-0-2" id="h11-0-2" class="i">+import android.content.Context
</a> import me.rhunk.snapenhance.core.logger.AbstractLogger
 import me.rhunk.snapenhance.scripting.type.ModuleInfo
 import org.mozilla.javascript.ScriptableObject
<a href="#h11-1" id="h11-1" class="h">@@ -8,8 +9,8 @@ import java.io.ByteArrayInputStream
</a> import java.io.InputStream
 
 open class ScriptRuntime(
<a href="#h11-1-3" id="h11-1-3" class="i">+    val androidContext: Context,
</a>     val logger: AbstractLogger,
<a href="#h11-1-5" id="h11-1-5" class="d">-    val classLoader: ClassLoader,
</a> ) {
     var buildModuleObject: ScriptableObject.(JSModule) -&gt; Unit = {}
     private val modules = mutableMapOf&lt;String, JSModule&gt;()
<b>diff --git a/<a id="h12" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/core/CoreScriptRuntime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/core/CoreScriptRuntime.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/scripting/core/CoreScriptRuntime.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/scripting/core/CoreScriptRuntime.kt</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -1,5 +1,6 @@
</a> package me.rhunk.snapenhance.scripting.core
 
<a href="#h12-0-2" id="h12-0-2" class="i">+import android.content.Context
</a> import me.rhunk.snapenhance.bridge.scripting.IPCListener
 import me.rhunk.snapenhance.bridge.scripting.IScripting
 import me.rhunk.snapenhance.core.logger.AbstractLogger
<a href="#h12-1" id="h12-1" class="h">@@ -9,9 +10,9 @@ import me.rhunk.snapenhance.scripting.ScriptRuntime
</a> import me.rhunk.snapenhance.scripting.core.impl.ScriptHooker
 
 class CoreScriptRuntime(
<a href="#h12-1-3" id="h12-1-3" class="i">+    androidContext: Context,
</a>     logger: AbstractLogger,
<a href="#h12-1-5" id="h12-1-5" class="d">-    classLoader: ClassLoader,
</a><a href="#h12-1-6" id="h12-1-6" class="d">-): ScriptRuntime(logger, classLoader) {
</a><a href="#h12-1-7" id="h12-1-7" class="i">+): ScriptRuntime(androidContext, logger) {
</a>     private val scriptHookers = mutableListOf&lt;ScriptHooker&gt;()
 
     fun connect(scriptingInterface: IScripting) {
<a href="#h12-2" id="h12-2" class="h">@@ -38,7 +39,7 @@ class CoreScriptRuntime(
</a>                         sendIPCMessage(channel, eventName, args)
                     }
                 })
<a href="#h12-2-3" id="h12-2-3" class="d">-                putConst(&quot;hooker&quot;, this, ScriptHooker(module.moduleInfo, logger, classLoader).also {
</a><a href="#h12-2-4" id="h12-2-4" class="i">+                putConst(&quot;hooker&quot;, this, ScriptHooker(module.moduleInfo, logger, androidContext.classLoader).also {
</a>                     scriptHookers.add(it)
                 })
             }
</pre>
</div>
</body>
</html>
