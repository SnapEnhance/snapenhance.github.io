<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>refactor: download manager ui (#69) - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/65cbf79dce99d689fcbe0244045d559353450b24.html">65cbf79dce99d689fcbe0244045d559353450b24</a>
<b>parent</b> <a href="../commit/1e02cbef11d8bdd872077cc17c67ce864103f697.html">1e02cbef11d8bdd872077cc17c67ce864103f697</a>
<b>Author:</b> auth &lt;<a href="mailto:64337177+authorisation@users.noreply.github.com">64337177+authorisation@users.noreply.github.com</a>&gt;
<b>Date:</b>   Wed, 21 Jun 2023 16:06:31 +0200

refactor: download manager ui (#69)

* ui changes

* fix more stuff

* fix: set ffmpeg preset to ultrafast

* refactor: ui tweaks
getIdentifier function

* feat: download manager filter

* add placeholder bitmoji

* change bitmoji blank color

* add settings page (not done)

* setting page impl

* confirmation dialog

* update theme

* remove snap context buttons

* fix: delete cache

* fix: bitmoji icon

---------

Co-authored-by: rhunk &lt;101876869+rhunk@users.noreply.github.com&gt;
<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">app/src/main/AndroidManifest.xml</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/bridge/common/impl/file/BridgeFileType.kt</a></td><td> | </td><td class="num">27</td><td><span class="i">++++++++++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/download/DownloadTaskManager.kt</a></td><td> | </td><td class="num">53</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++</span><span class="d">----------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/downloader/MediaDownloader.kt</a></td><td> | </td><td class="num">9</td><td><span class="i">+++++</span><span class="d">----</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/ui/UITweaks.kt</a></td><td> | </td><td class="num">20</td><td><span class="i">+++++++++++</span><span class="d">---------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/manager/impl/ActionManager.kt</a></td><td> | </td><td class="num">6</td><td><span class="i">+++</span><span class="d">---</span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadListAdapter.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">+</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadManagerActivity.kt</a></td><td> | </td><td class="num">130</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h8">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/MediaFilter.kt</a></td><td> | </td><td class="num">18</td><td><span class="i">++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h9">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/SettingLayoutInflater.kt</a></td><td> | </td><td class="num">97</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h10">app/src/main/kotlin/me/rhunk/snapenhance/util/snap/MediaDownloaderHelper.kt</a></td><td> | </td><td class="num">6</td><td><span class="i">++++</span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h11">app/src/main/res/drawable/back_arrow.xml</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h12">app/src/main/res/drawable/bitmoji_blank.xml</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h13">app/src/main/res/drawable/settings_icon.xml</a></td><td> | </td><td class="num">11</td><td><span class="i">+++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h14">app/src/main/res/font/avenir_next_bold.ttf</a></td><td> | </td><td class="num">0</td><td><span class="i"></span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h15">app/src/main/res/layout/download_manager_activity.xml</a></td><td> | </td><td class="num">151</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d">-----------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h16">app/src/main/res/layout/download_manager_item.xml</a></td><td> | </td><td class="num">42</td><td><span class="i">++++++++++++++++++++++++</span><span class="d">------------------</span></td></tr>
<tr><td class="A">A</td><td><a href="#h17">app/src/main/res/layout/setting_item.xml</a></td><td> | </td><td class="num">20</td><td><span class="i">++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="A">A</td><td><a href="#h18">app/src/main/res/layout/settings_page.xml</a></td><td> | </td><td class="num">52</td><td><span class="i">++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h19">app/src/main/res/values/colors.xml</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h20">app/src/main/res/values/strings.xml</a></td><td> | </td><td class="num">14</td><td><span class="i">+++++++++++++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h21">app/src/main/res/values/themes.xml</a></td><td> | </td><td class="num">2</td><td><span class="i">++</span><span class="d"></span></td></tr>
</table></pre><pre>22 files changed, 559 insertions(+), 127 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/AndroidManifest.xml.html">app/src/main/AndroidManifest.xml</a> b/<a href="../file/app/src/main/AndroidManifest.xml.html">app/src/main/AndroidManifest.xml</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -43,6 +43,7 @@
</a> 
         &lt;activity
             android:name=&quot;.ui.download.DownloadManagerActivity&quot;
<a href="#h0-0-3" id="h0-0-3" class="i">+            android:theme=&quot;@style/AppTheme&quot;
</a>             android:exported=&quot;true&quot;&gt;
             &lt;intent-filter&gt;
                 &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
<b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/common/impl/file/BridgeFileType.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/common/impl/file/BridgeFileType.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/bridge/common/impl/file/BridgeFileType.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/bridge/common/impl/file/BridgeFileType.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -1,15 +1,24 @@
</a> package me.rhunk.snapenhance.bridge.common.impl.file
 
<a href="#h1-0-2" id="h1-0-2" class="i">+import android.content.Context
</a><a href="#h1-0-3" id="h1-0-3" class="i">+import java.io.File
</a> 
<a href="#h1-0-5" id="h1-0-5" class="d">-enum class BridgeFileType(val value: Int, val fileName: String, val isDatabase: Boolean = false) {
</a><a href="#h1-0-6" id="h1-0-6" class="d">-    CONFIG(0, &quot;config.json&quot;),
</a><a href="#h1-0-7" id="h1-0-7" class="d">-    MAPPINGS(1, &quot;mappings.json&quot;),
</a><a href="#h1-0-8" id="h1-0-8" class="d">-    MESSAGE_LOGGER_DATABASE(2, &quot;message_logger.db&quot;, true),
</a><a href="#h1-0-9" id="h1-0-9" class="d">-    STEALTH(3, &quot;stealth.txt&quot;),
</a><a href="#h1-0-10" id="h1-0-10" class="d">-    ANTI_AUTO_DOWNLOAD(4, &quot;anti_auto_download.txt&quot;),
</a><a href="#h1-0-11" id="h1-0-11" class="d">-    ANTI_AUTO_SAVE(5, &quot;anti_auto_save.txt&quot;),
</a><a href="#h1-0-12" id="h1-0-12" class="d">-    AUTO_UPDATER_TIMESTAMP(6, &quot;auto_updater_timestamp.txt&quot;),
</a><a href="#h1-0-13" id="h1-0-13" class="d">-    PINNED_CONVERSATIONS(7, &quot;pinned_conversations.txt&quot;);
</a><a href="#h1-0-14" id="h1-0-14" class="i">+
</a><a href="#h1-0-15" id="h1-0-15" class="i">+enum class BridgeFileType(val value: Int, val fileName: String, val displayName: String, val isDatabase: Boolean = false) {
</a><a href="#h1-0-16" id="h1-0-16" class="i">+    CONFIG(0, &quot;config.json&quot;, &quot;Config&quot;),
</a><a href="#h1-0-17" id="h1-0-17" class="i">+    MAPPINGS(1, &quot;mappings.json&quot;, &quot;Mappings&quot;),
</a><a href="#h1-0-18" id="h1-0-18" class="i">+    MESSAGE_LOGGER_DATABASE(2, &quot;message_logger.db&quot;, &quot;Message Logger&quot;,true),
</a><a href="#h1-0-19" id="h1-0-19" class="i">+    STEALTH(3, &quot;stealth.txt&quot;, &quot;Stealth Conversations&quot;),
</a><a href="#h1-0-20" id="h1-0-20" class="i">+    ANTI_AUTO_DOWNLOAD(4, &quot;anti_auto_download.txt&quot;, &quot;Anti Auto Download&quot;),
</a><a href="#h1-0-21" id="h1-0-21" class="i">+    ANTI_AUTO_SAVE(5, &quot;anti_auto_save.txt&quot;, &quot;Anti Auto Save&quot;),
</a><a href="#h1-0-22" id="h1-0-22" class="i">+    AUTO_UPDATER_TIMESTAMP(6, &quot;auto_updater_timestamp.txt&quot;, &quot;Auto Updater Timestamp&quot;),
</a><a href="#h1-0-23" id="h1-0-23" class="i">+    PINNED_CONVERSATIONS(7, &quot;pinned_conversations.txt&quot;, &quot;Pinned Conversations&quot;);
</a><a href="#h1-0-24" id="h1-0-24" class="i">+
</a><a href="#h1-0-25" id="h1-0-25" class="i">+    fun resolve(context: Context): File = if (isDatabase) {
</a><a href="#h1-0-26" id="h1-0-26" class="i">+        context.getDatabasePath(fileName)
</a><a href="#h1-0-27" id="h1-0-27" class="i">+    } else {
</a><a href="#h1-0-28" id="h1-0-28" class="i">+        File(context.filesDir, fileName)
</a><a href="#h1-0-29" id="h1-0-29" class="i">+    }
</a> 
     companion object {
         fun fromValue(value: Int): BridgeFileType? {
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/download/DownloadTaskManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/download/DownloadTaskManager.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/download/DownloadTaskManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/download/DownloadTaskManager.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -5,10 +5,12 @@ import android.content.Context
</a> import android.database.sqlite.SQLiteDatabase
 import me.rhunk.snapenhance.download.data.PendingDownload
 import me.rhunk.snapenhance.download.enums.DownloadStage
<a href="#h2-0-3" id="h2-0-3" class="i">+import me.rhunk.snapenhance.ui.download.MediaFilter
</a> import me.rhunk.snapenhance.util.SQLiteDatabaseHelper
 
 class DownloadTaskManager {
     private lateinit var taskDatabase: SQLiteDatabase
<a href="#h2-0-8" id="h2-0-8" class="i">+    private val pendingTasks = mutableMapOf&lt;Int, PendingDownload&gt;()
</a>     private val cachedTasks = mutableMapOf&lt;Int, PendingDownload&gt;()
 
     @SuppressLint(&quot;Range&quot;)
<a href="#h2-1" id="h2-1" class="h">@@ -44,7 +46,7 @@ class DownloadTaskManager {
</a>             it.moveToFirst()
             it.getInt(0)
         }
<a href="#h2-1-3" id="h2-1-3" class="d">-        cachedTasks[task.id] = task
</a><a href="#h2-1-4" id="h2-1-4" class="i">+        pendingTasks[task.id] = task
</a>         return task.id
     }
 
<a href="#h2-2" id="h2-2" class="h">@@ -60,33 +62,62 @@ class DownloadTaskManager {
</a>                 task.id
             )
         )
<a href="#h2-2-3" id="h2-2-3" class="d">-        cachedTasks[task.id] = task
</a><a href="#h2-2-4" id="h2-2-4" class="i">+        //if the task is no longer active, move it to the cached tasks
</a><a href="#h2-2-5" id="h2-2-5" class="i">+        if (task.isJobActive()) {
</a><a href="#h2-2-6" id="h2-2-6" class="i">+            pendingTasks[task.id] = task
</a><a href="#h2-2-7" id="h2-2-7" class="i">+        } else {
</a><a href="#h2-2-8" id="h2-2-8" class="i">+            pendingTasks.remove(task.id)
</a><a href="#h2-2-9" id="h2-2-9" class="i">+            cachedTasks[task.id] = task
</a><a href="#h2-2-10" id="h2-2-10" class="i">+        }
</a>     }
 
     fun isEmpty(): Boolean {
<a href="#h2-2-14" id="h2-2-14" class="d">-        return cachedTasks.isEmpty()
</a><a href="#h2-2-15" id="h2-2-15" class="i">+        return cachedTasks.isEmpty() &amp;&amp; pendingTasks.isEmpty()
</a>     }
 
     private fun removeTask(id: Int) {
         taskDatabase.execSQL(&quot;DELETE FROM tasks WHERE id = ?&quot;, arrayOf(id))
         cachedTasks.remove(id)
<a href="#h2-2-21" id="h2-2-21" class="i">+        pendingTasks.remove(id)
</a>     }
 
     fun removeTask(task: PendingDownload) {
         removeTask(task.id)
     }
 
<a href="#h2-2-28" id="h2-2-28" class="d">-    fun queryAllTasks(): Map&lt;Int, PendingDownload&gt; {
</a><a href="#h2-2-29" id="h2-2-29" class="d">-        cachedTasks.putAll(queryTasks(
</a><a href="#h2-2-30" id="h2-2-30" class="d">-            from = cachedTasks.values.lastOrNull()?.id ?: Int.MAX_VALUE,
</a><a href="#h2-2-31" id="h2-2-31" class="d">-            amount = 20
</a><a href="#h2-2-32" id="h2-2-32" class="i">+    fun queryAllTasks(filter: MediaFilter): Map&lt;Int, PendingDownload&gt; {
</a><a href="#h2-2-33" id="h2-2-33" class="i">+        val isPendingFilter = filter == MediaFilter.PENDING
</a><a href="#h2-2-34" id="h2-2-34" class="i">+        val tasks = mutableMapOf&lt;Int, PendingDownload&gt;()
</a><a href="#h2-2-35" id="h2-2-35" class="i">+
</a><a href="#h2-2-36" id="h2-2-36" class="i">+        tasks.putAll(pendingTasks.filter { isPendingFilter || filter.matches(it.value.mediaDisplayType) })
</a><a href="#h2-2-37" id="h2-2-37" class="i">+        if (isPendingFilter) {
</a><a href="#h2-2-38" id="h2-2-38" class="i">+            return tasks.toSortedMap(reverseOrder())
</a><a href="#h2-2-39" id="h2-2-39" class="i">+        }
</a><a href="#h2-2-40" id="h2-2-40" class="i">+
</a><a href="#h2-2-41" id="h2-2-41" class="i">+        tasks.putAll(queryTasks(
</a><a href="#h2-2-42" id="h2-2-42" class="i">+            from = tasks.values.lastOrNull()?.id ?: Int.MAX_VALUE,
</a><a href="#h2-2-43" id="h2-2-43" class="i">+            amount = 30,
</a><a href="#h2-2-44" id="h2-2-44" class="i">+            filter = filter
</a>         ))
<a href="#h2-2-46" id="h2-2-46" class="d">-        return cachedTasks.toSortedMap(reverseOrder())
</a><a href="#h2-2-47" id="h2-2-47" class="i">+
</a><a href="#h2-2-48" id="h2-2-48" class="i">+        return tasks.toSortedMap(reverseOrder())
</a>     }
 
     @SuppressLint(&quot;Range&quot;)
<a href="#h2-2-52" id="h2-2-52" class="d">-    fun queryTasks(from: Int, amount: Int = 20): Map&lt;Int, PendingDownload&gt; {
</a><a href="#h2-2-53" id="h2-2-53" class="d">-        val cursor = taskDatabase.rawQuery(&quot;SELECT * FROM tasks WHERE id &lt; ? ORDER BY id DESC LIMIT ?&quot;, arrayOf(from.toString(), amount.toString()))
</a><a href="#h2-2-54" id="h2-2-54" class="i">+    fun queryTasks(from: Int, amount: Int = 20, filter: MediaFilter = MediaFilter.NONE): Map&lt;Int, PendingDownload&gt; {
</a><a href="#h2-2-55" id="h2-2-55" class="i">+        if (filter == MediaFilter.PENDING) {
</a><a href="#h2-2-56" id="h2-2-56" class="i">+            return emptyMap()
</a><a href="#h2-2-57" id="h2-2-57" class="i">+        }
</a><a href="#h2-2-58" id="h2-2-58" class="i">+
</a><a href="#h2-2-59" id="h2-2-59" class="i">+        val cursor = taskDatabase.rawQuery(
</a><a href="#h2-2-60" id="h2-2-60" class="i">+            &quot;SELECT * FROM tasks WHERE id &lt; ? AND mediaDisplayType LIKE ? ORDER BY id DESC LIMIT ?&quot;,
</a><a href="#h2-2-61" id="h2-2-61" class="i">+            arrayOf(
</a><a href="#h2-2-62" id="h2-2-62" class="i">+                from.toString(),
</a><a href="#h2-2-63" id="h2-2-63" class="i">+                filter.mediaDisplayType.let { if (it == null) &quot;%&quot; else &quot;%$it&quot; },
</a><a href="#h2-2-64" id="h2-2-64" class="i">+                amount.toString()
</a><a href="#h2-2-65" id="h2-2-65" class="i">+            )
</a><a href="#h2-2-66" id="h2-2-66" class="i">+        )
</a><a href="#h2-2-67" id="h2-2-67" class="i">+
</a>         val result = sortedMapOf&lt;Int, PendingDownload&gt;()
 
         while (cursor.moveToNext()) {
<a href="#h2-3" id="h2-3" class="h">@@ -107,11 +138,13 @@ class DownloadTaskManager {
</a>             result[task.id] = task
         }
         cursor.close()
<a href="#h2-3-3" id="h2-3-3" class="i">+
</a>         return result.toSortedMap(reverseOrder())
     }
 
     fun removeAllTasks() {
         taskDatabase.execSQL(&quot;DELETE FROM tasks&quot;)
         cachedTasks.clear()
<a href="#h2-3-10" id="h2-3-10" class="i">+        pendingTasks.clear()
</a>     }
 } 
\ No newline at end of file
<b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/features/impl/downloader/MediaDownloader.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/downloader/MediaDownloader.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/features/impl/downloader/MediaDownloader.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/downloader/MediaDownloader.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -29,6 +29,7 @@ import me.rhunk.snapenhance.features.impl.spying.MessageLogger
</a> import me.rhunk.snapenhance.hook.HookAdapter
 import me.rhunk.snapenhance.hook.HookStage
 import me.rhunk.snapenhance.hook.Hooker
<a href="#h3-0-3" id="h3-0-3" class="i">+import me.rhunk.snapenhance.ui.download.MediaFilter
</a> import me.rhunk.snapenhance.util.snap.EncryptionHelper
 import me.rhunk.snapenhance.util.snap.MediaDownloaderHelper
 import me.rhunk.snapenhance.util.snap.MediaType
<a href="#h3-1" id="h3-1" class="h">@@ -193,7 +194,7 @@ class MediaDownloader : Feature(&quot;MediaDownloader&quot;, loadParams = FeatureLoadParam
</a> 
             val author = context.database.getFriendInfo(senderId) ?: return
             val authorUsername = author.usernameForSorting!!
<a href="#h3-1-3" id="h3-1-3" class="d">-            downloadOperaMedia(provideClientDownloadManager(authorUsername, authorUsername, &quot;Chat Media&quot;, friendInfo = author), mediaInfoMap)
</a><a href="#h3-1-4" id="h3-1-4" class="i">+            downloadOperaMedia(provideClientDownloadManager(authorUsername, authorUsername, MediaFilter.CHAT_MEDIA.mediaDisplayType, friendInfo = author), mediaInfoMap)
</a>             return
         }
 
<a href="#h3-2" id="h3-2" class="h">@@ -209,7 +210,7 @@ class MediaDownloader : Feature(&quot;MediaDownloader&quot;, loadParams = FeatureLoadParam
</a>             val author = context.database.getFriendInfo(if (storyUserId == &quot;null&quot;) context.database.getMyUserId()!! else storyUserId) ?: return
             val authorName = author.usernameForSorting!!
 
<a href="#h3-2-3" id="h3-2-3" class="d">-            downloadOperaMedia(provideClientDownloadManager(authorName, authorName, &quot;Story&quot;, friendInfo = author), mediaInfoMap, )
</a><a href="#h3-2-4" id="h3-2-4" class="i">+            downloadOperaMedia(provideClientDownloadManager(authorName, authorName, MediaFilter.STORY.mediaDisplayType, friendInfo = author), mediaInfoMap, )
</a>             return
         }
 
<a href="#h3-3" id="h3-3" class="h">@@ -227,7 +228,7 @@ class MediaDownloader : Feature(&quot;MediaDownloader&quot;, loadParams = FeatureLoadParam
</a> 
         //spotlight
         if (snapSource == &quot;SINGLE_SNAP_STORY&quot; &amp;&amp; (forceDownload || canAutoDownload(&quot;spotlight&quot;))) {
<a href="#h3-3-3" id="h3-3-3" class="d">-            downloadOperaMedia(provideClientDownloadManager(&quot;Spotlight&quot;, mediaDisplayType = &quot;Spotlight&quot;, mediaDisplaySource = paramMap[&quot;TIME_STAMP&quot;].toString()), mediaInfoMap)
</a><a href="#h3-3-4" id="h3-3-4" class="i">+            downloadOperaMedia(provideClientDownloadManager(&quot;Spotlight&quot;, mediaDisplayType = MediaFilter.SPOTLIGHT.mediaDisplayType, mediaDisplaySource = paramMap[&quot;TIME_STAMP&quot;].toString()), mediaInfoMap)
</a>             return
         }
 
<a href="#h3-4" id="h3-4" class="h">@@ -383,7 +384,7 @@ class MediaDownloader : Feature(&quot;MediaDownloader&quot;, loadParams = FeatureLoadParam
</a>         runCatching {
             if (!isPreviewMode) {
                 val encryptionKeys = EncryptionHelper.getEncryptionKeys(contentType, messageReader, isArroyo = isArroyoMessage)
<a href="#h3-4-3" id="h3-4-3" class="d">-                provideClientDownloadManager(authorName, authorName, &quot;Chat Media&quot;, friendInfo = friendInfo).downloadMedia(
</a><a href="#h3-4-4" id="h3-4-4" class="i">+                provideClientDownloadManager(authorName, authorName, MediaFilter.CHAT_MEDIA.mediaDisplayType, friendInfo = friendInfo).downloadMedia(
</a>                     Base64.UrlSafe.encode(urlProto),
                     DownloadMediaType.PROTO_MEDIA,
                     encryption = encryptionKeys?.toKeyPair()
<b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/features/impl/ui/UITweaks.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/ui/UITweaks.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/features/impl/ui/UITweaks.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/features/impl/ui/UITweaks.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -19,19 +19,21 @@ class UITweaks : Feature(&quot;UITweaks&quot;, loadParams = FeatureLoadParams.ACTIVITY_CRE
</a>         val isImmersiveCamera = context.config.bool(ConfigProperty.IMMERSIVE_CAMERA_PREVIEW)
         val resources = context.resources
 
<a href="#h4-0-3" id="h4-0-3" class="i">+        fun findIdentifier(name: String, defType: String) = resources.getIdentifier(name, defType, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-4" id="h4-0-4" class="i">+
</a>         val displayMetrics = context.resources.displayMetrics
 
<a href="#h4-0-7" id="h4-0-7" class="d">-        val capriViewfinderDefaultCornerRadius = resources.getIdentifier(&quot;capri_viewfinder_default_corner_radius&quot;, &quot;dimen&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-8" id="h4-0-8" class="d">-        val ngsHovaNavLargerCameraButtonSize = resources.getIdentifier(&quot;ngs_hova_nav_larger_camera_button_size&quot;, &quot;dimen&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-9" id="h4-0-9" class="d">-        val fullScreenSurfaceView = resources.getIdentifier(&quot;full_screen_surface_view&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-10" id="h4-0-10" class="i">+        val capriViewfinderDefaultCornerRadius = findIdentifier(&quot;capri_viewfinder_default_corner_radius&quot;, &quot;dimen&quot;)
</a><a href="#h4-0-11" id="h4-0-11" class="i">+        val ngsHovaNavLargerCameraButtonSize = findIdentifier(&quot;ngs_hova_nav_larger_camera_button_size&quot;, &quot;dimen&quot;)
</a><a href="#h4-0-12" id="h4-0-12" class="i">+        val fullScreenSurfaceView = findIdentifier(&quot;full_screen_surface_view&quot;, &quot;id&quot;)
</a> 
<a href="#h4-0-14" id="h4-0-14" class="d">-        val callButtonsStub = resources.getIdentifier(&quot;call_buttons_stub&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-15" id="h4-0-15" class="d">-        val callButton1 = resources.getIdentifier(&quot;friend_action_button3&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-16" id="h4-0-16" class="d">-        val callButton2 = resources.getIdentifier(&quot;friend_action_button4&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-17" id="h4-0-17" class="i">+        val callButtonsStub = findIdentifier(&quot;call_buttons_stub&quot;, &quot;id&quot;)
</a><a href="#h4-0-18" id="h4-0-18" class="i">+        val callButton1 = findIdentifier(&quot;friend_action_button3&quot;, &quot;id&quot;)
</a><a href="#h4-0-19" id="h4-0-19" class="i">+        val callButton2 = findIdentifier(&quot;friend_action_button4&quot;, &quot;id&quot;)
</a> 
<a href="#h4-0-21" id="h4-0-21" class="d">-        val chatNoteRecordButton = resources.getIdentifier(&quot;chat_note_record_button&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-22" id="h4-0-22" class="d">-        val chatInputBarSticker = resources.getIdentifier(&quot;chat_input_bar_sticker&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-23" id="h4-0-23" class="d">-        val chatInputBarCognac = resources.getIdentifier(&quot;chat_input_bar_cognac&quot;, &quot;id&quot;, Constants.SNAPCHAT_PACKAGE_NAME)
</a><a href="#h4-0-24" id="h4-0-24" class="i">+        val chatNoteRecordButton = findIdentifier(&quot;chat_note_record_button&quot;, &quot;id&quot;)
</a><a href="#h4-0-25" id="h4-0-25" class="i">+        val chatInputBarSticker = findIdentifier(&quot;chat_input_bar_sticker&quot;, &quot;id&quot;)
</a><a href="#h4-0-26" id="h4-0-26" class="i">+        val chatInputBarCognac = findIdentifier(&quot;chat_input_bar_cognac&quot;, &quot;id&quot;)
</a> 
         Resources::class.java.methods.first { it.name == &quot;getDimensionPixelSize&quot;}.hook(HookStage.AFTER,
             { isImmersiveCamera }
<b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/manager/impl/ActionManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/manager/impl/ActionManager.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/manager/impl/ActionManager.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/manager/impl/ActionManager.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -22,9 +22,9 @@ class ActionManager(
</a>         actions[action.nameKey] = action
     }
     override fun init() {
<a href="#h5-0-3" id="h5-0-3" class="d">-        load(CleanCache::class)
</a><a href="#h5-0-4" id="h5-0-4" class="d">-        load(ClearMessageLogger::class)
</a><a href="#h5-0-5" id="h5-0-5" class="d">-        load(RefreshMappings::class)
</a><a href="#h5-0-6" id="h5-0-6" class="i">+        //load(CleanCache::class)
</a><a href="#h5-0-7" id="h5-0-7" class="i">+        //load(ClearMessageLogger::class)
</a><a href="#h5-0-8" id="h5-0-8" class="i">+        //load(RefreshMappings::class)
</a>         load(OpenMap::class)
         load(CheckForUpdates::class)
         load(ExportChatMessages::class)
<b>diff --git a/<a id="h6" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadListAdapter.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadListAdapter.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadListAdapter.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadListAdapter.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -131,7 +131,7 @@ class DownloadListAdapter(
</a>             }
         }
 
<a href="#h6-0-3" id="h6-0-3" class="d">-        holder.bitmojiIcon.visibility = View.GONE
</a><a href="#h6-0-4" id="h6-0-4" class="i">+        holder.bitmojiIcon.setImageResource(R.drawable.bitmoji_blank)
</a> 
         pendingDownload.iconUrl?.let { url -&gt;
             thread(start = true) {
<a href="#h6-1" id="h6-1" class="h">@@ -141,7 +141,6 @@ class DownloadListAdapter(
</a>                     }
                     Handler(holder.view.context.mainLooper).post {
                         holder.bitmojiIcon.setImageBitmap(iconBitmap)
<a href="#h6-1-3" id="h6-1-3" class="d">-                        holder.bitmojiIcon.visibility = View.VISIBLE
</a>                     }
                 }
             }
<b>diff --git a/<a id="h7" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadManagerActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadManagerActivity.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadManagerActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/DownloadManagerActivity.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -2,23 +2,33 @@ package me.rhunk.snapenhance.ui.download
</a> 
 import android.annotation.SuppressLint
 import android.app.Activity
<a href="#h7-0-3" id="h7-0-3" class="i">+import android.app.AlertDialog
</a> import android.content.Context
 import android.content.Intent
<a href="#h7-0-6" id="h7-0-6" class="d">-import android.graphics.drawable.ColorDrawable
</a> import android.net.Uri
 import android.os.Bundle
 import android.os.PowerManager
 import android.provider.Settings
 import android.view.View
<a href="#h7-0-12" id="h7-0-12" class="i">+import android.view.ViewGroup
</a> import android.widget.Button
<a href="#h7-0-14" id="h7-0-14" class="i">+import android.widget.ImageButton
</a><a href="#h7-0-15" id="h7-0-15" class="i">+import android.widget.TextView
</a> import androidx.recyclerview.widget.ItemTouchHelper
 import androidx.recyclerview.widget.RecyclerView
<a href="#h7-0-18" id="h7-0-18" class="i">+import me.rhunk.snapenhance.BuildConfig
</a> import me.rhunk.snapenhance.R
 import me.rhunk.snapenhance.download.MediaDownloadReceiver
 import me.rhunk.snapenhance.download.data.PendingDownload
 
 class DownloadManagerActivity : Activity() {
<a href="#h7-0-24" id="h7-0-24" class="i">+    private val backCallbacks = mutableListOf&lt;() -&gt; Unit&gt;()
</a>     private val fetchedDownloadTasks = mutableListOf&lt;PendingDownload&gt;()
<a href="#h7-0-26" id="h7-0-26" class="i">+    private var listFilter = MediaFilter.NONE
</a><a href="#h7-0-27" id="h7-0-27" class="i">+
</a><a href="#h7-0-28" id="h7-0-28" class="i">+    private val downloadTaskManager by lazy {
</a><a href="#h7-0-29" id="h7-0-29" class="i">+        MediaDownloadReceiver.downloadTaskManager.also { it.init(this) }
</a><a href="#h7-0-30" id="h7-0-30" class="i">+    }
</a> 
     private val preferences by lazy {
         getSharedPreferences(&quot;settings&quot;, Context.MODE_PRIVATE)
<a href="#h7-1" id="h7-1" class="h">@@ -30,21 +40,47 @@ class DownloadManagerActivity : Activity() {
</a>         }
     }
 
<a href="#h7-1-3" id="h7-1-3" class="d">-    @SuppressLint(&quot;BatteryLife&quot;, &quot;NotifyDataSetChanged&quot;)
</a><a href="#h7-1-4" id="h7-1-4" class="d">-    override fun onCreate(savedInstanceState: Bundle?) {
</a><a href="#h7-1-5" id="h7-1-5" class="d">-        super.onCreate(savedInstanceState)
</a><a href="#h7-1-6" id="h7-1-6" class="d">-        val downloadTaskManager = MediaDownloadReceiver.downloadTaskManager.also { it.init(this) }
</a><a href="#h7-1-7" id="h7-1-7" class="i">+    @SuppressLint(&quot;NotifyDataSetChanged&quot;)
</a><a href="#h7-1-8" id="h7-1-8" class="i">+    private fun updateListContent() {
</a><a href="#h7-1-9" id="h7-1-9" class="i">+        fetchedDownloadTasks.clear()
</a><a href="#h7-1-10" id="h7-1-10" class="i">+        fetchedDownloadTasks.addAll(downloadTaskManager.queryAllTasks(filter = listFilter).values)
</a> 
<a href="#h7-1-12" id="h7-1-12" class="d">-        actionBar?.apply {
</a><a href="#h7-1-13" id="h7-1-13" class="d">-            title = &quot;Download Manager&quot;
</a><a href="#h7-1-14" id="h7-1-14" class="d">-            setBackgroundDrawable(ColorDrawable(getColor(R.color.actionBarColor)))
</a><a href="#h7-1-15" id="h7-1-15" class="i">+        with(findViewById&lt;RecyclerView&gt;(R.id.download_list)) {
</a><a href="#h7-1-16" id="h7-1-16" class="i">+            adapter?.notifyDataSetChanged()
</a><a href="#h7-1-17" id="h7-1-17" class="i">+            scrollToPosition(0)
</a>         }
<a href="#h7-1-19" id="h7-1-19" class="d">-        setContentView(R.layout.download_manager_activity)
</a><a href="#h7-1-20" id="h7-1-20" class="i">+        updateNoDownloadText()
</a><a href="#h7-1-21" id="h7-1-21" class="i">+    }
</a> 
<a href="#h7-1-23" id="h7-1-23" class="d">-        fetchedDownloadTasks.addAll(downloadTaskManager.queryAllTasks().values)
</a><a href="#h7-1-24" id="h7-1-24" class="i">+    @Deprecated(&quot;Deprecated in Java&quot;)
</a><a href="#h7-1-25" id="h7-1-25" class="i">+    @Suppress(&quot;DEPRECATION&quot;)
</a><a href="#h7-1-26" id="h7-1-26" class="i">+    override fun onBackPressed() {
</a><a href="#h7-1-27" id="h7-1-27" class="i">+        backCallbacks.lastOrNull()?.let {
</a><a href="#h7-1-28" id="h7-1-28" class="i">+            it()
</a><a href="#h7-1-29" id="h7-1-29" class="i">+            backCallbacks.removeLast()
</a><a href="#h7-1-30" id="h7-1-30" class="i">+        } ?: super.onBackPressed()
</a><a href="#h7-1-31" id="h7-1-31" class="i">+    }
</a><a href="#h7-1-32" id="h7-1-32" class="i">+
</a><a href="#h7-1-33" id="h7-1-33" class="i">+    fun registerBackCallback(callback: () -&gt; Unit) {
</a><a href="#h7-1-34" id="h7-1-34" class="i">+        backCallbacks.add(callback)
</a><a href="#h7-1-35" id="h7-1-35" class="i">+    }
</a><a href="#h7-1-36" id="h7-1-36" class="i">+
</a><a href="#h7-1-37" id="h7-1-37" class="i">+    @SuppressLint(&quot;BatteryLife&quot;, &quot;NotifyDataSetChanged&quot;, &quot;SetTextI18n&quot;)
</a><a href="#h7-1-38" id="h7-1-38" class="i">+    override fun onCreate(savedInstanceState: Bundle?) {
</a><a href="#h7-1-39" id="h7-1-39" class="i">+        super.onCreate(savedInstanceState)
</a><a href="#h7-1-40" id="h7-1-40" class="i">+        
</a><a href="#h7-1-41" id="h7-1-41" class="i">+        setContentView(R.layout.download_manager_activity)
</a> 
<a href="#h7-1-43" id="h7-1-43" class="i">+        window.navigationBarColor = getColor(R.color.primaryBackground)
</a><a href="#h7-1-44" id="h7-1-44" class="i">+        findViewById&lt;TextView&gt;(R.id.title).text = resources.getString(R.string.app_name) + &quot; &quot; + BuildConfig.VERSION_NAME
</a> 
<a href="#h7-1-46" id="h7-1-46" class="i">+        findViewById&lt;ImageButton&gt;(R.id.settings_button).setOnClickListener {
</a><a href="#h7-1-47" id="h7-1-47" class="i">+            SettingLayoutInflater(this).inflate(findViewById&lt;ViewGroup&gt;(android.R.id.content))
</a><a href="#h7-1-48" id="h7-1-48" class="i">+        }
</a><a href="#h7-1-49" id="h7-1-49" class="i">+        
</a>         with(findViewById&lt;RecyclerView&gt;(R.id.download_list)) {
<a href="#h7-1-51" id="h7-1-51" class="i">+            layoutManager = androidx.recyclerview.widget.LinearLayoutManager(this@DownloadManagerActivity)
</a><a href="#h7-1-52" id="h7-1-52" class="i">+
</a>             adapter = DownloadListAdapter(fetchedDownloadTasks).apply {
                 registerAdapterDataObserver(object : RecyclerView.AdapterDataObserver() {
                     override fun onItemRangeRemoved(positionStart: Int, itemCount: Int) {
<a href="#h7-2" id="h7-2" class="h">@@ -53,8 +89,6 @@ class DownloadManagerActivity : Activity() {
</a>                 })
             }
 
<a href="#h7-2-3" id="h7-2-3" class="d">-            layoutManager = androidx.recyclerview.widget.LinearLayoutManager(this@DownloadManagerActivity)
</a><a href="#h7-2-4" id="h7-2-4" class="d">-
</a>             ItemTouchHelper(object : ItemTouchHelper.SimpleCallback(0, ItemTouchHelper.LEFT or ItemTouchHelper.RIGHT) {
                 override fun getMovementFlags(
                     recyclerView: RecyclerView,
<a href="#h7-3" id="h7-3" class="h">@@ -99,7 +133,7 @@ class DownloadManagerActivity : Activity() {
</a>                     if (lastVisibleItemPosition == fetchedDownloadTasks.size - 1 &amp;&amp; !isLoading) {
                         isLoading = true
 
<a href="#h7-3-3" id="h7-3-3" class="d">-                        downloadTaskManager.queryTasks(fetchedDownloadTasks.last().id).forEach {
</a><a href="#h7-3-4" id="h7-3-4" class="i">+                        downloadTaskManager.queryTasks(fetchedDownloadTasks.last().id, filter = listFilter).forEach {
</a>                             fetchedDownloadTasks.add(it.value)
                             adapter?.notifyItemInserted(fetchedDownloadTasks.size - 1)
                         }
<a href="#h7-4" id="h7-4" class="h">@@ -108,31 +142,57 @@ class DownloadManagerActivity : Activity() {
</a>                     }
                 }
             })
<a href="#h7-4-3" id="h7-4-3" class="i">+    
</a><a href="#h7-4-4" id="h7-4-4" class="i">+            arrayOf(
</a><a href="#h7-4-5" id="h7-4-5" class="i">+                Pair(R.id.all_category, MediaFilter.NONE),
</a><a href="#h7-4-6" id="h7-4-6" class="i">+                Pair(R.id.pending_category, MediaFilter.PENDING),
</a><a href="#h7-4-7" id="h7-4-7" class="i">+                Pair(R.id.snap_category, MediaFilter.CHAT_MEDIA),
</a><a href="#h7-4-8" id="h7-4-8" class="i">+                Pair(R.id.story_category, MediaFilter.STORY),
</a><a href="#h7-4-9" id="h7-4-9" class="i">+                Pair(R.id.spotlight_category, MediaFilter.SPOTLIGHT)
</a><a href="#h7-4-10" id="h7-4-10" class="i">+            ).let { categoryPairs -&gt;
</a><a href="#h7-4-11" id="h7-4-11" class="i">+                categoryPairs.forEach { pair -&gt;
</a><a href="#h7-4-12" id="h7-4-12" class="i">+                    this@DownloadManagerActivity.findViewById&lt;TextView&gt;(pair.first).setOnClickListener { view -&gt;
</a><a href="#h7-4-13" id="h7-4-13" class="i">+                        listFilter = pair.second
</a><a href="#h7-4-14" id="h7-4-14" class="i">+                        updateListContent()
</a><a href="#h7-4-15" id="h7-4-15" class="i">+                        categoryPairs.map { this@DownloadManagerActivity.findViewById&lt;TextView&gt;(it.first) }.forEach {
</a><a href="#h7-4-16" id="h7-4-16" class="i">+                            it.setTextColor(getColor(R.color.primaryText))
</a><a href="#h7-4-17" id="h7-4-17" class="i">+                        }
</a><a href="#h7-4-18" id="h7-4-18" class="i">+                        (view as TextView).setTextColor(getColor(R.color.focusedCategoryColor))
</a><a href="#h7-4-19" id="h7-4-19" class="i">+                    }
</a><a href="#h7-4-20" id="h7-4-20" class="i">+                }
</a><a href="#h7-4-21" id="h7-4-21" class="i">+            }
</a> 
<a href="#h7-4-23" id="h7-4-23" class="d">-            with(this@DownloadManagerActivity.findViewById&lt;Button&gt;(R.id.remove_all_button)) {
</a><a href="#h7-4-24" id="h7-4-24" class="d">-                setOnClickListener {
</a><a href="#h7-4-25" id="h7-4-25" class="d">-                    downloadTaskManager.removeAllTasks()
</a><a href="#h7-4-26" id="h7-4-26" class="d">-                    fetchedDownloadTasks.removeIf {
</a><a href="#h7-4-27" id="h7-4-27" class="d">-                        if (it.isJobActive()) it.cancel()
</a><a href="#h7-4-28" id="h7-4-28" class="d">-                        true
</a><a href="#h7-4-29" id="h7-4-29" class="i">+            this@DownloadManagerActivity.findViewById&lt;Button&gt;(R.id.remove_all_button).setOnClickListener {
</a><a href="#h7-4-30" id="h7-4-30" class="i">+                with(AlertDialog.Builder(this@DownloadManagerActivity)) {
</a><a href="#h7-4-31" id="h7-4-31" class="i">+                    setTitle(R.string.remove_all_title)
</a><a href="#h7-4-32" id="h7-4-32" class="i">+                    setMessage(R.string.remove_all_text)
</a><a href="#h7-4-33" id="h7-4-33" class="i">+                    setPositiveButton(&quot;Yes&quot;) { _, _ -&gt;
</a><a href="#h7-4-34" id="h7-4-34" class="i">+                        downloadTaskManager.removeAllTasks()
</a><a href="#h7-4-35" id="h7-4-35" class="i">+                        fetchedDownloadTasks.removeIf {
</a><a href="#h7-4-36" id="h7-4-36" class="i">+                            if (it.isJobActive()) it.cancel()
</a><a href="#h7-4-37" id="h7-4-37" class="i">+                            true
</a><a href="#h7-4-38" id="h7-4-38" class="i">+                        }
</a><a href="#h7-4-39" id="h7-4-39" class="i">+                        adapter?.notifyDataSetChanged()
</a><a href="#h7-4-40" id="h7-4-40" class="i">+                        updateNoDownloadText()
</a>                     }
<a href="#h7-4-42" id="h7-4-42" class="d">-                    adapter?.notifyDataSetChanged()
</a><a href="#h7-4-43" id="h7-4-43" class="d">-                    updateNoDownloadText()
</a><a href="#h7-4-44" id="h7-4-44" class="i">+                    setNegativeButton(&quot;Cancel&quot;) { dialog, _ -&gt;
</a><a href="#h7-4-45" id="h7-4-45" class="i">+                        dialog.dismiss()
</a><a href="#h7-4-46" id="h7-4-46" class="i">+                    }
</a><a href="#h7-4-47" id="h7-4-47" class="i">+                    show()
</a>                 }
             }
<a href="#h7-4-50" id="h7-4-50" class="i">+
</a>         }
 
<a href="#h7-4-53" id="h7-4-53" class="d">-        updateNoDownloadText()
</a><a href="#h7-4-54" id="h7-4-54" class="i">+        updateListContent()
</a> 
<a href="#h7-4-56" id="h7-4-56" class="d">-        if (preferences.getBoolean(&quot;ask_battery_optimisations&quot;, true)) {
</a><a href="#h7-4-57" id="h7-4-57" class="d">-            val pm = getSystemService(Context.POWER_SERVICE) as PowerManager
</a><a href="#h7-4-58" id="h7-4-58" class="d">-            if (!pm.isIgnoringBatteryOptimizations(packageName)) {
</a><a href="#h7-4-59" id="h7-4-59" class="d">-                with(Intent()) {
</a><a href="#h7-4-60" id="h7-4-60" class="d">-                    action = Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS
</a><a href="#h7-4-61" id="h7-4-61" class="d">-                    data = Uri.parse(&quot;package:$packageName&quot;)
</a><a href="#h7-4-62" id="h7-4-62" class="d">-                    startActivityForResult(this, 1)
</a><a href="#h7-4-63" id="h7-4-63" class="d">-                }
</a><a href="#h7-4-64" id="h7-4-64" class="d">-            }
</a><a href="#h7-4-65" id="h7-4-65" class="i">+        if (!preferences.getBoolean(&quot;ask_battery_optimisations&quot;, true) ||
</a><a href="#h7-4-66" id="h7-4-66" class="i">+            !(getSystemService(Context.POWER_SERVICE) as PowerManager).isIgnoringBatteryOptimizations(packageName)) return
</a><a href="#h7-4-67" id="h7-4-67" class="i">+
</a><a href="#h7-4-68" id="h7-4-68" class="i">+        with(Intent()) {
</a><a href="#h7-4-69" id="h7-4-69" class="i">+            action = Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS
</a><a href="#h7-4-70" id="h7-4-70" class="i">+            data = Uri.parse(&quot;package:$packageName&quot;)
</a><a href="#h7-4-71" id="h7-4-71" class="i">+            startActivityForResult(this, 1)
</a>         }
     }
 
<a href="#h7-5" id="h7-5" class="h">@@ -145,12 +205,6 @@ class DownloadManagerActivity : Activity() {
</a>     @SuppressLint(&quot;NotifyDataSetChanged&quot;)
     override fun onResume() {
         super.onResume()
<a href="#h7-5-3" id="h7-5-3" class="d">-        fetchedDownloadTasks.clear()
</a><a href="#h7-5-4" id="h7-5-4" class="d">-        fetchedDownloadTasks.addAll(MediaDownloadReceiver.downloadTaskManager.queryAllTasks().values)
</a><a href="#h7-5-5" id="h7-5-5" class="d">-
</a><a href="#h7-5-6" id="h7-5-6" class="d">-        with(findViewById&lt;RecyclerView&gt;(R.id.download_list)) {
</a><a href="#h7-5-7" id="h7-5-7" class="d">-            adapter?.notifyDataSetChanged()
</a><a href="#h7-5-8" id="h7-5-8" class="d">-        }
</a><a href="#h7-5-9" id="h7-5-9" class="d">-        updateNoDownloadText()
</a><a href="#h7-5-10" id="h7-5-10" class="i">+        updateListContent()
</a>     }
 } 
\ No newline at end of file
<b>diff --git a/<a id="h8" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/MediaFilter.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/MediaFilter.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/MediaFilter.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/MediaFilter.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -0,0 +1,17 @@
</a><a href="#h8-0-0" id="h8-0-0" class="i">+package me.rhunk.snapenhance.ui.download
</a><a href="#h8-0-1" id="h8-0-1" class="i">+
</a><a href="#h8-0-2" id="h8-0-2" class="i">+enum class MediaFilter(
</a><a href="#h8-0-3" id="h8-0-3" class="i">+    val mediaDisplayType: String? = null
</a><a href="#h8-0-4" id="h8-0-4" class="i">+) {
</a><a href="#h8-0-5" id="h8-0-5" class="i">+    NONE,
</a><a href="#h8-0-6" id="h8-0-6" class="i">+    PENDING,
</a><a href="#h8-0-7" id="h8-0-7" class="i">+    CHAT_MEDIA(&quot;Chat Media&quot;),
</a><a href="#h8-0-8" id="h8-0-8" class="i">+    STORY(&quot;Story&quot;),
</a><a href="#h8-0-9" id="h8-0-9" class="i">+    SPOTLIGHT(&quot;Spotlight&quot;);
</a><a href="#h8-0-10" id="h8-0-10" class="i">+
</a><a href="#h8-0-11" id="h8-0-11" class="i">+    fun matches(source: String?): Boolean {
</a><a href="#h8-0-12" id="h8-0-12" class="i">+        if (mediaDisplayType == null) return true
</a><a href="#h8-0-13" id="h8-0-13" class="i">+        if (source == null) return false
</a><a href="#h8-0-14" id="h8-0-14" class="i">+        return source.contains(mediaDisplayType, ignoreCase = true)
</a><a href="#h8-0-15" id="h8-0-15" class="i">+    }
</a><a href="#h8-0-16" id="h8-0-16" class="i">+}</a><a href="#h8-0-17" id="h8-0-17" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h9" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/SettingLayoutInflater.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/SettingLayoutInflater.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/download/SettingLayoutInflater.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/download/SettingLayoutInflater.kt</a></b>
<a href="#h9-0" id="h9-0" class="h">@@ -0,0 +1,96 @@
</a><a href="#h9-0-0" id="h9-0-0" class="i">+package me.rhunk.snapenhance.ui.download
</a><a href="#h9-0-1" id="h9-0-1" class="i">+
</a><a href="#h9-0-2" id="h9-0-2" class="i">+import android.app.AlertDialog
</a><a href="#h9-0-3" id="h9-0-3" class="i">+import android.view.View
</a><a href="#h9-0-4" id="h9-0-4" class="i">+import android.view.ViewGroup
</a><a href="#h9-0-5" id="h9-0-5" class="i">+import android.widget.ArrayAdapter
</a><a href="#h9-0-6" id="h9-0-6" class="i">+import android.widget.ImageButton
</a><a href="#h9-0-7" id="h9-0-7" class="i">+import android.widget.ListView
</a><a href="#h9-0-8" id="h9-0-8" class="i">+import android.widget.TextView
</a><a href="#h9-0-9" id="h9-0-9" class="i">+import android.widget.Toast
</a><a href="#h9-0-10" id="h9-0-10" class="i">+import me.rhunk.snapenhance.R
</a><a href="#h9-0-11" id="h9-0-11" class="i">+import me.rhunk.snapenhance.bridge.common.impl.file.BridgeFileType
</a><a href="#h9-0-12" id="h9-0-12" class="i">+import java.io.File
</a><a href="#h9-0-13" id="h9-0-13" class="i">+
</a><a href="#h9-0-14" id="h9-0-14" class="i">+class SettingAdapter(
</a><a href="#h9-0-15" id="h9-0-15" class="i">+    private val activity: DownloadManagerActivity,
</a><a href="#h9-0-16" id="h9-0-16" class="i">+    private val layoutId: Int,
</a><a href="#h9-0-17" id="h9-0-17" class="i">+    private val actions: Array&lt;Pair&lt;String, () -&gt; Unit&gt;&gt;
</a><a href="#h9-0-18" id="h9-0-18" class="i">+) : ArrayAdapter&lt;Pair&lt;String, () -&gt; Unit&gt;&gt;(activity, layoutId, actions) {
</a><a href="#h9-0-19" id="h9-0-19" class="i">+    override fun getView(position: Int, convertView: View?, parent: ViewGroup): View {
</a><a href="#h9-0-20" id="h9-0-20" class="i">+        val view = convertView ?: activity.layoutInflater.inflate(layoutId, parent, false)
</a><a href="#h9-0-21" id="h9-0-21" class="i">+        val action = actions[position]
</a><a href="#h9-0-22" id="h9-0-22" class="i">+        view.isClickable = true
</a><a href="#h9-0-23" id="h9-0-23" class="i">+
</a><a href="#h9-0-24" id="h9-0-24" class="i">+        view.findViewById&lt;TextView&gt;(R.id.feature_text).text = action.first
</a><a href="#h9-0-25" id="h9-0-25" class="i">+        view.setOnClickListener {
</a><a href="#h9-0-26" id="h9-0-26" class="i">+            action.second()
</a><a href="#h9-0-27" id="h9-0-27" class="i">+        }
</a><a href="#h9-0-28" id="h9-0-28" class="i">+
</a><a href="#h9-0-29" id="h9-0-29" class="i">+        return view
</a><a href="#h9-0-30" id="h9-0-30" class="i">+    }
</a><a href="#h9-0-31" id="h9-0-31" class="i">+}
</a><a href="#h9-0-32" id="h9-0-32" class="i">+
</a><a href="#h9-0-33" id="h9-0-33" class="i">+class SettingLayoutInflater(
</a><a href="#h9-0-34" id="h9-0-34" class="i">+    private val activity: DownloadManagerActivity
</a><a href="#h9-0-35" id="h9-0-35" class="i">+) {
</a><a href="#h9-0-36" id="h9-0-36" class="i">+    private fun confirmAction(title: String, message: String, action: () -&gt; Unit) {
</a><a href="#h9-0-37" id="h9-0-37" class="i">+        activity.runOnUiThread {
</a><a href="#h9-0-38" id="h9-0-38" class="i">+            AlertDialog.Builder(activity)
</a><a href="#h9-0-39" id="h9-0-39" class="i">+                .setTitle(title)
</a><a href="#h9-0-40" id="h9-0-40" class="i">+                .setMessage(message)
</a><a href="#h9-0-41" id="h9-0-41" class="i">+                .setPositiveButton(&quot;Yes&quot;) { _, _ -&gt;
</a><a href="#h9-0-42" id="h9-0-42" class="i">+                    action()
</a><a href="#h9-0-43" id="h9-0-43" class="i">+                }
</a><a href="#h9-0-44" id="h9-0-44" class="i">+                .setNegativeButton(&quot;No&quot;) { _, _ -&gt; }
</a><a href="#h9-0-45" id="h9-0-45" class="i">+                .show()
</a><a href="#h9-0-46" id="h9-0-46" class="i">+        }
</a><a href="#h9-0-47" id="h9-0-47" class="i">+    }
</a><a href="#h9-0-48" id="h9-0-48" class="i">+
</a><a href="#h9-0-49" id="h9-0-49" class="i">+
</a><a href="#h9-0-50" id="h9-0-50" class="i">+    fun inflate(parent: ViewGroup) {
</a><a href="#h9-0-51" id="h9-0-51" class="i">+        val settingsView = activity.layoutInflater.inflate(R.layout.settings_page, parent, false)
</a><a href="#h9-0-52" id="h9-0-52" class="i">+
</a><a href="#h9-0-53" id="h9-0-53" class="i">+        settingsView.findViewById&lt;ImageButton&gt;(R.id.settings_button).setOnClickListener {
</a><a href="#h9-0-54" id="h9-0-54" class="i">+            parent.removeView(settingsView)
</a><a href="#h9-0-55" id="h9-0-55" class="i">+        }
</a><a href="#h9-0-56" id="h9-0-56" class="i">+
</a><a href="#h9-0-57" id="h9-0-57" class="i">+        settingsView.findViewById&lt;ListView&gt;(R.id.setting_page_list).apply {
</a><a href="#h9-0-58" id="h9-0-58" class="i">+            adapter = SettingAdapter(activity, R.layout.setting_item, mutableListOf&lt;Pair&lt;String, () -&gt; Unit&gt;&gt;().apply {
</a><a href="#h9-0-59" id="h9-0-59" class="i">+                add(&quot;Clear Cache&quot; to {
</a><a href="#h9-0-60" id="h9-0-60" class="i">+                    context.cacheDir.listFiles()?.forEach {
</a><a href="#h9-0-61" id="h9-0-61" class="i">+                        it.deleteRecursively()
</a><a href="#h9-0-62" id="h9-0-62" class="i">+                    }
</a><a href="#h9-0-63" id="h9-0-63" class="i">+                    Toast.makeText(context, &quot;Cache cleared&quot;, Toast.LENGTH_SHORT).show()
</a><a href="#h9-0-64" id="h9-0-64" class="i">+                })
</a><a href="#h9-0-65" id="h9-0-65" class="i">+
</a><a href="#h9-0-66" id="h9-0-66" class="i">+                BridgeFileType.values().forEach { fileType -&gt;
</a><a href="#h9-0-67" id="h9-0-67" class="i">+                    val actionName = &quot;Clear ${fileType.displayName} File&quot;
</a><a href="#h9-0-68" id="h9-0-68" class="i">+                    add(actionName to {
</a><a href="#h9-0-69" id="h9-0-69" class="i">+                        confirmAction(actionName, &quot;Are you sure you want to clear ${fileType.displayName} file?&quot;) {
</a><a href="#h9-0-70" id="h9-0-70" class="i">+                            fileType.resolve(context).deleteRecursively()
</a><a href="#h9-0-71" id="h9-0-71" class="i">+                            Toast.makeText(context, &quot;${fileType.displayName} file cleared&quot;, Toast.LENGTH_SHORT).show()
</a><a href="#h9-0-72" id="h9-0-72" class="i">+                        }
</a><a href="#h9-0-73" id="h9-0-73" class="i">+                    })
</a><a href="#h9-0-74" id="h9-0-74" class="i">+                }
</a><a href="#h9-0-75" id="h9-0-75" class="i">+
</a><a href="#h9-0-76" id="h9-0-76" class="i">+                add(&quot;Reset All&quot; to {
</a><a href="#h9-0-77" id="h9-0-77" class="i">+                    confirmAction(&quot;Reset All&quot;, &quot;Are you sure you want to reset all?&quot;) {
</a><a href="#h9-0-78" id="h9-0-78" class="i">+                        arrayOf(context.cacheDir, context.filesDir, File(context.dataDir, &quot;databases&quot;), File(context.dataDir, &quot;shared_prefs&quot;)).forEach {
</a><a href="#h9-0-79" id="h9-0-79" class="i">+                            it.listFiles()?.forEach { file -&gt;
</a><a href="#h9-0-80" id="h9-0-80" class="i">+                                file.deleteRecursively()
</a><a href="#h9-0-81" id="h9-0-81" class="i">+                            }
</a><a href="#h9-0-82" id="h9-0-82" class="i">+                        }
</a><a href="#h9-0-83" id="h9-0-83" class="i">+                        Toast.makeText(context, &quot;Success!&quot;, Toast.LENGTH_SHORT).show()
</a><a href="#h9-0-84" id="h9-0-84" class="i">+                    }
</a><a href="#h9-0-85" id="h9-0-85" class="i">+                })
</a><a href="#h9-0-86" id="h9-0-86" class="i">+            }.toTypedArray())
</a><a href="#h9-0-87" id="h9-0-87" class="i">+        }
</a><a href="#h9-0-88" id="h9-0-88" class="i">+
</a><a href="#h9-0-89" id="h9-0-89" class="i">+        activity.registerBackCallback {
</a><a href="#h9-0-90" id="h9-0-90" class="i">+            parent.removeView(settingsView)
</a><a href="#h9-0-91" id="h9-0-91" class="i">+        }
</a><a href="#h9-0-92" id="h9-0-92" class="i">+
</a><a href="#h9-0-93" id="h9-0-93" class="i">+        parent.addView(settingsView)
</a><a href="#h9-0-94" id="h9-0-94" class="i">+    }
</a><a href="#h9-0-95" id="h9-0-95" class="i">+}</a><a href="#h9-0-96" id="h9-0-96" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h10" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/util/snap/MediaDownloaderHelper.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/util/snap/MediaDownloaderHelper.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/util/snap/MediaDownloaderHelper.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/util/snap/MediaDownloaderHelper.kt</a></b>
<a href="#h10-0" id="h10-0" class="h">@@ -75,6 +75,8 @@ object MediaDownloaderHelper {
</a>             Executors.newSingleThreadExecutor())
     }
 
<a href="#h10-0-3" id="h10-0-3" class="i">+    //TODO: implement setting parameters
</a><a href="#h10-0-4" id="h10-0-4" class="i">+
</a>     suspend fun downloadDashChapterFile(
         dashPlaylist: File,
         output: File,
<a href="#h10-1" id="h10-1" class="h">@@ -82,7 +84,7 @@ object MediaDownloaderHelper {
</a>         duration: Long?) {
         runFFmpegAsync(
             &quot;-y&quot;, &quot;-i&quot;, dashPlaylist.absolutePath, &quot;-ss&quot;, &quot;&#39;${startTime}ms&#39;&quot;, *(if (duration != null) arrayOf(&quot;-t&quot;, &quot;&#39;${duration}ms&#39;&quot;) else arrayOf()),
<a href="#h10-1-3" id="h10-1-3" class="d">-            &quot;-c:v&quot;, &quot;libx264&quot;, &quot;-threads&quot;, &quot;6&quot;, &quot;-q:v&quot;, &quot;13&quot;, output.absolutePath
</a><a href="#h10-1-4" id="h10-1-4" class="i">+            &quot;-c:v&quot;, &quot;libx264&quot;, &quot;-preset&quot;, &quot;ultrafast&quot;, &quot;-threads&quot;, &quot;6&quot;, &quot;-q:v&quot;, &quot;13&quot;, output.absolutePath
</a>         )
     }
 
<a href="#h10-2" id="h10-2" class="h">@@ -94,7 +96,7 @@ object MediaDownloaderHelper {
</a>         runFFmpegAsync(
             &quot;-y&quot;, &quot;-i&quot;, media.absolutePath, &quot;-i&quot;, overlay.absolutePath,
             &quot;-filter_complex&quot;, &quot;\&quot;[0]scale2ref[img][vid];[img]setsar=1[img];[vid]nullsink;[img][1]overlay=(W-w)/2:(H-h)/2,scale=2*trunc(iw*sar/2):2*trunc(ih/2)\&quot;&quot;,
<a href="#h10-2-3" id="h10-2-3" class="d">-            &quot;-c:v&quot;, &quot;libx264&quot;, &quot;-b:v&quot;, &quot;5M&quot;, &quot;-c:a&quot;, &quot;copy&quot;, &quot;-threads&quot;, &quot;6&quot;, output.absolutePath
</a><a href="#h10-2-4" id="h10-2-4" class="i">+            &quot;-c:v&quot;, &quot;libx264&quot;, &quot;-b:v&quot;, &quot;5M&quot;, &quot;-c:a&quot;, &quot;copy&quot;, &quot;-preset&quot;, &quot;ultrafast&quot;, &quot;-threads&quot;, &quot;6&quot;, output.absolutePath
</a>         )
     }
 } 
\ No newline at end of file
<b>diff --git a/<a id="h11" href="../file/app/src/main/res/drawable/back_arrow.xml.html">app/src/main/res/drawable/back_arrow.xml</a> b/<a href="../file/app/src/main/res/drawable/back_arrow.xml.html">app/src/main/res/drawable/back_arrow.xml</a></b>
<a href="#h11-0" id="h11-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h11-0-0" id="h11-0-0" class="i">+&lt;vector android:height=&quot;25dp&quot; android:viewportHeight=&quot;512&quot;
</a><a href="#h11-0-1" id="h11-0-1" class="i">+    android:viewportWidth=&quot;512&quot; android:width=&quot;25dp&quot; xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
</a><a href="#h11-0-2" id="h11-0-2" class="i">+    &lt;path android:fillColor=&quot;#00000000&quot;
</a><a href="#h11-0-3" id="h11-0-3" class="i">+        android:pathData=&quot;M244,400l-144,-144l144,-144&quot;
</a><a href="#h11-0-4" id="h11-0-4" class="i">+        android:strokeColor=&quot;#FFFFFF&quot; android:strokeLineCap=&quot;round&quot;
</a><a href="#h11-0-5" id="h11-0-5" class="i">+        android:strokeLineJoin=&quot;round&quot; android:strokeWidth=&quot;48&quot;/&gt;
</a><a href="#h11-0-6" id="h11-0-6" class="i">+    &lt;path android:fillColor=&quot;#00000000&quot;
</a><a href="#h11-0-7" id="h11-0-7" class="i">+        android:pathData=&quot;M120,256L412,256&quot;
</a><a href="#h11-0-8" id="h11-0-8" class="i">+        android:strokeColor=&quot;#FFFFFF&quot; android:strokeLineCap=&quot;round&quot;
</a><a href="#h11-0-9" id="h11-0-9" class="i">+        android:strokeLineJoin=&quot;round&quot; android:strokeWidth=&quot;48&quot;/&gt;
</a><a href="#h11-0-10" id="h11-0-10" class="i">+&lt;/vector&gt;
</a><b>diff --git a/<a id="h12" href="../file/app/src/main/res/drawable/bitmoji_blank.xml.html">app/src/main/res/drawable/bitmoji_blank.xml</a> b/<a href="../file/app/src/main/res/drawable/bitmoji_blank.xml.html">app/src/main/res/drawable/bitmoji_blank.xml</a></b>
<a href="#h12-0" id="h12-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h12-0-0" id="h12-0-0" class="i">+&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a><a href="#h12-0-1" id="h12-0-1" class="i">+    android:width=&quot;90dp&quot;
</a><a href="#h12-0-2" id="h12-0-2" class="i">+    android:height=&quot;90dp&quot;
</a><a href="#h12-0-3" id="h12-0-3" class="i">+    android:viewportWidth=&quot;90&quot;
</a><a href="#h12-0-4" id="h12-0-4" class="i">+    android:viewportHeight=&quot;90&quot;&gt;
</a><a href="#h12-0-5" id="h12-0-5" class="i">+  &lt;path
</a><a href="#h12-0-6" id="h12-0-6" class="i">+      android:pathData=&quot;M45,90.1c10.8,0 20.8,-3.8 28.6,-10.2c-1.4,-2.1 -3,-3.6 -4.7,-5c-5.2,-4.1 -12.6,-5.6 -17.7,-6.5l-0.2,-2c7.8,-4.6 9.7,-9.5 12.8,-19.8l0.1,-0.7c0,0 2.7,-1.1 3.1,-6.1c0.6,-6.8 -2.2,-4.8 -2.2,-5.3C65.1,31 65,26.4 64,23c-2.1,-7.3 -9.2,-13.1 -19,-13.1S28.1,15.6 26,23c-1,3.4 -1.1,8 -0.8,11.6c0,0.5 -2.7,-1.5 -2.2,5.3c0.4,5 3.1,6.1 3.1,6.1l0.1,0.7c3.1,10.3 5,15.2 12.8,19.8l-0.2,2c-5,0.9 -12.5,2.4 -17.7,6.5c-1.7,1.4 -3.3,2.9 -4.7,5C24.2,86.3 34.2,90.1 45,90.1z&quot;
</a><a href="#h12-0-7" id="h12-0-7" class="i">+      android:strokeWidth=&quot;1.5&quot;
</a><a href="#h12-0-8" id="h12-0-8" class="i">+      android:fillColor=&quot;#979797&quot;
</a><a href="#h12-0-9" id="h12-0-9" class="i">+      android:strokeColor=&quot;#000000&quot;/&gt;
</a><a href="#h12-0-10" id="h12-0-10" class="i">+&lt;/vector&gt;
</a><b>diff --git a/<a id="h13" href="../file/app/src/main/res/drawable/settings_icon.xml.html">app/src/main/res/drawable/settings_icon.xml</a> b/<a href="../file/app/src/main/res/drawable/settings_icon.xml.html">app/src/main/res/drawable/settings_icon.xml</a></b>
<a href="#h13-0" id="h13-0" class="h">@@ -0,0 +1,11 @@
</a><a href="#h13-0-0" id="h13-0-0" class="i">+&lt;vector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a><a href="#h13-0-1" id="h13-0-1" class="i">+    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
</a><a href="#h13-0-2" id="h13-0-2" class="i">+    android:width=&quot;30dp&quot;
</a><a href="#h13-0-3" id="h13-0-3" class="i">+    android:height=&quot;30dp&quot;
</a><a href="#h13-0-4" id="h13-0-4" class="i">+    android:viewportWidth=&quot;50&quot;
</a><a href="#h13-0-5" id="h13-0-5" class="i">+    android:viewportHeight=&quot;50&quot;&gt;
</a><a href="#h13-0-6" id="h13-0-6" class="i">+  &lt;path
</a><a href="#h13-0-7" id="h13-0-7" class="i">+      android:fillColor=&quot;#FFFFFF&quot;
</a><a href="#h13-0-8" id="h13-0-8" class="i">+      android:pathData=&quot;M40.843,22.134C41.511,22.249 42,22.829 42,23.507v2.985c0,0.678 -0.489,1.258 -1.157,1.373l-2.777,0.478c-0.321,1.258 -0.816,2.443 -1.462,3.531l1.626,2.301c0.391,0.554 0.327,1.31 -0.153,1.789l-2.111,2.111c-0.538,0.517 -1.277,0.521 -1.789,0.153l-2.301,-1.626c-1.088,0.646 -2.273,1.141 -3.531,1.462l-0.478,2.777C27.751,41.511 27.171,42 26.492,42h-2.985c-0.678,0 -1.258,-0.489 -1.373,-1.157l-0.478,-2.777c-1.258,-0.321 -2.443,-0.816 -3.531,-1.462l-2.301,1.626c-0.534,0.381 -1.283,0.343 -1.789,-0.153l-2.111,-2.111c-0.48,-0.48 -0.544,-1.235 -0.153,-1.789l1.626,-2.301c-0.646,-1.088 -1.141,-2.273 -1.462,-3.531l-2.777,-0.478C8.489,27.751 8,27.171 8,26.492v-2.985c0,-0.678 0.489,-1.258 1.157,-1.373l2.777,-0.478c0.321,-1.258 0.816,-2.443 1.462,-3.531l-1.626,-2.301c-0.391,-0.554 -0.327,-1.31 0.153,-1.789l2.111,-2.111c0.596,-0.579 1.369,-0.456 1.789,-0.153l2.301,1.626c1.088,-0.646 2.273,-1.141 3.531,-1.462l0.478,-2.777C22.249,8.489 22.829,8 23.508,8h2.985c0.678,0 1.258,0.489 1.373,1.157l0.478,2.777c1.258,0.321 2.443,0.816 3.531,1.462l2.301,-1.626c0.617,-0.414 1.351,-0.282 1.789,0.153l2.111,2.111c0.48,0.48 0.544,1.235 0.153,1.789l-1.626,2.301c0.646,1.088 1.141,2.273 1.462,3.531L40.843,22.134zM25,31.955c3.841,0 6.955,-3.114 6.955,-6.955c0,-3.841 -3.114,-6.955 -6.955,-6.955S18.045,21.159 18.045,25C18.045,28.841 21.159,31.955 25,31.955z&quot;
</a><a href="#h13-0-9" id="h13-0-9" class="i">+      tools:ignore=&quot;VectorPath&quot; /&gt;
</a><a href="#h13-0-10" id="h13-0-10" class="i">+&lt;/vector&gt;
</a><b>diff --git a/<a id="h14" href="../file/app/src/main/res/font/avenir_next_bold.ttf.html">app/src/main/res/font/avenir_next_bold.ttf</a> b/<a href="../file/app/src/main/res/font/avenir_next_bold.ttf.html">app/src/main/res/font/avenir_next_bold.ttf</a></b>
Binary files differ.
<b>diff --git a/<a id="h15" href="../file/app/src/main/res/layout/download_manager_activity.xml.html">app/src/main/res/layout/download_manager_activity.xml</a> b/<a href="../file/app/src/main/res/layout/download_manager_activity.xml.html">app/src/main/res/layout/download_manager_activity.xml</a></b>
<a href="#h15-0" id="h15-0" class="h">@@ -1,60 +1,150 @@
</a><a href="#h15-0-0" id="h15-0-0" class="d">-&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</a> &lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
<a href="#h15-0-2" id="h15-0-2" class="d">-    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
</a>     android:id=&quot;@+id/download_manager_activity&quot;
     android:layout_width=&quot;match_parent&quot;
     android:layout_height=&quot;match_parent&quot;
     android:background=&quot;@color/primaryBackground&quot;
     android:orientation=&quot;vertical&quot;&gt;
 
<a href="#h15-0-9" id="h15-0-9" class="i">+    &lt;FrameLayout
</a><a href="#h15-0-10" id="h15-0-10" class="i">+        android:id=&quot;@+id/title_bar&quot;
</a><a href="#h15-0-11" id="h15-0-11" class="i">+        android:layout_width=&quot;match_parent&quot;
</a><a href="#h15-0-12" id="h15-0-12" class="i">+        android:layout_height=&quot;50dp&quot;&gt;
</a><a href="#h15-0-13" id="h15-0-13" class="i">+
</a><a href="#h15-0-14" id="h15-0-14" class="i">+        &lt;View
</a><a href="#h15-0-15" id="h15-0-15" class="i">+            android:layout_width=&quot;match_parent&quot;
</a><a href="#h15-0-16" id="h15-0-16" class="i">+            android:layout_height=&quot;1dp&quot;
</a><a href="#h15-0-17" id="h15-0-17" class="i">+            android:background=&quot;@color/borderColor&quot;
</a><a href="#h15-0-18" id="h15-0-18" class="i">+            android:layout_gravity=&quot;bottom&quot; /&gt;
</a><a href="#h15-0-19" id="h15-0-19" class="i">+
</a><a href="#h15-0-20" id="h15-0-20" class="i">+        &lt;TextView
</a><a href="#h15-0-21" id="h15-0-21" class="i">+            android:id=&quot;@+id/title&quot;
</a><a href="#h15-0-22" id="h15-0-22" class="i">+            android:layout_width=&quot;match_parent&quot;
</a><a href="#h15-0-23" id="h15-0-23" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-24" id="h15-0-24" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-25" id="h15-0-25" class="i">+            android:text=&quot;@string/app_name&quot;
</a><a href="#h15-0-26" id="h15-0-26" class="i">+            android:textColor=&quot;@color/primaryText&quot;
</a><a href="#h15-0-27" id="h15-0-27" class="i">+            android:textSize=&quot;23sp&quot;
</a><a href="#h15-0-28" id="h15-0-28" class="i">+            android:fontFamily=&quot;@font/avenir_next_bold&quot; /&gt;
</a><a href="#h15-0-29" id="h15-0-29" class="i">+
</a><a href="#h15-0-30" id="h15-0-30" class="i">+        &lt;ImageButton
</a><a href="#h15-0-31" id="h15-0-31" class="i">+            android:id=&quot;@+id/settings_button&quot;
</a><a href="#h15-0-32" id="h15-0-32" class="i">+            android:layout_width=&quot;45dp&quot;
</a><a href="#h15-0-33" id="h15-0-33" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-34" id="h15-0-34" class="i">+            android:background=&quot;@null&quot;
</a><a href="#h15-0-35" id="h15-0-35" class="i">+            android:src=&quot;@drawable/settings_icon&quot;
</a><a href="#h15-0-36" id="h15-0-36" class="i">+            android:layout_gravity=&quot;center_vertical|end&quot;
</a><a href="#h15-0-37" id="h15-0-37" class="i">+            android:padding=&quot;8dp&quot;
</a><a href="#h15-0-38" id="h15-0-38" class="i">+            android:contentDescription=&quot;@string/settings&quot; /&gt;
</a><a href="#h15-0-39" id="h15-0-39" class="i">+
</a><a href="#h15-0-40" id="h15-0-40" class="i">+    &lt;/FrameLayout&gt;
</a><a href="#h15-0-41" id="h15-0-41" class="i">+
</a>     &lt;LinearLayout
<a href="#h15-0-43" id="h15-0-43" class="i">+        android:id=&quot;@+id/category_bar&quot;
</a>         android:layout_width=&quot;match_parent&quot;
         android:layout_height=&quot;50dp&quot;
<a href="#h15-0-46" id="h15-0-46" class="d">-        android:background=&quot;@color/secondaryBackground&quot;
</a><a href="#h15-0-47" id="h15-0-47" class="d">-        android:gravity=&quot;center_vertical&quot;
</a><a href="#h15-0-48" id="h15-0-48" class="d">-        android:orientation=&quot;horizontal&quot;
</a><a href="#h15-0-49" id="h15-0-49" class="d">-        android:layoutDirection=&quot;rtl&quot;&gt;
</a><a href="#h15-0-50" id="h15-0-50" class="i">+        android:orientation=&quot;horizontal&quot;&gt;
</a> 
<a href="#h15-0-52" id="h15-0-52" class="d">-        &lt;RelativeLayout
</a><a href="#h15-0-53" id="h15-0-53" class="d">-            android:layout_width=&quot;match_parent&quot;
</a><a href="#h15-0-54" id="h15-0-54" class="d">-            android:layout_height=&quot;wrap_content&quot;
</a><a href="#h15-0-55" id="h15-0-55" class="d">-            android:gravity=&quot;right&quot;
</a><a href="#h15-0-56" id="h15-0-56" class="d">-            android:padding=&quot;10dp&quot;
</a><a href="#h15-0-57" id="h15-0-57" class="d">-            tools:ignore=&quot;RtlHardcoded&quot;&gt;
</a><a href="#h15-0-58" id="h15-0-58" class="d">-            &lt;Button
</a><a href="#h15-0-59" id="h15-0-59" class="d">-                android:id=&quot;@+id/remove_all_button&quot;
</a><a href="#h15-0-60" id="h15-0-60" class="d">-                android:layout_width=&quot;wrap_content&quot;
</a><a href="#h15-0-61" id="h15-0-61" class="d">-                android:layout_height=&quot;35dp&quot;
</a><a href="#h15-0-62" id="h15-0-62" class="d">-                android:background=&quot;@drawable/action_button_cancel&quot;
</a><a href="#h15-0-63" id="h15-0-63" class="d">-                android:padding=&quot;5dp&quot;
</a><a href="#h15-0-64" id="h15-0-64" class="d">-                android:text=&quot;Remove All&quot;
</a><a href="#h15-0-65" id="h15-0-65" class="d">-                android:textColor=&quot;@color/darkText&quot; /&gt;
</a><a href="#h15-0-66" id="h15-0-66" class="d">-        &lt;/RelativeLayout&gt;
</a><a href="#h15-0-67" id="h15-0-67" class="i">+        &lt;TextView
</a><a href="#h15-0-68" id="h15-0-68" class="i">+            android:id=&quot;@+id/all_category&quot;
</a><a href="#h15-0-69" id="h15-0-69" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h15-0-70" id="h15-0-70" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-71" id="h15-0-71" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h15-0-72" id="h15-0-72" class="i">+            android:clickable=&quot;true&quot;
</a><a href="#h15-0-73" id="h15-0-73" class="i">+            android:focusable=&quot;true&quot;
</a><a href="#h15-0-74" id="h15-0-74" class="i">+            android:fontFamily=&quot;@font/avenir_next_medium&quot;
</a><a href="#h15-0-75" id="h15-0-75" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-76" id="h15-0-76" class="i">+            android:text=&quot;@string/all_category&quot;
</a><a href="#h15-0-77" id="h15-0-77" class="i">+            android:textColor=&quot;@color/focusedCategoryColor&quot; /&gt;
</a><a href="#h15-0-78" id="h15-0-78" class="i">+
</a><a href="#h15-0-79" id="h15-0-79" class="i">+        &lt;TextView
</a><a href="#h15-0-80" id="h15-0-80" class="i">+            android:id=&quot;@+id/pending_category&quot;
</a><a href="#h15-0-81" id="h15-0-81" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h15-0-82" id="h15-0-82" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-83" id="h15-0-83" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h15-0-84" id="h15-0-84" class="i">+            android:clickable=&quot;true&quot;
</a><a href="#h15-0-85" id="h15-0-85" class="i">+            android:focusable=&quot;true&quot;
</a><a href="#h15-0-86" id="h15-0-86" class="i">+            android:fontFamily=&quot;@font/avenir_next_medium&quot;
</a><a href="#h15-0-87" id="h15-0-87" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-88" id="h15-0-88" class="i">+            android:text=&quot;@string/pending_category&quot;
</a><a href="#h15-0-89" id="h15-0-89" class="i">+            android:textColor=&quot;@color/primaryText&quot; /&gt;
</a><a href="#h15-0-90" id="h15-0-90" class="i">+
</a><a href="#h15-0-91" id="h15-0-91" class="i">+        &lt;TextView
</a><a href="#h15-0-92" id="h15-0-92" class="i">+            android:id=&quot;@+id/snap_category&quot;
</a><a href="#h15-0-93" id="h15-0-93" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h15-0-94" id="h15-0-94" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-95" id="h15-0-95" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h15-0-96" id="h15-0-96" class="i">+            android:clickable=&quot;true&quot;
</a><a href="#h15-0-97" id="h15-0-97" class="i">+            android:focusable=&quot;true&quot;
</a><a href="#h15-0-98" id="h15-0-98" class="i">+            android:fontFamily=&quot;@font/avenir_next_medium&quot;
</a><a href="#h15-0-99" id="h15-0-99" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-100" id="h15-0-100" class="i">+            android:text=&quot;@string/snap_category&quot;
</a><a href="#h15-0-101" id="h15-0-101" class="i">+            android:textColor=&quot;@color/primaryText&quot; /&gt;
</a><a href="#h15-0-102" id="h15-0-102" class="i">+
</a><a href="#h15-0-103" id="h15-0-103" class="i">+        &lt;TextView
</a><a href="#h15-0-104" id="h15-0-104" class="i">+            android:id=&quot;@+id/story_category&quot;
</a><a href="#h15-0-105" id="h15-0-105" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h15-0-106" id="h15-0-106" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-107" id="h15-0-107" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h15-0-108" id="h15-0-108" class="i">+            android:clickable=&quot;true&quot;
</a><a href="#h15-0-109" id="h15-0-109" class="i">+            android:focusable=&quot;true&quot;
</a><a href="#h15-0-110" id="h15-0-110" class="i">+            android:fontFamily=&quot;@font/avenir_next_medium&quot;
</a><a href="#h15-0-111" id="h15-0-111" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-112" id="h15-0-112" class="i">+            android:text=&quot;@string/story_category&quot;
</a><a href="#h15-0-113" id="h15-0-113" class="i">+            android:textColor=&quot;@color/primaryText&quot; /&gt;
</a><a href="#h15-0-114" id="h15-0-114" class="i">+
</a><a href="#h15-0-115" id="h15-0-115" class="i">+        &lt;TextView
</a><a href="#h15-0-116" id="h15-0-116" class="i">+            android:id=&quot;@+id/spotlight_category&quot;
</a><a href="#h15-0-117" id="h15-0-117" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h15-0-118" id="h15-0-118" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-119" id="h15-0-119" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h15-0-120" id="h15-0-120" class="i">+            android:clickable=&quot;true&quot;
</a><a href="#h15-0-121" id="h15-0-121" class="i">+            android:focusable=&quot;true&quot;
</a><a href="#h15-0-122" id="h15-0-122" class="i">+            android:fontFamily=&quot;@font/avenir_next_medium&quot;
</a><a href="#h15-0-123" id="h15-0-123" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h15-0-124" id="h15-0-124" class="i">+            android:text=&quot;@string/spotlight_category&quot;
</a><a href="#h15-0-125" id="h15-0-125" class="i">+            android:textColor=&quot;@color/primaryText&quot; /&gt;
</a> 
     &lt;/LinearLayout&gt;
 
     &lt;RelativeLayout
<a href="#h15-0-130" id="h15-0-130" class="i">+        android:id=&quot;@+id/download_list_container&quot;
</a>         android:layout_width=&quot;match_parent&quot;
<a href="#h15-0-132" id="h15-0-132" class="d">-        android:layout_height=&quot;match_parent&quot;
</a><a href="#h15-0-133" id="h15-0-133" class="d">-        android:orientation=&quot;vertical&quot;&gt;
</a><a href="#h15-0-134" id="h15-0-134" class="i">+        android:layout_height=&quot;0dp&quot;
</a><a href="#h15-0-135" id="h15-0-135" class="i">+        android:layout_weight=&quot;1&quot;&gt;
</a> 
         &lt;androidx.recyclerview.widget.RecyclerView
             android:id=&quot;@+id/download_list&quot;
             android:layout_width=&quot;match_parent&quot;
<a href="#h15-0-140" id="h15-0-140" class="d">-            android:layout_height=&quot;match_parent&quot;&gt;
</a><a href="#h15-0-141" id="h15-0-141" class="d">-
</a><a href="#h15-0-142" id="h15-0-142" class="d">-        &lt;/androidx.recyclerview.widget.RecyclerView&gt;
</a><a href="#h15-0-143" id="h15-0-143" class="i">+            android:layout_height=&quot;match_parent&quot; /&gt;
</a> 
         &lt;TextView
             android:id=&quot;@+id/no_download_title&quot;
             android:layout_width=&quot;match_parent&quot;
             android:layout_height=&quot;wrap_content&quot;
<a href="#h15-0-149" id="h15-0-149" class="d">-            android:foregroundGravity=&quot;clip_horizontal&quot;
</a><a href="#h15-0-150" id="h15-0-150" class="i">+            android:layout_centerInParent=&quot;true&quot;
</a>             android:gravity=&quot;center&quot;
             android:paddingVertical=&quot;40dp&quot;
<a href="#h15-0-153" id="h15-0-153" class="d">-            android:text=&quot;No downloads&quot;
</a><a href="#h15-0-154" id="h15-0-154" class="i">+            android:text=&quot;@string/no_downloads&quot;
</a>             android:textColor=&quot;@color/primaryText&quot; /&gt;
<a href="#h15-0-156" id="h15-0-156" class="d">-
</a>     &lt;/RelativeLayout&gt;
 
<a href="#h15-0-159" id="h15-0-159" class="d">-&lt;/LinearLayout&gt;</a><a href="#h15-0-160" id="h15-0-160" class="d">-
\ No newline at end of file
</a><a href="#h15-0-161" id="h15-0-161" class="i">+    &lt;FrameLayout
</a><a href="#h15-0-162" id="h15-0-162" class="i">+        android:id=&quot;@+id/floating_button_container&quot;
</a><a href="#h15-0-163" id="h15-0-163" class="i">+        android:layout_width=&quot;match_parent&quot;
</a><a href="#h15-0-164" id="h15-0-164" class="i">+        android:layout_height=&quot;wrap_content&quot;
</a><a href="#h15-0-165" id="h15-0-165" class="i">+        android:background=&quot;@android:color/transparent&quot;
</a><a href="#h15-0-166" id="h15-0-166" class="i">+        android:padding=&quot;16dp&quot;&gt;
</a><a href="#h15-0-167" id="h15-0-167" class="i">+
</a><a href="#h15-0-168" id="h15-0-168" class="i">+        &lt;Button
</a><a href="#h15-0-169" id="h15-0-169" class="i">+            android:id=&quot;@+id/remove_all_button&quot;
</a><a href="#h15-0-170" id="h15-0-170" class="i">+            android:layout_width=&quot;120dp&quot;
</a><a href="#h15-0-171" id="h15-0-171" class="i">+            android:layout_height=&quot;45dp&quot;
</a><a href="#h15-0-172" id="h15-0-172" class="i">+            android:background=&quot;@drawable/action_button_cancel&quot;
</a><a href="#h15-0-173" id="h15-0-173" class="i">+            android:padding=&quot;5dp&quot;
</a><a href="#h15-0-174" id="h15-0-174" class="i">+            android:text=&quot;@string/remove_all&quot;
</a><a href="#h15-0-175" id="h15-0-175" class="i">+            android:textColor=&quot;@color/darkText&quot;
</a><a href="#h15-0-176" id="h15-0-176" class="i">+            android:layout_gravity=&quot;center_horizontal|bottom&quot;
</a><a href="#h15-0-177" id="h15-0-177" class="i">+            android:layout_marginBottom=&quot;5dp&quot;/&gt;
</a><a href="#h15-0-178" id="h15-0-178" class="i">+    &lt;/FrameLayout&gt;
</a><a href="#h15-0-179" id="h15-0-179" class="i">+
</a><a href="#h15-0-180" id="h15-0-180" class="i">+&lt;/LinearLayout&gt;
</a><b>diff --git a/<a id="h16" href="../file/app/src/main/res/layout/download_manager_item.xml.html">app/src/main/res/layout/download_manager_item.xml</a> b/<a href="../file/app/src/main/res/layout/download_manager_item.xml.html">app/src/main/res/layout/download_manager_item.xml</a></b>
<a href="#h16-0" id="h16-0" class="h">@@ -1,37 +1,44 @@
</a> &lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
<a href="#h16-0-1" id="h16-0-1" class="d">-&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a><a href="#h16-0-2" id="h16-0-2" class="i">+&lt;LinearLayout
</a><a href="#h16-0-3" id="h16-0-3" class="i">+    xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a>     xmlns:tools=&quot;http://schemas.android.com/tools&quot;
     android:layout_width=&quot;match_parent&quot;
     android:layout_height=&quot;100dp&quot;
     android:layout_margin=&quot;5dp&quot;
<a href="#h16-0-8" id="h16-0-8" class="d">-    android:layout_marginBottom=&quot;10dp&quot;
</a><a href="#h16-0-9" id="h16-0-9" class="i">+    android:layout_marginBottom=&quot;15dp&quot;
</a>     android:background=&quot;@drawable/download_manager_item_background&quot;
     android:gravity=&quot;center_vertical&quot;
     android:orientation=&quot;horizontal&quot;
<a href="#h16-0-13" id="h16-0-13" class="d">-    android:padding=&quot;5dp&quot;&gt;
</a><a href="#h16-0-14" id="h16-0-14" class="i">+    android:padding=&quot;10dp&quot;&gt;
</a> 
     &lt;RelativeLayout
         android:layout_width=&quot;0dp&quot;
         android:layout_height=&quot;wrap_content&quot;
         android:layout_weight=&quot;1&quot;&gt;
<a href="#h16-0-20" id="h16-0-20" class="i">+
</a>         &lt;LinearLayout
             android:layout_width=&quot;wrap_content&quot;
             android:layout_height=&quot;wrap_content&quot;
             android:background=&quot;@drawable/download_manager_item_background&quot;
             android:orientation=&quot;horizontal&quot;
<a href="#h16-0-26" id="h16-0-26" class="d">-            android:padding=&quot;5dp&quot;
</a><a href="#h16-0-27" id="h16-0-27" class="i">+            android:padding=&quot;10dp&quot;
</a>             tools:ignore=&quot;UselessParent&quot;&gt;
<a href="#h16-0-29" id="h16-0-29" class="i">+
</a>             &lt;ImageView
                 android:id=&quot;@+id/bitmoji_icon&quot;
<a href="#h16-0-32" id="h16-0-32" class="d">-                android:layout_width=&quot;45dp&quot;
</a><a href="#h16-0-33" id="h16-0-33" class="d">-                android:layout_height=&quot;45dp&quot;
</a><a href="#h16-0-34" id="h16-0-34" class="d">-                android:layout_margin=&quot;5dp&quot;
</a><a href="#h16-0-35" id="h16-0-35" class="i">+                android:layout_width=&quot;50dp&quot;
</a><a href="#h16-0-36" id="h16-0-36" class="i">+                android:layout_height=&quot;50dp&quot;
</a><a href="#h16-0-37" id="h16-0-37" class="i">+                android:layout_gravity=&quot;center_vertical&quot;
</a><a href="#h16-0-38" id="h16-0-38" class="i">+                android:layout_marginEnd=&quot;10dp&quot;
</a>                 tools:ignore=&quot;ContentDescription&quot; /&gt;
<a href="#h16-0-40" id="h16-0-40" class="i">+
</a>             &lt;LinearLayout
                 android:layout_width=&quot;wrap_content&quot;
<a href="#h16-0-43" id="h16-0-43" class="d">-                android:layout_height=&quot;match_parent&quot;
</a><a href="#h16-0-44" id="h16-0-44" class="d">-                android:padding=&quot;5dp&quot;
</a><a href="#h16-0-45" id="h16-0-45" class="i">+                android:layout_height=&quot;wrap_content&quot;
</a><a href="#h16-0-46" id="h16-0-46" class="i">+                android:layout_gravity=&quot;center_vertical&quot;
</a><a href="#h16-0-47" id="h16-0-47" class="i">+                android:layout_marginEnd=&quot;15dp&quot;
</a>                 android:orientation=&quot;vertical&quot;&gt;
<a href="#h16-0-49" id="h16-0-49" class="i">+
</a>                 &lt;TextView
                     android:id=&quot;@+id/item_title&quot;
                     android:layout_width=&quot;wrap_content&quot;
<a href="#h16-1" id="h16-1" class="h">@@ -44,13 +51,12 @@
</a>                     android:id=&quot;@+id/item_subtitle&quot;
                     android:layout_width=&quot;wrap_content&quot;
                     android:layout_height=&quot;wrap_content&quot;
<a href="#h16-1-3" id="h16-1-3" class="d">-                    android:textSize=&quot;14sp&quot;
</a><a href="#h16-1-4" id="h16-1-4" class="d">-                    android:textColor=&quot;@color/secondaryText&quot; /&gt;
</a><a href="#h16-1-5" id="h16-1-5" class="i">+                    android:textColor=&quot;@color/secondaryText&quot;
</a><a href="#h16-1-6" id="h16-1-6" class="i">+                    android:textSize=&quot;14sp&quot; /&gt;
</a>             &lt;/LinearLayout&gt;
         &lt;/LinearLayout&gt;
     &lt;/RelativeLayout&gt;
 
<a href="#h16-1-11" id="h16-1-11" class="d">-
</a>     &lt;TextView
         android:id=&quot;@+id/item_status&quot;
         android:layout_width=&quot;wrap_content&quot;
<a href="#h16-2" id="h16-2" class="h">@@ -60,11 +66,12 @@
</a> 
     &lt;Button
         android:id=&quot;@+id/item_action_button&quot;
<a href="#h16-2-3" id="h16-2-3" class="d">-        android:layout_width=&quot;wrap_content&quot;
</a><a href="#h16-2-4" id="h16-2-4" class="d">-        android:layout_height=&quot;35dp&quot;
</a><a href="#h16-2-5" id="h16-2-5" class="i">+        android:layout_width=&quot;90dp&quot;
</a><a href="#h16-2-6" id="h16-2-6" class="i">+        android:layout_height=&quot;39dp&quot;
</a>         android:background=&quot;@drawable/action_button_cancel&quot;
         android:padding=&quot;5dp&quot;
<a href="#h16-2-9" id="h16-2-9" class="d">-        android:text=&quot;Cancel&quot;
</a><a href="#h16-2-10" id="h16-2-10" class="i">+        android:layout_marginEnd=&quot;10dp&quot;
</a><a href="#h16-2-11" id="h16-2-11" class="i">+        android:text=&quot;@string/cancel&quot;
</a>         android:textColor=&quot;@color/darkText&quot;
<a href="#h16-2-13" id="h16-2-13" class="d">-        tools:ignore=&quot;ButtonOrder,HardcodedText&quot; /&gt;
</a><a href="#h16-2-14" id="h16-2-14" class="d">-&lt;/LinearLayout&gt;</a><a href="#h16-2-15" id="h16-2-15" class="d">-
\ No newline at end of file
</a><a href="#h16-2-16" id="h16-2-16" class="i">+        tools:ignore=&quot;ButtonOrder&quot; /&gt;
</a><a href="#h16-2-17" id="h16-2-17" class="i">+&lt;/LinearLayout&gt;
</a><b>diff --git a/<a id="h17" href="../file/app/src/main/res/layout/setting_item.xml.html">app/src/main/res/layout/setting_item.xml</a> b/<a href="../file/app/src/main/res/layout/setting_item.xml.html">app/src/main/res/layout/setting_item.xml</a></b>
<a href="#h17-0" id="h17-0" class="h">@@ -0,0 +1,19 @@
</a><a href="#h17-0-0" id="h17-0-0" class="i">+&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
</a><a href="#h17-0-1" id="h17-0-1" class="i">+&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a><a href="#h17-0-2" id="h17-0-2" class="i">+        android:id=&quot;@+id/preference_item&quot;
</a><a href="#h17-0-3" id="h17-0-3" class="i">+        android:layout_width=&quot;match_parent&quot;
</a><a href="#h17-0-4" id="h17-0-4" class="i">+        android:layout_height=&quot;60dp&quot;
</a><a href="#h17-0-5" id="h17-0-5" class="i">+        android:orientation=&quot;horizontal&quot;
</a><a href="#h17-0-6" id="h17-0-6" class="i">+        android:padding=&quot;16dp&quot;&gt;
</a><a href="#h17-0-7" id="h17-0-7" class="i">+
</a><a href="#h17-0-8" id="h17-0-8" class="i">+        &lt;TextView
</a><a href="#h17-0-9" id="h17-0-9" class="i">+            android:id=&quot;@+id/feature_text&quot;
</a><a href="#h17-0-10" id="h17-0-10" class="i">+            android:layout_width=&quot;0dp&quot;
</a><a href="#h17-0-11" id="h17-0-11" class="i">+            android:layout_height=&quot;wrap_content&quot;
</a><a href="#h17-0-12" id="h17-0-12" class="i">+            android:layout_gravity=&quot;center_vertical&quot;
</a><a href="#h17-0-13" id="h17-0-13" class="i">+            android:layout_weight=&quot;1&quot;
</a><a href="#h17-0-14" id="h17-0-14" class="i">+            android:text=&quot;&quot;
</a><a href="#h17-0-15" id="h17-0-15" class="i">+            android:textColor=&quot;@color/primaryText&quot;
</a><a href="#h17-0-16" id="h17-0-16" class="i">+            android:textSize=&quot;16sp&quot; /&gt;
</a><a href="#h17-0-17" id="h17-0-17" class="i">+
</a><a href="#h17-0-18" id="h17-0-18" class="i">+&lt;/LinearLayout&gt;</a><a href="#h17-0-19" id="h17-0-19" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h18" href="../file/app/src/main/res/layout/settings_page.xml.html">app/src/main/res/layout/settings_page.xml</a> b/<a href="../file/app/src/main/res/layout/settings_page.xml.html">app/src/main/res/layout/settings_page.xml</a></b>
<a href="#h18-0" id="h18-0" class="h">@@ -0,0 +1,52 @@
</a><a href="#h18-0-0" id="h18-0-0" class="i">+&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
</a><a href="#h18-0-1" id="h18-0-1" class="i">+    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
</a><a href="#h18-0-2" id="h18-0-2" class="i">+    android:id=&quot;@+id/setting_page&quot;
</a><a href="#h18-0-3" id="h18-0-3" class="i">+    android:clickable=&quot;true&quot;
</a><a href="#h18-0-4" id="h18-0-4" class="i">+    android:layout_width=&quot;match_parent&quot;
</a><a href="#h18-0-5" id="h18-0-5" class="i">+    android:layout_height=&quot;match_parent&quot;
</a><a href="#h18-0-6" id="h18-0-6" class="i">+    android:background=&quot;@color/primaryBackground&quot;
</a><a href="#h18-0-7" id="h18-0-7" class="i">+    android:orientation=&quot;vertical&quot;&gt;
</a><a href="#h18-0-8" id="h18-0-8" class="i">+
</a><a href="#h18-0-9" id="h18-0-9" class="i">+    &lt;FrameLayout
</a><a href="#h18-0-10" id="h18-0-10" class="i">+        android:id=&quot;@+id/title_bar&quot;
</a><a href="#h18-0-11" id="h18-0-11" class="i">+        android:layout_width=&quot;match_parent&quot;
</a><a href="#h18-0-12" id="h18-0-12" class="i">+        android:layout_height=&quot;50dp&quot;
</a><a href="#h18-0-13" id="h18-0-13" class="i">+        tools:ignore=&quot;UselessParent&quot;&gt;
</a><a href="#h18-0-14" id="h18-0-14" class="i">+
</a><a href="#h18-0-15" id="h18-0-15" class="i">+        &lt;ImageButton
</a><a href="#h18-0-16" id="h18-0-16" class="i">+            android:id=&quot;@+id/settings_button&quot;
</a><a href="#h18-0-17" id="h18-0-17" class="i">+            android:layout_width=&quot;45dp&quot;
</a><a href="#h18-0-18" id="h18-0-18" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h18-0-19" id="h18-0-19" class="i">+            android:background=&quot;@null&quot;
</a><a href="#h18-0-20" id="h18-0-20" class="i">+            android:src=&quot;@drawable/back_arrow&quot;
</a><a href="#h18-0-21" id="h18-0-21" class="i">+            android:layout_gravity=&quot;center_vertical|start&quot;
</a><a href="#h18-0-22" id="h18-0-22" class="i">+            android:padding=&quot;8dp&quot;
</a><a href="#h18-0-23" id="h18-0-23" class="i">+            tools:ignore=&quot;ContentDescription&quot; /&gt;
</a><a href="#h18-0-24" id="h18-0-24" class="i">+
</a><a href="#h18-0-25" id="h18-0-25" class="i">+        &lt;View
</a><a href="#h18-0-26" id="h18-0-26" class="i">+            android:layout_width=&quot;match_parent&quot;
</a><a href="#h18-0-27" id="h18-0-27" class="i">+            android:layout_height=&quot;1dp&quot;
</a><a href="#h18-0-28" id="h18-0-28" class="i">+            android:background=&quot;@color/borderColor&quot;
</a><a href="#h18-0-29" id="h18-0-29" class="i">+            android:layout_gravity=&quot;bottom&quot; /&gt;
</a><a href="#h18-0-30" id="h18-0-30" class="i">+
</a><a href="#h18-0-31" id="h18-0-31" class="i">+        &lt;TextView
</a><a href="#h18-0-32" id="h18-0-32" class="i">+            android:id=&quot;@+id/title&quot;
</a><a href="#h18-0-33" id="h18-0-33" class="i">+            android:layout_width=&quot;match_parent&quot;
</a><a href="#h18-0-34" id="h18-0-34" class="i">+            android:layout_height=&quot;match_parent&quot;
</a><a href="#h18-0-35" id="h18-0-35" class="i">+            android:gravity=&quot;center&quot;
</a><a href="#h18-0-36" id="h18-0-36" class="i">+            android:text=&quot;@string/settings&quot;
</a><a href="#h18-0-37" id="h18-0-37" class="i">+            android:textColor=&quot;@color/primaryText&quot;
</a><a href="#h18-0-38" id="h18-0-38" class="i">+            android:textSize=&quot;23sp&quot;
</a><a href="#h18-0-39" id="h18-0-39" class="i">+            android:fontFamily=&quot;@font/avenir_next_bold&quot; /&gt;
</a><a href="#h18-0-40" id="h18-0-40" class="i">+
</a><a href="#h18-0-41" id="h18-0-41" class="i">+    &lt;/FrameLayout&gt;
</a><a href="#h18-0-42" id="h18-0-42" class="i">+
</a><a href="#h18-0-43" id="h18-0-43" class="i">+    &lt;ListView
</a><a href="#h18-0-44" id="h18-0-44" class="i">+        android:id=&quot;@+id/setting_page_list&quot;
</a><a href="#h18-0-45" id="h18-0-45" class="i">+        android:layout_width=&quot;match_parent&quot;
</a><a href="#h18-0-46" id="h18-0-46" class="i">+        android:layout_height=&quot;match_parent&quot;
</a><a href="#h18-0-47" id="h18-0-47" class="i">+        android:listSelector=&quot;@android:color/transparent&quot;
</a><a href="#h18-0-48" id="h18-0-48" class="i">+        android:orientation=&quot;vertical&quot;&gt;
</a><a href="#h18-0-49" id="h18-0-49" class="i">+    &lt;/ListView&gt;
</a><a href="#h18-0-50" id="h18-0-50" class="i">+
</a><a href="#h18-0-51" id="h18-0-51" class="i">+&lt;/LinearLayout&gt;
</a><b>diff --git a/<a id="h19" href="../file/app/src/main/res/values/colors.xml.html">app/src/main/res/values/colors.xml</a> b/<a href="../file/app/src/main/res/values/colors.xml.html">app/src/main/res/values/colors.xml</a></b>
<a href="#h19-0" id="h19-0" class="h">@@ -9,4 +9,6 @@
</a>     &lt;color name=&quot;secondaryText&quot;&gt;#999999&lt;/color&gt;
     &lt;color name=&quot;errorColor&quot;&gt;#DF4C5C&lt;/color&gt;
     &lt;color name=&quot;successColor&quot;&gt;#4FABF8&lt;/color&gt;
<a href="#h19-0-3" id="h19-0-3" class="i">+    &lt;color name=&quot;borderColor&quot;&gt;#424242&lt;/color&gt;
</a><a href="#h19-0-4" id="h19-0-4" class="i">+    &lt;color name=&quot;focusedCategoryColor&quot;&gt;#4FABF8&lt;/color&gt;
</a> &lt;/resources&gt; 
\ No newline at end of file
<b>diff --git a/<a id="h20" href="../file/app/src/main/res/values/strings.xml.html">app/src/main/res/values/strings.xml</a> b/<a href="../file/app/src/main/res/values/strings.xml.html">app/src/main/res/values/strings.xml</a></b>
<a href="#h20-0" id="h20-0" class="h">@@ -1,3 +1,15 @@
</a> &lt;resources&gt;
<a href="#h20-0-1" id="h20-0-1" class="d">-    &lt;string name=&quot;app_name&quot; translatable=&quot;false&quot;&gt;Snap Enhance&lt;/string&gt;
</a><a href="#h20-0-2" id="h20-0-2" class="i">+    &lt;string name=&quot;app_name&quot; translatable=&quot;false&quot;&gt;SnapEnhance&lt;/string&gt;
</a><a href="#h20-0-3" id="h20-0-3" class="i">+    &lt;string name=&quot;remove_all_title&quot;&gt;Remove all Downloads&lt;/string&gt;
</a><a href="#h20-0-4" id="h20-0-4" class="i">+    &lt;string name=&quot;remove_all_text&quot;&gt;Are you sure you want to do this?&lt;/string&gt;
</a><a href="#h20-0-5" id="h20-0-5" class="i">+    &lt;string name=&quot;remove_all&quot;&gt;Remove All&lt;/string&gt;
</a><a href="#h20-0-6" id="h20-0-6" class="i">+    &lt;string name=&quot;no_downloads&quot;&gt;No downloads&lt;/string&gt;
</a><a href="#h20-0-7" id="h20-0-7" class="i">+    &lt;string name=&quot;cancel&quot;&gt;Cancel&lt;/string&gt;
</a><a href="#h20-0-8" id="h20-0-8" class="i">+    &lt;string name=&quot;all_category&quot;&gt;All&lt;/string&gt;
</a><a href="#h20-0-9" id="h20-0-9" class="i">+    &lt;string name=&quot;pending_category&quot;&gt;Pending&lt;/string&gt;
</a><a href="#h20-0-10" id="h20-0-10" class="i">+    &lt;string name=&quot;snap_category&quot;&gt;Snaps&lt;/string&gt;
</a><a href="#h20-0-11" id="h20-0-11" class="i">+    &lt;string name=&quot;story_category&quot;&gt;Stories&lt;/string&gt;
</a><a href="#h20-0-12" id="h20-0-12" class="i">+    &lt;string name=&quot;spotlight_category&quot;&gt;Spotlight&lt;/string&gt;
</a><a href="#h20-0-13" id="h20-0-13" class="i">+    &lt;string name=&quot;settings&quot;&gt;Settings&lt;/string&gt;
</a><a href="#h20-0-14" id="h20-0-14" class="i">+    &lt;string name=&quot;refresh_mappings&quot;&gt;Refresh Mappings&lt;/string&gt;
</a> &lt;/resources&gt; 
\ No newline at end of file
<b>diff --git a/<a id="h21" href="../file/app/src/main/res/values/themes.xml.html">app/src/main/res/values/themes.xml</a> b/<a href="../file/app/src/main/res/values/themes.xml.html">app/src/main/res/values/themes.xml</a></b>
<a href="#h21-0" id="h21-0" class="h">@@ -2,5 +2,7 @@
</a> &lt;resources&gt;
     &lt;style name=&quot;AppTheme&quot;&gt;
         &lt;item name=&quot;android:fontFamily&quot;&gt;@font/avenir_next_medium&lt;/item&gt;
<a href="#h21-0-3" id="h21-0-3" class="i">+        &lt;item name=&quot;android:windowNoTitle&quot;&gt;true&lt;/item&gt;
</a><a href="#h21-0-4" id="h21-0-4" class="i">+        &lt;item name=&quot;android:windowContentOverlay&quot;&gt;@null&lt;/item&gt;
</a>     &lt;/style&gt;
 &lt;/resources&gt; 
\ No newline at end of file
</pre>
</div>
</body>
</html>
