<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>refactor: compose icon deprecation - refactor script interface - SnapEnhance - An Xposed module offering an enhanced Snapchat experience
</title>
<link rel="icon" type="image/svg+xml" href="../../logo.png"/>
<link rel="alternate icon" href="../../favicon.png"/>
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed" href="../atom.xml" />
<link rel="alternate" type="application/atom+xml" title="SnapEnhance Atom Feed (tags)" href="../tags.xml" />
<link rel="stylesheet" type="text/css" href="../../style.css" />
<link rel="stylesheet" type="text/css" href="../../fonts.css" />
</head>
<body>
<div id="head"><table><tr><td><a class="logo" href="../../"><img src="../../logo.png" alt="" width="32" height="32" /></a></td><td><strong>SnapEnhance</strong><span class="desc"> - An Xposed module offering an enhanced Snapchat experience
</span>
</td></tr></table>
<p><a href="../about.html">About</a> | <a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/.gitmodules.html">Submodules</a> | <a href="../file/LICENSE.html">License</a></p>
</div>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/bc67308df831fe3007131107ba7a4cc38f592bac.html">bc67308df831fe3007131107ba7a4cc38f592bac</a>
<b>parent</b> <a href="../commit/f3cc14f405436e9e3662266d9f773caa230e196d.html">f3cc14f405436e9e3662266d9f773caa230e196d</a>
<b>Author:</b> rhunk &lt;<a href="mailto:101876869+rhunk@users.noreply.github.com">101876869+rhunk@users.noreply.github.com</a>&gt;
<b>Date:</b>   Sat,  7 Oct 2023 11:30:56 +0200

refactor: compose icon deprecation
- refactor script interface

<b>Diffstat:</b>
<table><tr><td class="M">M</td><td><a href="#h0">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h1">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h2">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h3">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/HomeSection.kt</a></td><td> | </td><td class="num">3</td><td><span class="i">++</span><span class="d">-</span></td></tr>
<tr><td class="M">M</td><td><a href="#h4">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/SettingsSection.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="A">A</td><td><a href="#h5">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptInterface.kt</a></td><td> | </td><td class="num">155</td><td><span class="i">+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
<tr><td class="M">M</td><td><a href="#h6">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a></td><td> | </td><td class="num">130</td><td><span class="i">++</span><span class="d">-----------------------------------------------------------------------------</span></td></tr>
<tr><td class="M">M</td><td><a href="#h7">app/src/main/kotlin/me/rhunk/snapenhance/ui/setup/SetupActivity.kt</a></td><td> | </td><td class="num">4</td><td><span class="i">++</span><span class="d">--</span></td></tr>
<tr><td class="M">M</td><td><a href="#h8">core/src/main/kotlin/me/rhunk/snapenhance/ui/menu/impl/SettingsMenu.kt</a></td><td> | </td><td class="num">1</td><td><span class="i">+</span><span class="d"></span></td></tr>
</table></pre><pre>9 files changed, 171 insertions(+), 138 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/Navigation.kt</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -6,7 +6,7 @@ import androidx.compose.animation.fadeIn
</a> import androidx.compose.animation.fadeOut
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
<a href="#h0-0-3" id="h0-0-3" class="d">-import androidx.compose.material.icons.filled.ArrowBack
</a><a href="#h0-0-4" id="h0-0-4" class="i">+import androidx.compose.material.icons.automirrored.filled.ArrowBack
</a> import androidx.compose.material3.*
 import androidx.compose.runtime.Composable
 import androidx.compose.runtime.getValue
<a href="#h0-1" id="h0-1" class="h">@@ -80,7 +80,7 @@ class Navigation(
</a>                 IconButton(
                     onClick = { navHostController.popBackStack() }
                 ) {
<a href="#h0-1-3" id="h0-1-3" class="d">-                    Icon(Icons.Filled.ArrowBack, contentDescription = null)
</a><a href="#h0-1-4" id="h0-1-4" class="i">+                    Icon(Icons.AutoMirrored.Filled.ArrowBack, contentDescription = null)
</a>                 }
             }
         }, actions = {
<b>diff --git a/<a id="h1" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/downloads/DownloadsSection.kt</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -8,9 +8,9 @@ import androidx.compose.foundation.layout.*
</a> import androidx.compose.foundation.lazy.LazyColumn
 import androidx.compose.foundation.lazy.rememberLazyListState
 import androidx.compose.material.icons.Icons
<a href="#h1-0-3" id="h1-0-3" class="i">+import androidx.compose.material.icons.automirrored.filled.OpenInNew
</a> import androidx.compose.material.icons.filled.Delete
 import androidx.compose.material.icons.filled.FilterList
<a href="#h1-0-6" id="h1-0-6" class="d">-import androidx.compose.material.icons.filled.OpenInNew
</a> import androidx.compose.material3.*
 import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
<a href="#h1-1" id="h1-1" class="h">@@ -218,7 +218,7 @@ class DownloadsSection : Section() {
</a>                             context.androidContext.startActivity(intent)
                         }) {
                             Icon(
<a href="#h1-1-3" id="h1-1-3" class="d">-                                imageVector = Icons.Default.OpenInNew,
</a><a href="#h1-1-4" id="h1-1-4" class="i">+                                imageVector = Icons.AutoMirrored.Filled.OpenInNew,
</a>                                 contentDescription = null
                             )
                         }
<b>diff --git a/<a id="h2" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/features/FeaturesSection.kt</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -12,10 +12,10 @@ import androidx.compose.foundation.lazy.items
</a> import androidx.compose.foundation.shape.RoundedCornerShape
 import androidx.compose.foundation.text.KeyboardActions
 import androidx.compose.material.icons.Icons
<a href="#h2-0-3" id="h2-0-3" class="i">+import androidx.compose.material.icons.automirrored.filled.OpenInNew
</a> import androidx.compose.material.icons.filled.Close
 import androidx.compose.material.icons.filled.FolderOpen
 import androidx.compose.material.icons.filled.MoreVert
<a href="#h2-0-7" id="h2-0-7" class="d">-import androidx.compose.material.icons.filled.OpenInNew
</a> import androidx.compose.material.icons.filled.Search
 import androidx.compose.material.icons.rounded.Save
 import androidx.compose.material3.*
<a href="#h2-1" id="h2-1" class="h">@@ -224,7 +224,7 @@ class FeaturesSection : Section() {
</a>                         }
                     } else {
                         IconButton(onClick = it) {
<a href="#h2-1-3" id="h2-1-3" class="d">-                            Icon(Icons.Filled.OpenInNew, contentDescription = null)
</a><a href="#h2-1-4" id="h2-1-4" class="i">+                            Icon(Icons.AutoMirrored.Filled.OpenInNew, contentDescription = null)
</a>                         }
                     }
                 }
<b>diff --git a/<a id="h3" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/HomeSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/HomeSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/HomeSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/HomeSection.kt</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -7,6 +7,7 @@ import androidx.compose.foundation.ScrollState
</a> import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.verticalScroll
 import androidx.compose.material.icons.Icons
<a href="#h3-0-3" id="h3-0-3" class="i">+import androidx.compose.material.icons.automirrored.filled.OpenInNew
</a> import androidx.compose.material.icons.filled.*
 import androidx.compose.material3.*
 import androidx.compose.runtime.Composable
<a href="#h3-1" id="h3-1" class="h">@@ -155,7 +156,7 @@ class HomeSection : Section() {
</a>                 Button(onClick = {
                     context.checkForRequirements(Requirements.LANGUAGE)
                 }, modifier = Modifier.height(40.dp)) {
<a href="#h3-1-3" id="h3-1-3" class="d">-                    Icon(Icons.Filled.OpenInNew, contentDescription = null)
</a><a href="#h3-1-4" id="h3-1-4" class="i">+                    Icon(Icons.AutoMirrored.Filled.OpenInNew, contentDescription = null)
</a>                 }
             }
         }
<b>diff --git a/<a id="h4" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/SettingsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/SettingsSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/SettingsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/home/SettingsSection.kt</a></b>
<a href="#h4-0" id="h4-0" class="h">@@ -5,7 +5,7 @@ import androidx.compose.foundation.clickable
</a> import androidx.compose.foundation.layout.*
 import androidx.compose.foundation.verticalScroll
 import androidx.compose.material.icons.Icons
<a href="#h4-0-3" id="h4-0-3" class="d">-import androidx.compose.material.icons.filled.OpenInNew
</a><a href="#h4-0-4" id="h4-0-4" class="i">+import androidx.compose.material.icons.automirrored.filled.OpenInNew
</a> import androidx.compose.material3.Icon
 import androidx.compose.material3.IconButton
 import androidx.compose.material3.Text
<a href="#h4-1" id="h4-1" class="h">@@ -73,7 +73,7 @@ class SettingsSection : Section() {
</a>             Text(text = title, modifier = Modifier.padding(start = 26.dp))
             IconButton(onClick = { takeAction() }) {
                 Icon(
<a href="#h4-1-3" id="h4-1-3" class="d">-                    imageVector = Icons.Filled.OpenInNew,
</a><a href="#h4-1-4" id="h4-1-4" class="i">+                    imageVector = Icons.AutoMirrored.Filled.OpenInNew,
</a>                     contentDescription = null,
                     modifier = Modifier.size(24.dp)
                 )
<b>diff --git a/<a id="h5" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptInterface.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptInterface.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptInterface.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptInterface.kt</a></b>
<a href="#h5-0" id="h5-0" class="h">@@ -0,0 +1,154 @@
</a><a href="#h5-0-0" id="h5-0-0" class="i">+package me.rhunk.snapenhance.ui.manager.sections.scripting
</a><a href="#h5-0-1" id="h5-0-1" class="i">+
</a><a href="#h5-0-2" id="h5-0-2" class="i">+import androidx.compose.foundation.layout.*
</a><a href="#h5-0-3" id="h5-0-3" class="i">+import androidx.compose.material3.OutlinedButton
</a><a href="#h5-0-4" id="h5-0-4" class="i">+import androidx.compose.material3.Slider
</a><a href="#h5-0-5" id="h5-0-5" class="i">+import androidx.compose.material3.Switch
</a><a href="#h5-0-6" id="h5-0-6" class="i">+import androidx.compose.material3.Text
</a><a href="#h5-0-7" id="h5-0-7" class="i">+import androidx.compose.runtime.*
</a><a href="#h5-0-8" id="h5-0-8" class="i">+import androidx.compose.ui.Alignment
</a><a href="#h5-0-9" id="h5-0-9" class="i">+import androidx.compose.ui.Modifier
</a><a href="#h5-0-10" id="h5-0-10" class="i">+import androidx.compose.ui.graphics.Color
</a><a href="#h5-0-11" id="h5-0-11" class="i">+import androidx.compose.ui.unit.dp
</a><a href="#h5-0-12" id="h5-0-12" class="i">+import androidx.compose.ui.unit.sp
</a><a href="#h5-0-13" id="h5-0-13" class="i">+import kotlinx.coroutines.launch
</a><a href="#h5-0-14" id="h5-0-14" class="i">+import me.rhunk.snapenhance.core.Logger
</a><a href="#h5-0-15" id="h5-0-15" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.InterfaceBuilder
</a><a href="#h5-0-16" id="h5-0-16" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.Node
</a><a href="#h5-0-17" id="h5-0-17" class="i">+import me.rhunk.snapenhance.scripting.impl.ui.components.NodeType
</a><a href="#h5-0-18" id="h5-0-18" class="i">+import kotlin.math.abs
</a><a href="#h5-0-19" id="h5-0-19" class="i">+
</a><a href="#h5-0-20" id="h5-0-20" class="i">+
</a><a href="#h5-0-21" id="h5-0-21" class="i">+@Composable
</a><a href="#h5-0-22" id="h5-0-22" class="i">+@Suppress(&quot;UNCHECKED_CAST&quot;)
</a><a href="#h5-0-23" id="h5-0-23" class="i">+private fun DrawNode(node: Node) {
</a><a href="#h5-0-24" id="h5-0-24" class="i">+    val coroutineScope = rememberCoroutineScope()
</a><a href="#h5-0-25" id="h5-0-25" class="i">+    val cachedAttributes = remember { mutableStateMapOf(*node.attributes.toList().toTypedArray()) }
</a><a href="#h5-0-26" id="h5-0-26" class="i">+
</a><a href="#h5-0-27" id="h5-0-27" class="i">+    node.uiChangeDetection = { key, value -&gt;
</a><a href="#h5-0-28" id="h5-0-28" class="i">+        coroutineScope.launch {
</a><a href="#h5-0-29" id="h5-0-29" class="i">+            cachedAttributes[key] = value
</a><a href="#h5-0-30" id="h5-0-30" class="i">+        }
</a><a href="#h5-0-31" id="h5-0-31" class="i">+    }
</a><a href="#h5-0-32" id="h5-0-32" class="i">+
</a><a href="#h5-0-33" id="h5-0-33" class="i">+    DisposableEffect(Unit) {
</a><a href="#h5-0-34" id="h5-0-34" class="i">+        onDispose {
</a><a href="#h5-0-35" id="h5-0-35" class="i">+            node.uiChangeDetection = { _, _ -&gt; }
</a><a href="#h5-0-36" id="h5-0-36" class="i">+        }
</a><a href="#h5-0-37" id="h5-0-37" class="i">+    }
</a><a href="#h5-0-38" id="h5-0-38" class="i">+
</a><a href="#h5-0-39" id="h5-0-39" class="i">+    val arrangement = cachedAttributes[&quot;arrangement&quot;]
</a><a href="#h5-0-40" id="h5-0-40" class="i">+    val alignment = cachedAttributes[&quot;alignment&quot;]
</a><a href="#h5-0-41" id="h5-0-41" class="i">+    val spacing = cachedAttributes[&quot;spacing&quot;]?.toString()?.toInt()?.let { abs(it) }
</a><a href="#h5-0-42" id="h5-0-42" class="i">+
</a><a href="#h5-0-43" id="h5-0-43" class="i">+    val rowColumnModifier = Modifier
</a><a href="#h5-0-44" id="h5-0-44" class="i">+        .then(if (cachedAttributes[&quot;fillMaxWidth&quot;] as? Boolean == true) Modifier.fillMaxWidth() else Modifier)
</a><a href="#h5-0-45" id="h5-0-45" class="i">+        .then(if (cachedAttributes[&quot;fillMaxHeight&quot;] as? Boolean == true) Modifier.fillMaxHeight() else Modifier)
</a><a href="#h5-0-46" id="h5-0-46" class="i">+        .padding(
</a><a href="#h5-0-47" id="h5-0-47" class="i">+            (cachedAttributes[&quot;padding&quot;]
</a><a href="#h5-0-48" id="h5-0-48" class="i">+                ?.toString()
</a><a href="#h5-0-49" id="h5-0-49" class="i">+                ?.toInt()
</a><a href="#h5-0-50" id="h5-0-50" class="i">+                ?.let { abs(it) } ?: 2).dp)
</a><a href="#h5-0-51" id="h5-0-51" class="i">+
</a><a href="#h5-0-52" id="h5-0-52" class="i">+    fun runCallbackSafe(callback: () -&gt; Unit) {
</a><a href="#h5-0-53" id="h5-0-53" class="i">+        runCatching {
</a><a href="#h5-0-54" id="h5-0-54" class="i">+            callback()
</a><a href="#h5-0-55" id="h5-0-55" class="i">+        }.onFailure {
</a><a href="#h5-0-56" id="h5-0-56" class="i">+            Logger.directError(&quot;Error running callback&quot;, it)
</a><a href="#h5-0-57" id="h5-0-57" class="i">+        }
</a><a href="#h5-0-58" id="h5-0-58" class="i">+    }
</a><a href="#h5-0-59" id="h5-0-59" class="i">+
</a><a href="#h5-0-60" id="h5-0-60" class="i">+    @Composable
</a><a href="#h5-0-61" id="h5-0-61" class="i">+    fun NodeLabel() {
</a><a href="#h5-0-62" id="h5-0-62" class="i">+        Text(
</a><a href="#h5-0-63" id="h5-0-63" class="i">+            text = cachedAttributes[&quot;label&quot;] as String,
</a><a href="#h5-0-64" id="h5-0-64" class="i">+            fontSize = (cachedAttributes[&quot;fontSize&quot;]?.toString()?.toInt() ?: 14).sp,
</a><a href="#h5-0-65" id="h5-0-65" class="i">+            color = (cachedAttributes[&quot;color&quot;] as? Long)?.let { Color(it) } ?: Color.Unspecified
</a><a href="#h5-0-66" id="h5-0-66" class="i">+        )
</a><a href="#h5-0-67" id="h5-0-67" class="i">+    }
</a><a href="#h5-0-68" id="h5-0-68" class="i">+
</a><a href="#h5-0-69" id="h5-0-69" class="i">+    when (node.type) {
</a><a href="#h5-0-70" id="h5-0-70" class="i">+        NodeType.COLUMN -&gt; {
</a><a href="#h5-0-71" id="h5-0-71" class="i">+            Column(
</a><a href="#h5-0-72" id="h5-0-72" class="i">+                verticalArrangement = arrangement as? Arrangement.Vertical ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.Top,
</a><a href="#h5-0-73" id="h5-0-73" class="i">+                horizontalAlignment = alignment as? Alignment.Horizontal ?: Alignment.Start,
</a><a href="#h5-0-74" id="h5-0-74" class="i">+                modifier = rowColumnModifier
</a><a href="#h5-0-75" id="h5-0-75" class="i">+            ) {
</a><a href="#h5-0-76" id="h5-0-76" class="i">+                node.children.forEach { child -&gt;
</a><a href="#h5-0-77" id="h5-0-77" class="i">+                    DrawNode(child)
</a><a href="#h5-0-78" id="h5-0-78" class="i">+                }
</a><a href="#h5-0-79" id="h5-0-79" class="i">+            }
</a><a href="#h5-0-80" id="h5-0-80" class="i">+        }
</a><a href="#h5-0-81" id="h5-0-81" class="i">+        NodeType.ROW -&gt; {
</a><a href="#h5-0-82" id="h5-0-82" class="i">+            Row(
</a><a href="#h5-0-83" id="h5-0-83" class="i">+                horizontalArrangement = arrangement as? Arrangement.Horizontal ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.SpaceBetween,
</a><a href="#h5-0-84" id="h5-0-84" class="i">+                verticalAlignment = alignment as? Alignment.Vertical ?: Alignment.CenterVertically,
</a><a href="#h5-0-85" id="h5-0-85" class="i">+                modifier = rowColumnModifier
</a><a href="#h5-0-86" id="h5-0-86" class="i">+            ) {
</a><a href="#h5-0-87" id="h5-0-87" class="i">+                node.children.forEach { child -&gt;
</a><a href="#h5-0-88" id="h5-0-88" class="i">+                    DrawNode(child)
</a><a href="#h5-0-89" id="h5-0-89" class="i">+                }
</a><a href="#h5-0-90" id="h5-0-90" class="i">+            }
</a><a href="#h5-0-91" id="h5-0-91" class="i">+        }
</a><a href="#h5-0-92" id="h5-0-92" class="i">+        NodeType.TEXT -&gt; NodeLabel()
</a><a href="#h5-0-93" id="h5-0-93" class="i">+        NodeType.SWITCH -&gt; {
</a><a href="#h5-0-94" id="h5-0-94" class="i">+            var switchState by remember {
</a><a href="#h5-0-95" id="h5-0-95" class="i">+                mutableStateOf(cachedAttributes[&quot;state&quot;] as Boolean)
</a><a href="#h5-0-96" id="h5-0-96" class="i">+            }
</a><a href="#h5-0-97" id="h5-0-97" class="i">+            Switch(
</a><a href="#h5-0-98" id="h5-0-98" class="i">+                checked = switchState,
</a><a href="#h5-0-99" id="h5-0-99" class="i">+                onCheckedChange = { state -&gt;
</a><a href="#h5-0-100" id="h5-0-100" class="i">+                    runCallbackSafe {
</a><a href="#h5-0-101" id="h5-0-101" class="i">+                        switchState = state
</a><a href="#h5-0-102" id="h5-0-102" class="i">+                        node.setAttribute(&quot;state&quot;, state)
</a><a href="#h5-0-103" id="h5-0-103" class="i">+                        (cachedAttributes[&quot;callback&quot;] as? (Boolean) -&gt; Unit)?.let { it(state) }
</a><a href="#h5-0-104" id="h5-0-104" class="i">+                    }
</a><a href="#h5-0-105" id="h5-0-105" class="i">+                }
</a><a href="#h5-0-106" id="h5-0-106" class="i">+            )
</a><a href="#h5-0-107" id="h5-0-107" class="i">+        }
</a><a href="#h5-0-108" id="h5-0-108" class="i">+        NodeType.SLIDER -&gt; {
</a><a href="#h5-0-109" id="h5-0-109" class="i">+            var sliderValue by remember {
</a><a href="#h5-0-110" id="h5-0-110" class="i">+                mutableFloatStateOf((cachedAttributes[&quot;value&quot;] as Int).toFloat())
</a><a href="#h5-0-111" id="h5-0-111" class="i">+            }
</a><a href="#h5-0-112" id="h5-0-112" class="i">+            Slider(
</a><a href="#h5-0-113" id="h5-0-113" class="i">+                value = sliderValue,
</a><a href="#h5-0-114" id="h5-0-114" class="i">+                onValueChange = { value -&gt;
</a><a href="#h5-0-115" id="h5-0-115" class="i">+                    runCallbackSafe {
</a><a href="#h5-0-116" id="h5-0-116" class="i">+                        sliderValue = value
</a><a href="#h5-0-117" id="h5-0-117" class="i">+                        node.setAttribute(&quot;value&quot;, value.toInt())
</a><a href="#h5-0-118" id="h5-0-118" class="i">+                        (cachedAttributes[&quot;callback&quot;] as? (Int) -&gt; Unit)?.let { it(value.toInt()) }
</a><a href="#h5-0-119" id="h5-0-119" class="i">+                    }
</a><a href="#h5-0-120" id="h5-0-120" class="i">+                },
</a><a href="#h5-0-121" id="h5-0-121" class="i">+                valueRange = (cachedAttributes[&quot;min&quot;] as Int).toFloat()..(cachedAttributes[&quot;max&quot;] as Int).toFloat(),
</a><a href="#h5-0-122" id="h5-0-122" class="i">+                steps = cachedAttributes[&quot;step&quot;] as Int,
</a><a href="#h5-0-123" id="h5-0-123" class="i">+            )
</a><a href="#h5-0-124" id="h5-0-124" class="i">+        }
</a><a href="#h5-0-125" id="h5-0-125" class="i">+        NodeType.BUTTON -&gt; {
</a><a href="#h5-0-126" id="h5-0-126" class="i">+            OutlinedButton(onClick = {
</a><a href="#h5-0-127" id="h5-0-127" class="i">+                runCallbackSafe {
</a><a href="#h5-0-128" id="h5-0-128" class="i">+                    (cachedAttributes[&quot;callback&quot;] as? () -&gt; Unit)?.let { it() }
</a><a href="#h5-0-129" id="h5-0-129" class="i">+                }
</a><a href="#h5-0-130" id="h5-0-130" class="i">+            }) {
</a><a href="#h5-0-131" id="h5-0-131" class="i">+                NodeLabel()
</a><a href="#h5-0-132" id="h5-0-132" class="i">+            }
</a><a href="#h5-0-133" id="h5-0-133" class="i">+        }
</a><a href="#h5-0-134" id="h5-0-134" class="i">+        else -&gt; {}
</a><a href="#h5-0-135" id="h5-0-135" class="i">+    }
</a><a href="#h5-0-136" id="h5-0-136" class="i">+}
</a><a href="#h5-0-137" id="h5-0-137" class="i">+
</a><a href="#h5-0-138" id="h5-0-138" class="i">+@Composable
</a><a href="#h5-0-139" id="h5-0-139" class="i">+fun ScriptInterface(interfaceBuilder: InterfaceBuilder) {
</a><a href="#h5-0-140" id="h5-0-140" class="i">+    Column(
</a><a href="#h5-0-141" id="h5-0-141" class="i">+        modifier = Modifier
</a><a href="#h5-0-142" id="h5-0-142" class="i">+            .fillMaxWidth()
</a><a href="#h5-0-143" id="h5-0-143" class="i">+            .padding(8.dp)
</a><a href="#h5-0-144" id="h5-0-144" class="i">+    ) {
</a><a href="#h5-0-145" id="h5-0-145" class="i">+        interfaceBuilder.nodes.forEach { node -&gt;
</a><a href="#h5-0-146" id="h5-0-146" class="i">+            DrawNode(node)
</a><a href="#h5-0-147" id="h5-0-147" class="i">+        }
</a><a href="#h5-0-148" id="h5-0-148" class="i">+
</a><a href="#h5-0-149" id="h5-0-149" class="i">+        LaunchedEffect(interfaceBuilder) {
</a><a href="#h5-0-150" id="h5-0-150" class="i">+            interfaceBuilder.onLaunchedCallback?.invoke()
</a><a href="#h5-0-151" id="h5-0-151" class="i">+        }
</a><a href="#h5-0-152" id="h5-0-152" class="i">+    }
</a><a href="#h5-0-153" id="h5-0-153" class="i">+}</a><a href="#h5-0-154" id="h5-0-154" class="i">+
\ No newline at end of file
</a><b>diff --git a/<a id="h6" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/manager/sections/scripting/ScriptsSection.kt</a></b>
<a href="#h6-0" id="h6-0" class="h">@@ -9,19 +9,15 @@ import androidx.compose.material3.*
</a> import androidx.compose.runtime.*
 import androidx.compose.ui.Alignment
 import androidx.compose.ui.Modifier
<a href="#h6-0-3" id="h6-0-3" class="d">-import androidx.compose.ui.graphics.Color
</a> import androidx.compose.ui.unit.dp
 import androidx.compose.ui.unit.sp
 import kotlinx.coroutines.delay
 import kotlinx.coroutines.launch
<a href="#h6-0-8" id="h6-0-8" class="d">-import me.rhunk.snapenhance.scripting.impl.ui.components.Node
</a><a href="#h6-0-9" id="h6-0-9" class="d">-import me.rhunk.snapenhance.scripting.impl.ui.components.NodeType
</a> import me.rhunk.snapenhance.scripting.type.ModuleInfo
 import me.rhunk.snapenhance.ui.manager.Section
 import me.rhunk.snapenhance.ui.util.pullrefresh.PullRefreshIndicator
 import me.rhunk.snapenhance.ui.util.pullrefresh.pullRefresh
 import me.rhunk.snapenhance.ui.util.pullrefresh.rememberPullRefreshState
<a href="#h6-0-15" id="h6-0-15" class="d">-import kotlin.math.abs
</a> 
 class ScriptsSection : Section() {
     @Composable
<a href="#h6-1" id="h6-1" class="h">@@ -88,115 +84,6 @@ class ScriptsSection : Section() {
</a>         }
     }
 
<a href="#h6-1-3" id="h6-1-3" class="d">-    @Composable
</a><a href="#h6-1-4" id="h6-1-4" class="d">-    private fun DrawNode(node: Node) {
</a><a href="#h6-1-5" id="h6-1-5" class="d">-        val coroutineScope = rememberCoroutineScope()
</a><a href="#h6-1-6" id="h6-1-6" class="d">-        val cachedAttributes = remember { mutableStateMapOf(*node.attributes.toList().toTypedArray()) }
</a><a href="#h6-1-7" id="h6-1-7" class="d">-
</a><a href="#h6-1-8" id="h6-1-8" class="d">-        node.uiChangeDetection = { key, value -&gt;
</a><a href="#h6-1-9" id="h6-1-9" class="d">-            coroutineScope.launch {
</a><a href="#h6-1-10" id="h6-1-10" class="d">-                cachedAttributes[key] = value
</a><a href="#h6-1-11" id="h6-1-11" class="d">-            }
</a><a href="#h6-1-12" id="h6-1-12" class="d">-        }
</a><a href="#h6-1-13" id="h6-1-13" class="d">-
</a><a href="#h6-1-14" id="h6-1-14" class="d">-        val arrangement = cachedAttributes[&quot;arrangement&quot;]
</a><a href="#h6-1-15" id="h6-1-15" class="d">-        val alignment = cachedAttributes[&quot;alignment&quot;]
</a><a href="#h6-1-16" id="h6-1-16" class="d">-        val spacing = cachedAttributes[&quot;spacing&quot;]?.toString()?.toInt()?.let { abs(it) }
</a><a href="#h6-1-17" id="h6-1-17" class="d">-
</a><a href="#h6-1-18" id="h6-1-18" class="d">-        val rowColumnModifier = Modifier
</a><a href="#h6-1-19" id="h6-1-19" class="d">-            .then(if (cachedAttributes[&quot;fillMaxWidth&quot;] as? Boolean == true) Modifier.fillMaxWidth() else Modifier)
</a><a href="#h6-1-20" id="h6-1-20" class="d">-            .then(if (cachedAttributes[&quot;fillMaxHeight&quot;] as? Boolean == true) Modifier.fillMaxHeight() else Modifier)
</a><a href="#h6-1-21" id="h6-1-21" class="d">-            .padding(
</a><a href="#h6-1-22" id="h6-1-22" class="d">-                (cachedAttributes[&quot;padding&quot;]
</a><a href="#h6-1-23" id="h6-1-23" class="d">-                    ?.toString()
</a><a href="#h6-1-24" id="h6-1-24" class="d">-                    ?.toInt()
</a><a href="#h6-1-25" id="h6-1-25" class="d">-                    ?.let { abs(it) } ?: 2).dp)
</a><a href="#h6-1-26" id="h6-1-26" class="d">-
</a><a href="#h6-1-27" id="h6-1-27" class="d">-        fun runCallbackSafe(callback: () -&gt; Unit) {
</a><a href="#h6-1-28" id="h6-1-28" class="d">-            runCatching {
</a><a href="#h6-1-29" id="h6-1-29" class="d">-                callback()
</a><a href="#h6-1-30" id="h6-1-30" class="d">-            }.onFailure {
</a><a href="#h6-1-31" id="h6-1-31" class="d">-                context.log.error(&quot;Error running callback&quot;, it)
</a><a href="#h6-1-32" id="h6-1-32" class="d">-            }
</a><a href="#h6-1-33" id="h6-1-33" class="d">-        }
</a><a href="#h6-1-34" id="h6-1-34" class="d">-
</a><a href="#h6-1-35" id="h6-1-35" class="d">-        @Composable
</a><a href="#h6-1-36" id="h6-1-36" class="d">-        fun NodeLabel() {
</a><a href="#h6-1-37" id="h6-1-37" class="d">-            Text(
</a><a href="#h6-1-38" id="h6-1-38" class="d">-                text = cachedAttributes[&quot;label&quot;] as String,
</a><a href="#h6-1-39" id="h6-1-39" class="d">-                fontSize = (cachedAttributes[&quot;fontSize&quot;]?.toString()?.toInt() ?: 14).sp,
</a><a href="#h6-1-40" id="h6-1-40" class="d">-                color = (cachedAttributes[&quot;color&quot;] as? Long)?.let { Color(it) } ?: Color.Unspecified
</a><a href="#h6-1-41" id="h6-1-41" class="d">-            )
</a><a href="#h6-1-42" id="h6-1-42" class="d">-        }
</a><a href="#h6-1-43" id="h6-1-43" class="d">-
</a><a href="#h6-1-44" id="h6-1-44" class="d">-        when (node.type) {
</a><a href="#h6-1-45" id="h6-1-45" class="d">-            NodeType.COLUMN -&gt; {
</a><a href="#h6-1-46" id="h6-1-46" class="d">-                Column(
</a><a href="#h6-1-47" id="h6-1-47" class="d">-                    verticalArrangement = arrangement as? Arrangement.Vertical ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.Top,
</a><a href="#h6-1-48" id="h6-1-48" class="d">-                    horizontalAlignment = alignment as? Alignment.Horizontal ?: Alignment.Start,
</a><a href="#h6-1-49" id="h6-1-49" class="d">-                    modifier = rowColumnModifier
</a><a href="#h6-1-50" id="h6-1-50" class="d">-                ) {
</a><a href="#h6-1-51" id="h6-1-51" class="d">-                    node.children.forEach { child -&gt;
</a><a href="#h6-1-52" id="h6-1-52" class="d">-                        DrawNode(child)
</a><a href="#h6-1-53" id="h6-1-53" class="d">-                    }
</a><a href="#h6-1-54" id="h6-1-54" class="d">-                }
</a><a href="#h6-1-55" id="h6-1-55" class="d">-            }
</a><a href="#h6-1-56" id="h6-1-56" class="d">-            NodeType.ROW -&gt; {
</a><a href="#h6-1-57" id="h6-1-57" class="d">-                Row(
</a><a href="#h6-1-58" id="h6-1-58" class="d">-                    horizontalArrangement = arrangement as? Arrangement.Horizontal ?: spacing?.let { Arrangement.spacedBy(it.dp) } ?: Arrangement.SpaceBetween,
</a><a href="#h6-1-59" id="h6-1-59" class="d">-                    verticalAlignment = alignment as? Alignment.Vertical ?: Alignment.CenterVertically,
</a><a href="#h6-1-60" id="h6-1-60" class="d">-                    modifier = rowColumnModifier
</a><a href="#h6-1-61" id="h6-1-61" class="d">-                ) {
</a><a href="#h6-1-62" id="h6-1-62" class="d">-                    node.children.forEach { child -&gt;
</a><a href="#h6-1-63" id="h6-1-63" class="d">-                        DrawNode(child)
</a><a href="#h6-1-64" id="h6-1-64" class="d">-                    }
</a><a href="#h6-1-65" id="h6-1-65" class="d">-                }
</a><a href="#h6-1-66" id="h6-1-66" class="d">-            }
</a><a href="#h6-1-67" id="h6-1-67" class="d">-            NodeType.TEXT -&gt; NodeLabel()
</a><a href="#h6-1-68" id="h6-1-68" class="d">-            NodeType.SWITCH -&gt; {
</a><a href="#h6-1-69" id="h6-1-69" class="d">-                var switchState by remember {
</a><a href="#h6-1-70" id="h6-1-70" class="d">-                    mutableStateOf(cachedAttributes[&quot;state&quot;] as Boolean)
</a><a href="#h6-1-71" id="h6-1-71" class="d">-                }
</a><a href="#h6-1-72" id="h6-1-72" class="d">-                Switch(
</a><a href="#h6-1-73" id="h6-1-73" class="d">-                    checked = switchState,
</a><a href="#h6-1-74" id="h6-1-74" class="d">-                    onCheckedChange = { state -&gt;
</a><a href="#h6-1-75" id="h6-1-75" class="d">-                        runCallbackSafe {
</a><a href="#h6-1-76" id="h6-1-76" class="d">-                            switchState = state
</a><a href="#h6-1-77" id="h6-1-77" class="d">-                            node.setAttribute(&quot;state&quot;, state)
</a><a href="#h6-1-78" id="h6-1-78" class="d">-                            (cachedAttributes[&quot;callback&quot;] as? (Boolean) -&gt; Unit)?.let { it(state) }
</a><a href="#h6-1-79" id="h6-1-79" class="d">-                        }
</a><a href="#h6-1-80" id="h6-1-80" class="d">-                    }
</a><a href="#h6-1-81" id="h6-1-81" class="d">-                )
</a><a href="#h6-1-82" id="h6-1-82" class="d">-            }
</a><a href="#h6-1-83" id="h6-1-83" class="d">-            NodeType.SLIDER -&gt; {
</a><a href="#h6-1-84" id="h6-1-84" class="d">-                var sliderValue by remember {
</a><a href="#h6-1-85" id="h6-1-85" class="d">-                    mutableFloatStateOf((cachedAttributes[&quot;value&quot;] as Int).toFloat())
</a><a href="#h6-1-86" id="h6-1-86" class="d">-                }
</a><a href="#h6-1-87" id="h6-1-87" class="d">-                Slider(
</a><a href="#h6-1-88" id="h6-1-88" class="d">-                    value = sliderValue,
</a><a href="#h6-1-89" id="h6-1-89" class="d">-                    onValueChange = { value -&gt;
</a><a href="#h6-1-90" id="h6-1-90" class="d">-                        runCallbackSafe {
</a><a href="#h6-1-91" id="h6-1-91" class="d">-                            sliderValue = value
</a><a href="#h6-1-92" id="h6-1-92" class="d">-                            node.setAttribute(&quot;value&quot;, value.toInt())
</a><a href="#h6-1-93" id="h6-1-93" class="d">-                            (cachedAttributes[&quot;callback&quot;] as? (Int) -&gt; Unit)?.let { it(value.toInt()) }
</a><a href="#h6-1-94" id="h6-1-94" class="d">-                        }
</a><a href="#h6-1-95" id="h6-1-95" class="d">-                    },
</a><a href="#h6-1-96" id="h6-1-96" class="d">-                    valueRange = (cachedAttributes[&quot;min&quot;] as Int).toFloat()..(cachedAttributes[&quot;max&quot;] as Int).toFloat(),
</a><a href="#h6-1-97" id="h6-1-97" class="d">-                    steps = cachedAttributes[&quot;step&quot;] as Int,
</a><a href="#h6-1-98" id="h6-1-98" class="d">-                )
</a><a href="#h6-1-99" id="h6-1-99" class="d">-            }
</a><a href="#h6-1-100" id="h6-1-100" class="d">-            NodeType.BUTTON -&gt; {
</a><a href="#h6-1-101" id="h6-1-101" class="d">-                OutlinedButton(onClick = {
</a><a href="#h6-1-102" id="h6-1-102" class="d">-                    runCallbackSafe {
</a><a href="#h6-1-103" id="h6-1-103" class="d">-                        (cachedAttributes[&quot;callback&quot;] as? () -&gt; Unit)?.let { it() }
</a><a href="#h6-1-104" id="h6-1-104" class="d">-                    }
</a><a href="#h6-1-105" id="h6-1-105" class="d">-                }) {
</a><a href="#h6-1-106" id="h6-1-106" class="d">-                    NodeLabel()
</a><a href="#h6-1-107" id="h6-1-107" class="d">-                }
</a><a href="#h6-1-108" id="h6-1-108" class="d">-            }
</a><a href="#h6-1-109" id="h6-1-109" class="d">-            else -&gt; {}
</a><a href="#h6-1-110" id="h6-1-110" class="d">-        }
</a><a href="#h6-1-111" id="h6-1-111" class="d">-    }
</a> 
     @Composable
     fun ScriptSettings(script: ModuleInfo) {
<a href="#h6-2" id="h6-2" class="h">@@ -211,19 +98,7 @@ class ScriptsSection : Section() {
</a>             return
         }
 
<a href="#h6-2-3" id="h6-2-3" class="d">-        Column(
</a><a href="#h6-2-4" id="h6-2-4" class="d">-            modifier = Modifier
</a><a href="#h6-2-5" id="h6-2-5" class="d">-                .fillMaxWidth()
</a><a href="#h6-2-6" id="h6-2-6" class="d">-                .padding(8.dp)
</a><a href="#h6-2-7" id="h6-2-7" class="d">-        ) {
</a><a href="#h6-2-8" id="h6-2-8" class="d">-            settingsInterface.nodes.forEach { node -&gt;
</a><a href="#h6-2-9" id="h6-2-9" class="d">-                DrawNode(node)
</a><a href="#h6-2-10" id="h6-2-10" class="d">-            }
</a><a href="#h6-2-11" id="h6-2-11" class="d">-
</a><a href="#h6-2-12" id="h6-2-12" class="d">-            LaunchedEffect(settingsInterface) {
</a><a href="#h6-2-13" id="h6-2-13" class="d">-                settingsInterface.onLaunchedCallback?.invoke()
</a><a href="#h6-2-14" id="h6-2-14" class="d">-            }
</a><a href="#h6-2-15" id="h6-2-15" class="d">-        }
</a><a href="#h6-2-16" id="h6-2-16" class="i">+        ScriptInterface(interfaceBuilder = settingsInterface)
</a>     }
 
 
<a href="#h6-3" id="h6-3" class="h">@@ -259,13 +134,14 @@ class ScriptsSection : Section() {
</a>                 modifier = Modifier
                     .fillMaxSize()
                     .pullRefresh(pullRefreshState),
<a href="#h6-3-3" id="h6-3-3" class="i">+                horizontalAlignment = Alignment.CenterHorizontally
</a>             ) {
                 item {
                     if (scriptModules.isEmpty()) {
                         Text(
                             text = &quot;No scripts found&quot;,
                             style = MaterialTheme.typography.bodySmall,
<a href="#h6-3-10" id="h6-3-10" class="d">-                            modifier = Modifier.padding(8.dp).align(Alignment.Center)
</a><a href="#h6-3-11" id="h6-3-11" class="i">+                            modifier = Modifier.padding(8.dp)
</a>                         )
                     }
                 }
<b>diff --git a/<a id="h7" href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/setup/SetupActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/setup/SetupActivity.kt</a> b/<a href="../file/app/src/main/kotlin/me/rhunk/snapenhance/ui/setup/SetupActivity.kt.html">app/src/main/kotlin/me/rhunk/snapenhance/ui/setup/SetupActivity.kt</a></b>
<a href="#h7-0" id="h7-0" class="h">@@ -9,7 +9,7 @@ import androidx.compose.animation.core.animateFloatAsState
</a> import androidx.compose.foundation.background
 import androidx.compose.foundation.layout.*
 import androidx.compose.material.icons.Icons
<a href="#h7-0-3" id="h7-0-3" class="d">-import androidx.compose.material.icons.filled.ArrowForwardIos
</a><a href="#h7-0-4" id="h7-0-4" class="i">+import androidx.compose.material.icons.automirrored.filled.ArrowForwardIos
</a> import androidx.compose.material.icons.filled.Check
 import androidx.compose.material3.FilledIconButton
 import androidx.compose.material3.Icon
<a href="#h7-1" id="h7-1" class="h">@@ -122,7 +122,7 @@ class SetupActivity : ComponentActivity() {
</a>                                     imageVector = if (requiredScreens.size &lt;= 1 &amp;&amp; canGoNext) {
                                         Icons.Default.Check
                                     } else {
<a href="#h7-1-3" id="h7-1-3" class="d">-                                        Icons.Default.ArrowForwardIos
</a><a href="#h7-1-4" id="h7-1-4" class="i">+                                        Icons.AutoMirrored.Default.ArrowForwardIos
</a>                                     },
                                     contentDescription = null
                                 )
<b>diff --git a/<a id="h8" href="../file/core/src/main/kotlin/me/rhunk/snapenhance/ui/menu/impl/SettingsMenu.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/ui/menu/impl/SettingsMenu.kt</a> b/<a href="../file/core/src/main/kotlin/me/rhunk/snapenhance/ui/menu/impl/SettingsMenu.kt.html">core/src/main/kotlin/me/rhunk/snapenhance/ui/menu/impl/SettingsMenu.kt</a></b>
<a href="#h8-0" id="h8-0" class="h">@@ -7,6 +7,7 @@ import me.rhunk.snapenhance.ui.menu.AbstractMenu
</a> class SettingsMenu : AbstractMenu() {
     //TODO: quick settings
     @SuppressLint(&quot;SetTextI18n&quot;)
<a href="#h8-0-3" id="h8-0-3" class="i">+    @Suppress(&quot;UNUSED_PARAMETER&quot;)
</a>     fun inject(viewModel: View, addView: (View) -&gt; Unit) {
         /*val actions = context.actionManager.getActions().map {
             Pair(it) {
</pre>
</div>
</body>
</html>
